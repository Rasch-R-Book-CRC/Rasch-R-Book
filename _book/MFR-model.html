<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Many Facet Rasch Model | Rasch Measurement Theory Analysis in R: Illustrations and Practical Guidance for Researchers and Practitioners</title>
  <meta name="description" content="The purpose of this book is to illustrate techniques for conducting Rasch measurement theory analyses using existing R packages. The book includes some background information about Rasch models, and the primary objective is to demonstrate how to apply the models to data using existing R packages and how to interpret the results. The intended audience for this book is graduate students or professionals who have a basic familiarity with Rasch measurement theory and who have a basic working knowledge of the R software." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Many Facet Rasch Model | Rasch Measurement Theory Analysis in R: Illustrations and Practical Guidance for Researchers and Practitioners" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The purpose of this book is to illustrate techniques for conducting Rasch measurement theory analyses using existing R packages. The book includes some background information about Rasch models, and the primary objective is to demonstrate how to apply the models to data using existing R packages and how to interpret the results. The intended audience for this book is graduate students or professionals who have a basic familiarity with Rasch measurement theory and who have a basic working knowledge of the R software." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Many Facet Rasch Model | Rasch Measurement Theory Analysis in R: Illustrations and Practical Guidance for Researchers and Practitioners" />
  
  <meta name="twitter:description" content="The purpose of this book is to illustrate techniques for conducting Rasch measurement theory analyses using existing R packages. The book includes some background information about Rasch models, and the primary objective is to demonstrate how to apply the models to data using existing R packages and how to interpret the results. The intended audience for this book is graduate students or professionals who have a basic familiarity with Rasch measurement theory and who have a basic working knowledge of the R software." />
  

<meta name="author" content="Stefanie A. Wind &amp; Cheng Hua" />


<meta name="date" content="2021-08-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="PC-model.html"/>
<link rel="next" href="DIF.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Rasch R Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#overview-of-rasch-measurement-theory"><i class="fa fa-check"></i><b>1.1</b> Overview of Rasch Measurement Theory</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#online-resources"><i class="fa fa-check"></i><b>1.2</b> Online Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Dich-Rasch-model.html"><a href="Dich-Rasch-model.html"><i class="fa fa-check"></i><b>2</b> Dichotomous Rasch Model</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Dich-Rasch-model.html"><a href="Dich-Rasch-model.html#example-data-transitive-reasoning-test"><i class="fa fa-check"></i><b>2.1</b> Example Data: Transitive Reasoning Test</a></li>
<li class="chapter" data-level="2.2" data-path="Dich-Rasch-model.html"><a href="Dich-Rasch-model.html#dichotomous-rasch-model-analysis-with-cmle-in-erm"><i class="fa fa-check"></i><b>2.2</b> Dichotomous Rasch Model Analysis with CMLE in eRm</a></li>
<li class="chapter" data-level="2.3" data-path="Dich-Rasch-model.html"><a href="Dich-Rasch-model.html#dichotomous-rasch-model-analysis-with-mmle-in-tam"><i class="fa fa-check"></i><b>2.3</b> Dichotomous Rasch Model Analysis with MMLE in TAM</a></li>
<li class="chapter" data-level="2.4" data-path="Dich-Rasch-model.html"><a href="Dich-Rasch-model.html#dichotomous-rasch-model-analysis-with-jmle-in-tam"><i class="fa fa-check"></i><b>2.4</b> Dichotomous Rasch Model Analysis with JMLE in TAM</a></li>
<li class="chapter" data-level="2.5" data-path="Dich-Rasch-model.html"><a href="Dich-Rasch-model.html#example-results-section"><i class="fa fa-check"></i><b>2.5</b> Example Results Section</a></li>
<li class="chapter" data-level="2.6" data-path="Dich-Rasch-model.html"><a href="Dich-Rasch-model.html#exercise"><i class="fa fa-check"></i><b>2.6</b> Exercise</a></li>
<li class="chapter" data-level="2.7" data-path="Dich-Rasch-model.html"><a href="Dich-Rasch-model.html#supplementary-learning-materials"><i class="fa fa-check"></i><b>2.7</b> Supplementary Learning Materials</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="MD-fit.html"><a href="MD-fit.html"><i class="fa fa-check"></i><b>3</b> Evaluating the Quality of Measures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="MD-fit.html"><a href="MD-fit.html#evaluating-measurement-quality-from-the-perspective-of-rasch-measurement-theory"><i class="fa fa-check"></i><b>3.1</b> Evaluating Measurement Quality from the Perspective of Rasch Measurement Theory</a></li>
<li class="chapter" data-level="3.2" data-path="MD-fit.html"><a href="MD-fit.html#example-data-transitive-reasoning-test-1"><i class="fa fa-check"></i><b>3.2</b> Example Data: Transitive Reasoning Test</a></li>
<li class="chapter" data-level="3.3" data-path="MD-fit.html"><a href="MD-fit.html#rasch-model-fit-analysis-with-cmle-in-erm"><i class="fa fa-check"></i><b>3.3</b> Rasch Model Fit Analysis with CMLE in <em>eRm</em></a></li>
<li class="chapter" data-level="3.4" data-path="MD-fit.html"><a href="MD-fit.html#graphical-displays-for-evaluating-model-data-fit"><i class="fa fa-check"></i><b>3.4</b> Graphical Displays for Evaluating Model-Data Fit</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="MD-fit.html"><a href="MD-fit.html#reliability"><i class="fa fa-check"></i><b>3.4.1</b> Reliability</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="MD-fit.html"><a href="MD-fit.html#rasch-model-fit-analysis-with-mmle-in-tam"><i class="fa fa-check"></i><b>3.5</b> Rasch Model Fit Analysis with MMLE in TAM</a></li>
<li class="chapter" data-level="3.6" data-path="MD-fit.html"><a href="MD-fit.html#rasch-model-fit-analysis-with-jmle-in-tam"><i class="fa fa-check"></i><b>3.6</b> Rasch Model Fit Analysis with JMLE in TAM</a></li>
<li class="chapter" data-level="3.7" data-path="MD-fit.html"><a href="MD-fit.html#exercise-1"><i class="fa fa-check"></i><b>3.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="RS-model.html"><a href="RS-model.html"><i class="fa fa-check"></i><b>4</b> Rating Scale Model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="RS-model.html"><a href="RS-model.html#example-data-liking-for-science"><i class="fa fa-check"></i><b>4.1</b> Example Data: Liking for Science</a></li>
<li class="chapter" data-level="4.2" data-path="RS-model.html"><a href="RS-model.html#rsm-analysis-with-cmle-in-erm"><i class="fa fa-check"></i><b>4.2</b> RSM Analysis with CMLE in <em>eRm</em></a></li>
<li class="chapter" data-level="4.3" data-path="RS-model.html"><a href="RS-model.html#rsm-analysis-with-mmle-in-tam"><i class="fa fa-check"></i><b>4.3</b> RSM Analysis with MMLE in <em>TAM</em></a></li>
<li class="chapter" data-level="4.4" data-path="RS-model.html"><a href="RS-model.html#rsm-analysis-with-jmle-in-tam"><i class="fa fa-check"></i><b>4.4</b> RSM Analysis with JMLE in TAM</a></li>
<li class="chapter" data-level="4.5" data-path="RS-model.html"><a href="RS-model.html#example-results-section-1"><i class="fa fa-check"></i><b>4.5</b> Example Results Section</a></li>
<li class="chapter" data-level="4.6" data-path="RS-model.html"><a href="RS-model.html#exercise-2"><i class="fa fa-check"></i><b>4.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="PC-model.html"><a href="PC-model.html"><i class="fa fa-check"></i><b>5</b> Partial Credit Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="PC-model.html"><a href="PC-model.html#example-data-liking-for-science-1"><i class="fa fa-check"></i><b>5.1</b> Example Data: Liking for Science</a></li>
<li class="chapter" data-level="5.2" data-path="PC-model.html"><a href="PC-model.html#pcm-analysis-with-cmle-in-erm"><i class="fa fa-check"></i><b>5.2</b> PCM Analysis with CMLE in <em>eRm</em></a></li>
<li class="chapter" data-level="5.3" data-path="PC-model.html"><a href="PC-model.html#summarize-the-results-in-tables"><i class="fa fa-check"></i><b>5.3</b> Summarize the Results in Tables</a></li>
<li class="chapter" data-level="5.4" data-path="PC-model.html"><a href="PC-model.html#pcm-application-with-mmle-in-tam"><i class="fa fa-check"></i><b>5.4</b> PCM Application with MMLE in <em>TAM</em></a></li>
<li class="chapter" data-level="5.5" data-path="PC-model.html"><a href="PC-model.html#pcm-application-with-jmle-in-tam"><i class="fa fa-check"></i><b>5.5</b> PCM Application with JMLE in <em>TAM</em></a></li>
<li class="chapter" data-level="5.6" data-path="PC-model.html"><a href="PC-model.html#example-results-section-2"><i class="fa fa-check"></i><b>5.6</b> Example results section</a></li>
<li class="chapter" data-level="5.7" data-path="PC-model.html"><a href="PC-model.html#exercise-3"><i class="fa fa-check"></i><b>5.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="MFR-model.html"><a href="MFR-model.html"><i class="fa fa-check"></i><b>6</b> Many Facet Rasch Model</a>
<ul>
<li class="chapter" data-level="6.1" data-path="MFR-model.html"><a href="MFR-model.html#running-the-mfrm-with-wide-format-data-in-tam-package"><i class="fa fa-check"></i><b>6.1</b> Running the MFRM with Wide-Format Data in TAM Package</a></li>
<li class="chapter" data-level="6.2" data-path="MFR-model.html"><a href="MFR-model.html#another-example-running-pc-mfrm-with-long-format-data-using-the-tam-package"><i class="fa fa-check"></i><b>6.2</b> Another Example: Running PC-MFRM with Long-Format Data using the <em>TAM</em> Package</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="MFR-model.html"><a href="MFR-model.html#specify-the-pc-mfrm"><i class="fa fa-check"></i><b>6.2.1</b> Specify the PC-MFRM:</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="MFR-model.html"><a href="MFR-model.html#notes-on-formulations-for-many-facet-rasch-models"><i class="fa fa-check"></i><b>6.3</b> Notes on Formulations for Many-Facet Rasch Models</a></li>
<li class="chapter" data-level="6.4" data-path="MFR-model.html"><a href="MFR-model.html#example-results-section-3"><i class="fa fa-check"></i><b>6.4</b> Example Results Section</a></li>
<li class="chapter" data-level="6.5" data-path="MFR-model.html"><a href="MFR-model.html#exercise-4"><i class="fa fa-check"></i><b>6.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="DIF.html"><a href="DIF.html"><i class="fa fa-check"></i><b>7</b> Basics of Differential Item Functioning</a>
<ul>
<li class="chapter" data-level="7.1" data-path="DIF.html"><a href="DIF.html#detecting-differential-item-functioning-in-r-for-dichotomous-items"><i class="fa fa-check"></i><b>7.1</b> Detecting Differential Item Functioning in R for Dichotomous Items</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="DIF.html"><a href="DIF.html#example-data-transitive-reasoning"><i class="fa fa-check"></i><b>7.1.1</b> Example Data: Transitive Reasoning</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="DIF.html"><a href="DIF.html#detecting-differential-item-functioning-in-r-for-polytomous-items"><i class="fa fa-check"></i><b>7.2</b> Detecting Differential Item Functioning in R for Polytomous Items</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="DIF.html"><a href="DIF.html#example-data-style-ratings"><i class="fa fa-check"></i><b>7.2.1</b> Example Data: Style Ratings</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="DIF.html"><a href="DIF.html#exercise-5"><i class="fa fa-check"></i><b>7.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="RS-Eval.html"><a href="RS-Eval.html"><i class="fa fa-check"></i><b>8</b> Rating Scale Evaluation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="RS-Eval.html"><a href="RS-Eval.html#what-is-rating-scale-evaluation"><i class="fa fa-check"></i><b>8.1</b> What is Rating Scale Evaluation?</a></li>
<li class="chapter" data-level="8.2" data-path="RS-Eval.html"><a href="RS-Eval.html#rating-scale-analysis-on-example-survey-data"><i class="fa fa-check"></i><b>8.2</b> Rating Scale Analysis on Example Survey Data</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="RS-Eval.html"><a href="RS-Eval.html#load-and-investigate-the-data-set"><i class="fa fa-check"></i><b>8.2.1</b> Load and investigate the data set</a></li>
<li class="chapter" data-level="8.2.2" data-path="RS-Eval.html"><a href="RS-Eval.html#run-the-partial-credit-model"><i class="fa fa-check"></i><b>8.2.2</b> Run the Partial Credit Model</a></li>
<li class="chapter" data-level="8.2.3" data-path="RS-Eval.html"><a href="RS-Eval.html#check-categories-for-monotonicity"><i class="fa fa-check"></i><b>8.2.3</b> Check Categories for Monotonicity</a></li>
<li class="chapter" data-level="8.2.4" data-path="RS-Eval.html"><a href="RS-Eval.html#examine-category-probability-curves"><i class="fa fa-check"></i><b>8.2.4</b> Examine Category Probability curves</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="RS-Eval.html"><a href="RS-Eval.html#example-apa-format-results-section-for-rating-scale-analysis"><i class="fa fa-check"></i><b>8.3</b> Example APA-format Results section for rating scale analysis</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Ref1.html"><a href="Ref1.html"><i class="fa fa-check"></i><b>9</b> References &amp; Other Good Stuff</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Ref1.html"><a href="Ref1.html#rasch-glossary"><i class="fa fa-check"></i><b>9.1</b> Rasch Glossary</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="Ref1.html"><a href="Ref1.html#rasch-models"><i class="fa fa-check"></i><b>9.1.1</b> Rasch Models</a></li>
<li class="chapter" data-level="9.1.2" data-path="Ref1.html"><a href="Ref1.html#diagnostic-and-exploratory-rasch-figures"><i class="fa fa-check"></i><b>9.1.2</b> Diagnostic and Exploratory Rasch Figures</a></li>
<li class="chapter" data-level="9.1.3" data-path="Ref1.html"><a href="Ref1.html#estimation-methods-and-estimates"><i class="fa fa-check"></i><b>9.1.3</b> Estimation methods and Estimates</a></li>
<li class="chapter" data-level="9.1.4" data-path="Ref1.html"><a href="Ref1.html#popular-r-packages-for-running-rasch-model"><i class="fa fa-check"></i><b>9.1.4</b> Popular R-Packages for running Rasch Model</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="Ref1.html"><a href="Ref1.html#rasch-friendly-jounrals"><i class="fa fa-check"></i><b>9.2</b> <span>Rasch friendly Jounrals</span></a></li>
<li class="chapter" data-level="9.3" data-path="Ref1.html"><a href="Ref1.html#rasch-model-application-tempaltes"><i class="fa fa-check"></i><b>9.3</b> Rasch Model Application Tempaltes</a></li>
<li class="chapter" data-level="9.4" data-path="Ref1.html"><a href="Ref1.html#reference-for-this-book"><i class="fa fa-check"></i><b>9.4</b> Reference for this book</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rasch Measurement Theory Analysis in R: Illustrations and Practical Guidance for Researchers and Practitioners</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="MFR_model" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Many Facet Rasch Model</h1>
<p>This chapter provides a basic overview of the Many-Facet Rasch Model (MFRM) <span class="citation">(<a href="#ref-MFRM" role="doc-biblioref">John M. Linacre 1989</a>)</span>, along with guidance for analyzing data with the MFRM using R <span class="citation">(<a href="#ref-R-base" role="doc-biblioref">R Core Team 2019</a>)</span>. We use the <em>TAM</em> package <span class="citation">(<a href="#ref-TAM" role="doc-biblioref">Robitzsch, Kiefer, and Wu 2021</a>)</span> for all of the analyses in this chapter. In the first example, we demonstrate how to apply the MFRM to multi-faceted data that are stored in <em>wide format</em> (one row for each subject). Then, we demonstrate how to apply the MFRM to multi-faceted data that are stored in <em>long format</em> (multiple rows for each subject). After the analyses are complete, we present an example description of the results from one example. The chapter concludes with a challenge exercise.</p>
<p><strong><em>Overview of the Many-Facet Rasch Model</em></strong></p>
<p>The MFRM <span class="citation">(<a href="#ref-MFRM" role="doc-biblioref">John M. Linacre 1989</a>)</span> is an extension of the Rasch family of models that allows researchers to include additional variables of interest (“facets”) besides items and persons. <span class="citation"><a href="#ref-Apply_RM" role="doc-biblioref">Bond, Yan, and Heene</a> (<a href="#ref-Apply_RM" role="doc-biblioref">2020</a>)</span> defined facets as “aspects of the measurement process that “routinely and systematically interpose themselves between the ability of the candidates and the difficulty of the test” (p. 145). Examples of variables that could be modeled as facets include raters in a constructed-response assessment, participant demographic variables (e.g., gender, race/ethnicity, best language), item type, or domains in an analytic scoring rubric for constructed-response items.</p>
<p>A general equation for the MFRM is:</p>
<p><span class="math display">\[\begin{equation}\tag{6.1}\ln\left(\frac{P_{n(x=k)}}{P_{n(x=k-1)}}\right)=\theta_{n}-\sum_{\text {facets }}\varepsilon-\tau_{k}\end{equation}\]</span></p>
<p>In Equation 6.1, <span class="math inline">\(\theta\)</span> is person ability and <span class="math inline">\(\tau_k\)</span> is the rating scale category threshold, which can be modified to reflect different variations on the Rasch model (e.g., the PC model) as needed. <span class="math inline">\(\Sigma\)</span> facets <span class="math inline">\(\epsilon\)</span> is a linear combination of facets that are specific to each modeling context. For example, facets fora MFR model analysis of a performance assessment could include raters and domains. According to Equation 6.1, the probability for an observation in category <span class="math inline">\(k\)</span>, rather than in category <span class="math inline">\(k-1\)</span> for Person <span class="math inline">\(n\)</span> is modeled as the difference between the location of Person <span class="math inline">\(n\)</span> , the location of the researcher-specified facets, and the difficulty associated with providing a response in category <span class="math inline">\(k\)</span>.</p>
<p>Researchers can specify formulations of the MFR model to extend the dichotomous Rasch model (see Chapter 2) the Rating Scale (RS) model (see Chapter 4), the Partial Credit model (see Chapter 5), as well as other Rasch models (e.g., the binomial trials model and the Poisson counts model <span class="citation">(<a href="#ref-Overview_RM" role="doc-biblioref">Wright and Mok 2004</a>)</span>.</p>
<p><strong><em>Rasch Model Requirements</em></strong></p>
<p>The MFRM shares the requirements for unidimensionality, local independence, and invariance that we discussed in Chapter 2 for the dichotomous Rasch model. In practice, researchers should evaluate item responses for evidence that they approximate Rasch model requirements before examining model estimates in detail. Chapter 3 included details about model-data fit analysis procedures that can also be applied to the MFRM.</p>
<div id="running-the-mfrm-with-wide-format-data-in-tam-package" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Running the MFRM with Wide-Format Data in TAM Package</h2>
<p>In the next section, we provide a step-by-step demonstration of a MFRM analysis using the <em>Test Analysis Modules</em> or <em>TAM</em> package <span class="citation">(<a href="#ref-TAM" role="doc-biblioref">Robitzsch, Kiefer, and Wu 2021</a>)</span> for R. We encourage readers to use the example data set for this chapter that is provided in the online supplement to conduct the analysis along with us.</p>
<p>For this first example, we use a subset of the writing assessment data that only includes students’ scores related to the style of their writing. In the second example in this chapter, we use students’ scores related to all four domains.</p>
<p><strong><em>Prepare for the Analyses </em></strong></p>
<p>Use the following code to get started with the <em>TAM</em> package by installing it and loading it into your R environment.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="MFR-model.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;TAM&quot;)</span></span>
<span id="cb1-2"><a href="MFR-model.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;TAM&quot;</span>)</span></code></pre></div>
<p>We will also use the <em>WrightMap</em> package <span class="citation">(<a href="#ref-WrightMap" role="doc-biblioref">Irribarra and Freund 2014</a>)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="MFR-model.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;WrightMap&quot;)</span></span>
<span id="cb2-2"><a href="MFR-model.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;WrightMap&quot;</span>)</span></code></pre></div>
<p>Finally, we will use the <em>psych</em> package <span class="citation">(<a href="#ref-psych" role="doc-biblioref">Revelle 2021</a>)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="MFR-model.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;psych&quot;)</span></span>
<span id="cb3-2"><a href="MFR-model.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;psych&quot;</span>)</span></code></pre></div>
<p>Now that we have installed and loaded the packages to our R session, we are ready to import the data. We will use the function <code>read.csv()</code> to import the comma-separated values (.csv) file that contains the data for the first example. We encourage readers to use their preferred method for importing data files into R or R Studio.</p>
<p>Please note that if you use <code>read.csv()</code> to import the data, you will first need to specify the file path to the location at which the data file is stored on your computer or set your working directory to the folder in which you have saved the data.</p>
<p>First, we will import the data using <code>read.csv()</code> and store it in an object called <code>style</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="MFR-model.html#cb4-1" aria-hidden="true" tabindex="-1"></a>style <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;style_ratings.csv&quot;</span>)</span></code></pre></div>
<p>The style ratings file is in <em>wide format</em>, because there is one row for each of the 372 unique students. We can see this structure by printing the first six rows of the data frame object to our console using the <code>head()</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="MFR-model.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(style)</span></code></pre></div>
<pre><code>##   student language rater_1 rater_2 rater_3 rater_4 rater_5 rater_6 rater_7
## 1       3        1       2       2       2       2       3       3       1
## 2       7        1       2       3       2       3       1       1       1
## 3      11        1       2       2       2       2       2       3       2
## 4      15        1       0       0       0       1       0       0       1
## 5      20        1       1       1       1       2       2       1       1
## 6      24        2       0       0       0       0       0       0       0
##   rater_8 rater_9 rater_10 rater_11 rater_12 rater_13 rater_14 rater_15
## 1       2       2        2        2        2        1        1        2
## 2       2       1        2        3        3        2        1        1
## 3       2       2        2        2        2        2        2        2
## 4       0       0        0        0        1        1        0        0
## 5       1       1        1        1        2        1        0        1
## 6       0       0        0        0        0        0        0        0
##   rater_16 rater_17 rater_18 rater_19 rater_20 rater_21
## 1        2        2        1        1        2        1
## 2        2        1        2        2        1        2
## 3        2        2        2        2        2        1
## 4        0        1        0        0        0        0
## 5        1        1        1        1        1        2
## 6        0        1        0        0        0        0</code></pre>
<p>Next, we will explore the data using descriptive statistics using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="MFR-model.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(style)</span></code></pre></div>
<pre><code>##     student          language        rater_1        rater_2     
##  Min.   :   3.0   Min.   :1.000   Min.   :0.00   Min.   :0.000  
##  1st Qu.: 392.0   1st Qu.:1.000   1st Qu.:1.00   1st Qu.:1.000  
##  Median : 782.0   Median :2.000   Median :2.00   Median :2.000  
##  Mean   : 784.3   Mean   :1.532   Mean   :1.68   Mean   :1.688  
##  3rd Qu.:1171.2   3rd Qu.:2.000   3rd Qu.:2.00   3rd Qu.:2.000  
##  Max.   :1574.0   Max.   :2.000   Max.   :3.00   Max.   :3.000  
##     rater_3         rater_4         rater_5         rater_6     
##  Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
##  1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
##  Median :2.000   Median :2.000   Median :2.000   Median :2.000  
##  Mean   :1.573   Mean   :1.605   Mean   :1.798   Mean   :1.694  
##  3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.:2.000  
##  Max.   :3.000   Max.   :3.000   Max.   :3.000   Max.   :3.000  
##     rater_7         rater_8         rater_9         rater_10       rater_11    
##  Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.00   Min.   :0.000  
##  1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.00   1st Qu.:1.000  
##  Median :2.000   Median :2.000   Median :1.000   Median :2.00   Median :2.000  
##  Mean   :1.667   Mean   :1.548   Mean   :1.347   Mean   :1.82   Mean   :1.664  
##  3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:3.00   3rd Qu.:2.000  
##  Max.   :3.000   Max.   :3.000   Max.   :3.000   Max.   :3.00   Max.   :3.000  
##     rater_12       rater_13        rater_14        rater_15        rater_16    
##  Min.   :0.00   Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
##  1st Qu.:1.00   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
##  Median :2.00   Median :2.000   Median :2.000   Median :2.000   Median :1.000  
##  Mean   :1.68   Mean   :1.694   Mean   :1.551   Mean   :1.809   Mean   :1.508  
##  3rd Qu.:2.00   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  
##  Max.   :3.00   Max.   :3.000   Max.   :3.000   Max.   :3.000   Max.   :3.000  
##     rater_17        rater_18        rater_19        rater_20    
##  Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
##  1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
##  Median :2.000   Median :2.000   Median :1.000   Median :2.000  
##  Mean   :1.505   Mean   :1.586   Mean   :1.454   Mean   :1.508  
##  3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  
##  Max.   :3.000   Max.   :3.000   Max.   :3.000   Max.   :3.000  
##     rater_21    
##  Min.   :0.000  
##  1st Qu.:1.000  
##  Median :2.000  
##  Mean   :1.492  
##  3rd Qu.:2.000  
##  Max.   :3.000</code></pre>
<p>From the summary of <code>style</code>, we can see there are no missing data. In addition, we can get a general sense of the scales, range, and distribution of each variable in the data set. For example, we can see that the data include student identification numbers, a language subgroup variable, and ratings from 21 raters. Student identification numbers range from 3 to 1574. There are two language subgroups: Subgroup 1 (<em>language</em> = 1) indicates that students’ best language is a language other than English, and subgroup 2 (<em>language</em> = 2) indicates that students’ best language is English. The minimum rating from each rater was <span class="math inline">\(x = 0\)</span>, and the maximum rating was <span class="math inline">\(x = 3\)</span>.</p>
<p>Please note that the <em>TAM</em> package requires that the lowest observation for item responses is equal to zero. In our data, this property is already present. If the lowest category is something other than zero, the analyst will need to re-code the responses as we have done in previous chapters.</p>
<p><strong><em>Specify Model Components</em></strong></p>
<p>Now, we are ready to run the MFRM on the style ratings. Because the MFRM equation is researcher-specified, we need to define the components of the model. To do this, we will create an object called <code>facets</code> in which we specify the facets in the model. By default, the <em>TAM</em> package treats the variables that make up the columns of our item response matrix as an “item” facet. In our example, raters function as pseudo-items. Accordingly, raters make up the first facet in our analysis. Our second facet will be student language subgroups. We specify this facet and save it in a data frame object called <code>facets</code>. We specified <code>drop = FALSE</code> because the data frame only includes one column.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="MFR-model.html#cb9-1" aria-hidden="true" tabindex="-1"></a>facets <span class="ot">&lt;-</span> style[ , <span class="st">&quot;language&quot;</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code></pre></div>
<p>Next we need to identify the indicator variable for the object of measurement (i.e., subject). In our example, students are the object of measurement. We will save the student identification numbers in a vector called <code>students.</code></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="MFR-model.html#cb10-1" aria-hidden="true" tabindex="-1"></a>students <span class="ot">&lt;-</span> style<span class="sc">$</span>student</span></code></pre></div>
<p>Finally, we need to specify the response matrix. We do so by extracting the raters’ scores for each student to a data frame object called <code>ratings.</code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="MFR-model.html#cb11-1" aria-hidden="true" tabindex="-1"></a>ratings <span class="ot">&lt;-</span> <span class="fu">subset</span>(style, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(student, language))</span></code></pre></div>
<p>Next, we need to specify the formula for our MFRM. For the first example, we will use a rating scale model specification of the MFRM. This means that we will constrain the threshold parameters to be equal across raters. The model is specified as follows:</p>
<p><span class="math display">\[\begin{equation}\tag{6.2}\ln\left(\frac{P_{n j i(x=k)}}{P_{n j i(x=k-1)}}\right)=\theta_{n}-\gamma_{j}-\lambda_{i}-\tau_{k}\end{equation}\]</span></p>
<p>In Equation 6.2, <span class="math inline">\(\theta_n\)</span> is defined as in Equation 6.1. <span class="math inline">\(\gamma_j\)</span> is the logit-scale location for student language subgroup <span class="math inline">\(j\)</span>, <span class="math inline">\(\lambda_i\)</span> is the logit-scale location for rater <span class="math inline">\(i\)</span>, and <span class="math inline">\(\tau_k\)</span> is the logit-scale location at which there is an equal probability for a rating in category <span class="math inline">\(k\)</span> and category <span class="math inline">\(k-1\)</span>. The subgroup facet (<span class="math inline">\(\gamma_j\)</span>) reflects the overall location of students in subgroup <span class="math inline">\(j\)</span>, where higher locations indicate higher levels of writing proficiency, and lower locations indicate lower levels of writing proficiency. The rater facet (<span class="math inline">\(\lambda_i\)</span>) reflects the severity level of individual rater <span class="math inline">\(i\)</span>, where higher locations mean that the rater is more severe, and requires higher levels of writing proficiency before giving high ratings to student performances. Lower rater locations indicate relatively lenient raters, who readily give high ratings to student performances.</p>
<p>We specify the MFRM from Equation 6.2 in an object for use with <em>TAM</em> as follows. First, we specify a name for the model object (<code>style_RS_MFRM</code>), which is defined using the tilde symbol (~), followed by the facet names. As a reminder, the model must include a facet named <em>item</em>; in our example, the item facet is made up of raters. We also include the student language subgroup (<em>language</em>) as a facet. Finally, we specify <em>step</em> to indicate the RS model. The components of the model are separated by addition signs (+) because the facets are additive. We will use interactions in a MFRM later in this chapter.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="MFR-model.html#cb12-1" aria-hidden="true" tabindex="-1"></a>style_RS_MFRM <span class="ot">&lt;-</span> <span class="er">~</span> item <span class="sc">+</span> language <span class="sc">+</span> step</span></code></pre></div>
<p><strong><em>Run the RS-MFRM</em></strong></p>
<p>Now we can run our RS-MFRM. We do so using the <code>tam.mml.mfr()</code> function, in which we specify the response matrix (<code>resp=</code>), our specified facets (<code>facets=</code>), the model equation (<code>formulaA=</code>), and the identification numbers for the object of measurement (<code>pid=</code>).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="MFR-model.html#cb13-1" aria-hidden="true" tabindex="-1"></a>RS_MFR_model <span class="ot">&lt;-</span> <span class="fu">tam.mml.mfr</span>(<span class="at">resp =</span> ratings, <span class="at">facets =</span> facets, <span class="at">formulaA =</span> style_RS_MFRM, <span class="at">pid =</span> students, <span class="at">constraint =</span> <span class="st">&quot;items&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><strong><em>Overall Model Summary</em></strong></p>
<p>After we run the model, we will request a summary of the model results using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="MFR-model.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RS_MFR_model)</span></code></pre></div>
<p>The summary of the MFRM is lengthy. Included among the output are several details that may be important for some analyses, including details about each iteration, global model-fit indicators (e.g., deviance, log-likelihood, AIC, BIC) and an estimate of person separation reliability (EAP Reliability). We will focus our interpretation on the location estimates for the student, subgroup, rater, and threshold parameters.</p>
<p><strong><em>Facet Results</em></strong></p>
<p>Next, we will save the parameter estimates from the RS-MFRM in a data frame object called <code>facet.estimates</code>. This object includes the location estimates and standard errors for raters, student subgroups, and thresholds. Locations estimates are labeled <code>xsi</code> and standard errors are labeled <code>se.xsi</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="MFR-model.html#cb15-1" aria-hidden="true" tabindex="-1"></a>facet.estimates <span class="ot">&lt;-</span> RS_MFR_model<span class="sc">$</span>xsi.facets</span></code></pre></div>
<p>For easier reference, we will now create objects in which we store the location estimates and standard errors for raters, subgroups, and thresholds separately. We do this by applying the <code>subset()</code> function to the <code>facet.estimates</code> object.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="MFR-model.html#cb16-1" aria-hidden="true" tabindex="-1"></a>rater.estimates <span class="ot">&lt;-</span> <span class="fu">subset</span>(facet.estimates, facet.estimates<span class="sc">$</span>facet <span class="sc">==</span> <span class="st">&quot;item&quot;</span>)</span>
<span id="cb16-2"><a href="MFR-model.html#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="MFR-model.html#cb16-3" aria-hidden="true" tabindex="-1"></a>subgroup.estimates <span class="ot">&lt;-</span> <span class="fu">subset</span>(facet.estimates, facet.estimates<span class="sc">$</span>facet <span class="sc">==</span> <span class="st">&quot;language&quot;</span>)</span>
<span id="cb16-4"><a href="MFR-model.html#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="MFR-model.html#cb16-5" aria-hidden="true" tabindex="-1"></a>threshold.estimates <span class="ot">&lt;-</span> <span class="fu">subset</span>(facet.estimates, facet.estimates<span class="sc">$</span>facet <span class="sc">==</span> <span class="st">&quot;step&quot;</span>)</span></code></pre></div>
<p><strong><em>Rater Facet Results</em></strong></p>
<p>Next, we will request a summary of the rater facet estimates.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="MFR-model.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rater.estimates)</span></code></pre></div>
<pre><code>##   parameter            facet                xsi               se.xsi       
##  Length:21          Length:21          Min.   :-0.86778   Min.   :0.07494  
##  Class :character   Class :character   1st Qu.:-0.31386   1st Qu.:0.07497  
##  Mode  :character   Mode  :character   Median : 0.03373   Median :0.07499  
##                                        Mean   : 0.00000   Mean   :0.08744  
##                                        3rd Qu.: 0.43770   3rd Qu.:0.07509  
##                                        Max.   : 1.11732   Max.   :0.33558</code></pre>
<p>From the summary of rater locations, we can see that rater severity estimates range from <span class="math inline">\(\lambda\)</span> = -0.87 for the most lenient rater to <span class="math inline">\(\lambda\)</span> = 1.12 for the most severe rater. The average rater severity location is set to zero logits.</p>
<p><strong><em>Student Subgroup Facet Results</em></strong></p>
<p>Next, we will examine the language subgroup estimates using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="MFR-model.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(subgroup.estimates<span class="sc">$</span>xsi)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -0.06565 -0.03283  0.00000  0.00000  0.03283  0.06565</code></pre>
<p>We can also print the locations to our console to inspect them.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="MFR-model.html#cb21-1" aria-hidden="true" tabindex="-1"></a>subgroup.estimates<span class="sc">$</span>xsi</span></code></pre></div>
<pre><code>## [1] -0.06565052  0.06565052</code></pre>
<p>We can see that the two student subgroup locations are quite close to one another. As a group, students whose best language is a language other than English (<em>language</em> = 1) had a slightly lower location on the logit scale (<span class="math inline">\(\gamma_1\)</span> = -0.07 logits) compared to students whose best language was English (<em>language</em> 2; <span class="math inline">\(\gamma_2\)</span> = 0.07 logits). Although there was a difference in subgroup locations, the difference was very small (about 0.13 logits), and therefore likely does not reflect a substantively meaningful difference in writing achievement between these two groups.</p>
<p><strong><em>Student estimates</em></strong></p>
<p>Next, we will examine the student location estimates from the RS-MFRM. We will apply the <code>tam.wle()</code> function to our model object (<code>RS_MFR_model</code>) and store the results in an object called <code>student.ach</code>. Then, we will store the student identification numbers, location estimates, and standard errors in a new object called <code>student.locations_RSMFR</code>. Finally, we will summarize the results using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="MFR-model.html#cb23-1" aria-hidden="true" tabindex="-1"></a>student.ach <span class="ot">&lt;-</span> <span class="fu">tam.wle</span>(RS_MFR_model)</span>
<span id="cb23-2"><a href="MFR-model.html#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="MFR-model.html#cb23-3" aria-hidden="true" tabindex="-1"></a>student.locations_RSMFR <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(student.ach<span class="sc">$</span>pid, student.ach<span class="sc">$</span>theta, student.ach<span class="sc">$</span>error)</span>
<span id="cb23-4"><a href="MFR-model.html#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="MFR-model.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(student.locations_RSMFR) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;theta&quot;</span>, <span class="st">&quot;se&quot;</span>)</span>
<span id="cb23-6"><a href="MFR-model.html#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="MFR-model.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(student.locations_RSMFR)</span></code></pre></div>
<p>From the summary of the student achievement locations, we can see that student achievement ranges from <span class="math inline">\(\theta\)</span> = -7.96 logits for the student with the lowest achievement estimate to <span class="math inline">\(\theta\)</span> = 7.60 for the student with the highest achievement estimate. On average, the students were located slightly higher (<span class="math inline">\(M\)</span> <span class="math inline">\(\theta\)</span>) = 0.47) than the average rater location (<span class="math inline">\(M\)</span> <span class="math inline">\(\lambda\)</span> = 0.00).</p>
<p><strong><em>Threshold Estimates</em></strong></p>
<p>Next we will examine the threshold estimates. Because we used a RS formulation of the MFRM, there is one set of threshold estimates for our model that applies across raters. We will print the threshold estimates to the console to view them.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="MFR-model.html#cb24-1" aria-hidden="true" tabindex="-1"></a>threshold.estimates<span class="sc">$</span>xsi</span></code></pre></div>
<pre><code>## [1] -4.0087904  0.2353612  3.7734293</code></pre>
<p>As we discussed in Chapter 4 and Chapter 5, analysts can evaluate the order of the threshold locations for evidence that they are non-decreasing across increasing rating scale categories.</p>
<p><strong><em>Wright Map</em></strong></p>
<p>Next, we will plot a Wright Map to display the locations of the parameter estimates for our RS-MFR model. To do this, we need to manipulate the location estimate objects into the format required for the <em>WrightMap</em> package.</p>
<p>First, we need to store the rater location estimates as a matrix that shows rater-specific threshold locations. We accomplish this task using a for-loop in which we add each rater’s location to the three threshold values and store the results in a matrix called <code>rater_thresholds</code>. We use the <code>head()</code> function to preview the first six rows of the results in the console.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="MFR-model.html#cb26-1" aria-hidden="true" tabindex="-1"></a>rater_thresholds <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(rater.estimates), <span class="at">ncol =</span> <span class="fu">nrow</span>(threshold.estimates))</span>
<span id="cb26-2"><a href="MFR-model.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="MFR-model.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rater <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rater.estimates)){</span>
<span id="cb26-4"><a href="MFR-model.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(tau <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(threshold.estimates)){</span>
<span id="cb26-5"><a href="MFR-model.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  rater_thresholds[rater,tau] <span class="ot">&lt;-</span> (rater.estimates<span class="sc">$</span>xsi[rater] <span class="sc">+</span> threshold.estimates<span class="sc">$</span>xsi[tau])</span>
<span id="cb26-6"><a href="MFR-model.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  }                                </span>
<span id="cb26-7"><a href="MFR-model.html#cb26-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-8"><a href="MFR-model.html#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="MFR-model.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rater_thresholds)</span></code></pre></div>
<pre><code>##           [,1]        [,2]     [,3]
## [1,] -4.288967 -0.04481525 3.493253
## [2,] -4.322646 -0.07849438 3.459574
## [3,] -3.840553  0.40359889 3.941667
## [4,] -3.975059  0.26909229 3.807160
## [5,] -4.785429 -0.54127709 2.996791
## [6,] -4.345107 -0.10095584 3.437112</code></pre>
<p>Finally, we can plot the Wright map using the <code>wrightMap()</code> function. We specify several graphical parameters to modify the appearance of the plot.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="MFR-model.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wrightMap</span>(<span class="at">thetas =</span> <span class="fu">cbind</span>(student.locations_RSMFR<span class="sc">$</span>theta, subgroup.estimates<span class="sc">$</span>xsi),</span>
<span id="cb28-2"><a href="MFR-model.html#cb28-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.persons =</span> <span class="st">&quot;Students&quot;</span>,</span>
<span id="cb28-3"><a href="MFR-model.html#cb28-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dim.names =</span> <span class="fu">c</span>(<span class="st">&quot;Students&quot;</span>, <span class="st">&quot;Subgroups&quot;</span>), </span>
<span id="cb28-4"><a href="MFR-model.html#cb28-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">thresholds =</span> rater_thresholds,</span>
<span id="cb28-5"><a href="MFR-model.html#cb28-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.thr.lab  =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-6"><a href="MFR-model.html#cb28-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">label.items.rows=</span> <span class="dv">2</span>,</span>
<span id="cb28-7"><a href="MFR-model.html#cb28-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">label.items =</span> rater.estimates<span class="sc">$</span>parameter,</span>
<span id="cb28-8"><a href="MFR-model.html#cb28-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.items =</span> <span class="st">&quot;Raters&quot;</span>,</span>
<span id="cb28-9"><a href="MFR-model.html#cb28-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title =</span> <span class="st">&quot;Rating Scale Many-Facet Rasch Model Wright Map:</span><span class="sc">\n</span><span class="st"> Style Ratings&quot;</span>,</span>
<span id="cb28-10"><a href="MFR-model.html#cb28-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex.main =</span> .<span class="dv">6</span>)</span></code></pre></div>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre><code>##            [,1]        [,2]     [,3]
##  [1,] -4.288967 -0.04481525 3.493253
##  [2,] -4.322646 -0.07849438 3.459574
##  [3,] -3.840553  0.40359889 3.941667
##  [4,] -3.975059  0.26909229 3.807160
##  [5,] -4.785429 -0.54127709 2.996791
##  [6,] -4.345107 -0.10095584 3.437112
##  [7,] -4.232865  0.01128652 3.549355
##  [8,] -3.739598  0.50455410 4.042622
##  [9,] -2.891467  1.35268451 4.890753
## [10,] -4.876566 -0.63241444 2.905654
## [11,] -4.221649  0.02250299 3.560571
## [12,] -4.288967 -0.04481525 3.493253
## [13,] -4.345107 -0.10095584 3.437112
## [14,] -3.750819  0.49333235 4.031400
## [15,] -4.830952 -0.58680019 2.951268
## [16,] -3.571092  0.67305934 4.211127
## [17,] -3.559845  0.68430692 4.222375
## [18,] -3.896607  0.34754470 3.885613
## [19,] -3.345721  0.89843079 4.436499
## [20,] -3.571092  0.67305934 4.211127
## [21,] -3.504491  0.73966026 4.277728</code></pre>
<p>In this <em>Wright Map</em> display, the results from the RS-MFRM analysis of the style ratings are summarized graphically. The figure is organized as follows:</p>
<ul>
<li><p>Units on the logit scale are shown on the far-right axis of the plot (labeled <em>Logits</em>).</p></li>
<li><p>The left-most panel shows a histogram of student locations on the logit scale that represents the latent variable.</p></li>
<li><p>The second panel from the left shows the distribution of subgroups on the logit scale. There are only two subgroups in our analysis.</p></li>
</ul>
<p>The large central panel shows the rating scale category threshold estimates specific to each rater on the logit scale that represents the latent variable. Light gray diamond shapes show the logit scale location of the threshold estimates for each rater, as labeled on the x-axis. Thresholds are labeled using integers that show the threshold number. In our example, <span class="math inline">\(\tau_1\)</span> is the threshold between rating scale categories <span class="math inline">\(x=0\)</span> and <span class="math inline">\(x=1\)</span>, <span class="math inline">\(\tau_2\)</span> is the threshold between rating scale categories <span class="math inline">\(x=1\)</span> and <span class="math inline">\(x=2\)</span>, and <span class="math inline">\(\tau_3\)</span> is the threshold between rating scale categories <span class="math inline">\(x=2\)</span> and <span class="math inline">\(x=3\)</span>. Because we used a RS model formulation, the distance between adjacent thresholds is the same for all of the raters in the analysis.</p>
<p>Even though it is not appropriate to fully interpret item and person locations on the logit scale until there is evidence of acceptable model-data fit, we recommend examining the Wright Map during the preliminary stages of a MFRM analysis to get a general sense of the model results and to identify any potential scoring or data entry errors.</p>
<p>The Wright Map suggests that, on average, the students are located higher on the logit scale compared to the average rater threshold locations. In addition, there appears to be a relatively wide spread of student and rater locations on the logit scale, such that the style writing assessment appears to be a useful tool for identifying differences in students’ writing achievement related to style as well as differences in rater severity. The subgroup locations are close together, suggesting that there is not a substantial difference in the logit-scale locations between students in either language subgroup.</p>
<p><strong><em>Evaluate Model-Data Fit</em></strong></p>
<p>Because the MFR model analyses result in notably different output structures from the other models in this book, we demonstrate a procedure for evaluating model-data fit specific to the MFRM with the TAM package. These procedures generally follow the methods that we presented in Chapter 3. We encourage readers to refer to Chapter 3 for more details about model-data fit analysis procedures in the context of Rasch measurement theory.</p>
<p><strong><em>Unidimensionality</em></strong></p>
<p>First, we will evaluate the MFRM requirement for unidimensionality using the procedure that we demonstrated in Chapter 3. We will evaluate this requirement by examining the residuals for evidence of potential secondary latent variables in the rating data.</p>
<p>First, we will extract the model residuals using the <code>IRT.residuals()</code> function. We will save the results in an object called <code>resids.</code></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="MFR-model.html#cb30-1" aria-hidden="true" tabindex="-1"></a>resids <span class="ot">&lt;-</span> <span class="fu">IRT.residuals</span>(RS_MFR_model)</span></code></pre></div>
<p>With the MFRM in <em>TAM</em>, residuals are presented separately for each level of the explanatory facets. We need to do some manipulation to construct a typical residual matrix.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="MFR-model.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the raw residuals from the residuals object:</span></span>
<span id="cb31-2"><a href="MFR-model.html#cb31-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resids<span class="sc">$</span>residuals)</span>
<span id="cb31-3"><a href="MFR-model.html#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="MFR-model.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the residuals in a matrix:</span></span>
<span id="cb31-5"><a href="MFR-model.html#cb31-5" aria-hidden="true" tabindex="-1"></a>resid.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(style), <span class="at">ncol =</span> <span class="fu">ncol</span>(ratings))</span>
<span id="cb31-6"><a href="MFR-model.html#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="MFR-model.html#cb31-7" aria-hidden="true" tabindex="-1"></a>ngroups <span class="ot">&lt;-</span> <span class="fu">nrow</span>(subgroup.estimates)</span>
<span id="cb31-8"><a href="MFR-model.html#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="MFR-model.html#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rater.number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ratings)){</span>
<span id="cb31-10"><a href="MFR-model.html#cb31-10" aria-hidden="true" tabindex="-1"></a>  group.raters <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb31-11"><a href="MFR-model.html#cb31-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-12"><a href="MFR-model.html#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(group <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ngroups){</span>
<span id="cb31-13"><a href="MFR-model.html#cb31-13" aria-hidden="true" tabindex="-1"></a>    group.raters[group] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;rater_&quot;</span>, rater.number, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;language&quot;</span>, group, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb31-14"><a href="MFR-model.html#cb31-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-15"><a href="MFR-model.html#cb31-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-16"><a href="MFR-model.html#cb31-16" aria-hidden="true" tabindex="-1"></a>  rater <span class="ot">&lt;-</span> <span class="fu">subset</span>(r, <span class="at">select =</span> group.raters)</span>
<span id="cb31-17"><a href="MFR-model.html#cb31-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-18"><a href="MFR-model.html#cb31-18" aria-hidden="true" tabindex="-1"></a>  resid.matrix[, rater.number] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(rater, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-19"><a href="MFR-model.html#cb31-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The resulting residual matrix (<code>resid.matrix</code>) contains unstandardized residuals for each rater in combination with each student. We can request a summary of the residuals using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="MFR-model.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(resid.matrix)</span></code></pre></div>
<pre><code>##        V1                   V2                   V3            
##  Min.   :-0.8720729   Min.   :-1.4209183   Min.   :-1.4791267  
##  1st Qu.:-0.2549334   1st Qu.:-0.2744779   1st Qu.:-0.2851512  
##  Median :-0.0076902   Median : 0.0132244   Median :-0.0509807  
##  Mean   : 0.0005486   Mean   : 0.0005993   Mean   :-0.0001347  
##  3rd Qu.: 0.2620248   3rd Qu.: 0.2920722   3rd Qu.: 0.2781122  
##  Max.   : 0.8322741   Max.   : 1.1051632   Max.   : 1.3321391  
##        V4                   V5                  V6            
##  Min.   :-1.2272450   Min.   :-1.652838   Min.   :-1.6572936  
##  1st Qu.:-0.2748731   1st Qu.:-0.331711   1st Qu.:-0.2807091  
##  Median :-0.0406553   Median : 0.030419   Median : 0.0109285  
##  Mean   : 0.0000747   Mean   : 0.001325   Mean   : 0.0006332  
##  3rd Qu.: 0.2935872   3rd Qu.: 0.376558   3rd Qu.: 0.3427064  
##  Max.   : 1.1978115   Max.   : 1.161870   Max.   : 1.3303463  
##        V7                   V8                   V9           
##  Min.   :-1.8408973   Min.   :-1.2572054   Min.   :-1.490954  
##  1st Qu.:-0.3348203   1st Qu.:-0.2642677   1st Qu.:-0.260770  
##  Median : 0.0032260   Median :-0.0403967   Median :-0.002861  
##  Mean   : 0.0004644   Mean   :-0.0002966   Mean   :-0.001895  
##  3rd Qu.: 0.3692606   3rd Qu.: 0.3012835   3rd Qu.: 0.291447  
##  Max.   : 1.1287309   Max.   : 1.2138758   Max.   : 1.196117  
##       V10                 V11                  V12            
##  Min.   :-1.697046   Min.   :-1.7755510   Min.   :-1.1677259  
##  1st Qu.:-0.364370   1st Qu.:-0.2788164   1st Qu.:-0.2651588  
##  Median : 0.048410   Median : 0.0054078   Median :-0.0076902  
##  Mean   : 0.001479   Mean   : 0.0004475   Mean   : 0.0005486  
##  3rd Qu.: 0.320855   3rd Qu.: 0.2926797   3rd Qu.: 0.3079294  
##  Max.   : 1.588882   Max.   : 1.1316914   Max.   : 1.2168715  
##       V13                  V14                  V15           
##  Min.   :-1.2807091   Min.   :-1.3077252   Min.   :-1.514814  
##  1st Qu.:-0.2807091   1st Qu.:-0.2640100   1st Qu.:-0.353619  
##  Median :-0.0186308   Median :-0.0280155   Median : 0.027757  
##  Mean   : 0.0006332   Mean   :-0.0002784   Mean   : 0.001402  
##  3rd Qu.: 0.2832192   3rd Qu.: 0.3412485   3rd Qu.: 0.333995  
##  Max.   : 2.1162376   Max.   : 1.2598161   Max.   : 1.659905  
##       V16                  V17                  V18            
##  Min.   :-1.2111909   Min.   :-1.5034851   Min.   :-1.2532089  
##  1st Qu.:-0.2631766   1st Qu.:-0.2427598   1st Qu.:-0.3478416  
##  Median :-0.0283414   Median :-0.0254666   Median :-0.0252699  
##  Mean   :-0.0005784   Mean   :-0.0005978   Mean   :-0.0000467  
##  3rd Qu.: 0.2917640   3rd Qu.: 0.2945528   3rd Qu.: 0.3573667  
##  Max.   : 1.5083632   Max.   : 0.9947392   Max.   : 1.7823467  
##       V19                  V20                  V21            
##  Min.   :-1.9707405   Min.   :-1.3069233   Min.   :-1.3787713  
##  1st Qu.:-0.2908683   1st Qu.:-0.2577943   1st Qu.:-0.3494886  
##  Median :-0.0163420   Median :-0.0403857   Median :-0.0250489  
##  Mean   :-0.0009824   Mean   :-0.0005784   Mean   :-0.0009128  
##  3rd Qu.: 0.3191823   3rd Qu.: 0.2760813   3rd Qu.: 0.3611649  
##  Max.   : 1.3759946   Max.   : 1.6930767   Max.   : 1.1498697</code></pre>
<p>Next, we will calculate standardized residuals and save them in a matrix.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="MFR-model.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract standardized residuals from the resids object:</span></span>
<span id="cb34-2"><a href="MFR-model.html#cb34-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resids<span class="sc">$</span>stand_residuals)</span>
<span id="cb34-3"><a href="MFR-model.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="MFR-model.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the standardized residuals in a matrix:</span></span>
<span id="cb34-5"><a href="MFR-model.html#cb34-5" aria-hidden="true" tabindex="-1"></a>std.resid.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(style), <span class="at">ncol =</span> <span class="fu">ncol</span>(ratings))</span>
<span id="cb34-6"><a href="MFR-model.html#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="MFR-model.html#cb34-7" aria-hidden="true" tabindex="-1"></a>ngroups <span class="ot">&lt;-</span> <span class="fu">nrow</span>(subgroup.estimates)</span>
<span id="cb34-8"><a href="MFR-model.html#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="MFR-model.html#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rater.number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ratings)){</span>
<span id="cb34-10"><a href="MFR-model.html#cb34-10" aria-hidden="true" tabindex="-1"></a>  group.raters <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb34-11"><a href="MFR-model.html#cb34-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-12"><a href="MFR-model.html#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(group <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ngroups){</span>
<span id="cb34-13"><a href="MFR-model.html#cb34-13" aria-hidden="true" tabindex="-1"></a>    group.raters[group] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;rater_&quot;</span>, rater.number, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;language&quot;</span>, group, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb34-14"><a href="MFR-model.html#cb34-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-15"><a href="MFR-model.html#cb34-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-16"><a href="MFR-model.html#cb34-16" aria-hidden="true" tabindex="-1"></a>  rater <span class="ot">&lt;-</span> <span class="fu">subset</span>(s, <span class="at">select =</span> group.raters)</span>
<span id="cb34-17"><a href="MFR-model.html#cb34-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-18"><a href="MFR-model.html#cb34-18" aria-hidden="true" tabindex="-1"></a>  std.resid.matrix[, rater.number] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(rater, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-19"><a href="MFR-model.html#cb34-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The resulting standardized residual matrix (<code>std.resid.matrix</code>) contains standardized residuals for each rater in combination with each student. We can request a summary of the standardized residuals using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="MFR-model.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(std.resid.matrix)</span></code></pre></div>
<pre><code>##        V1                  V2                  V3           
##  Min.   :-1.905508   Min.   :-2.673927   Min.   :-2.804533  
##  1st Qu.:-0.506572   1st Qu.:-0.527221   1st Qu.:-0.547302  
##  Median :-0.017429   Median : 0.026156   Median :-0.116122  
##  Mean   : 0.001835   Mean   : 0.000882   Mean   :-0.005136  
##  3rd Qu.: 0.539578   3rd Qu.: 0.592587   3rd Qu.: 0.600033  
##  Max.   : 1.614373   Max.   : 2.232782   Max.   : 2.480104  
##        V4                  V5                  V6           
##  Min.   :-2.351961   Min.   :-3.550681   Min.   :-4.632938  
##  1st Qu.:-0.545774   1st Qu.:-0.643632   1st Qu.:-0.574105  
##  Median :-0.091645   Median : 0.154482   Median : 0.038452  
##  Mean   :-0.002623   Mean   :-0.000654   Mean   :-0.001968  
##  3rd Qu.: 0.561215   3rd Qu.: 0.733945   3rd Qu.: 0.699961  
##  Max.   : 2.294916   Max.   : 2.445845   Max.   : 2.558106  
##        V7                  V8                  V9                V10           
##  Min.   :-5.001028   Min.   :-2.395289   Min.   :-2.76309   Min.   :-3.631079  
##  1st Qu.:-0.653402   1st Qu.:-0.553848   1st Qu.:-0.53408   1st Qu.:-0.714225  
##  Median : 0.007315   Median :-0.091069   Median :-0.03185   Median : 0.107363  
##  Mean   : 0.002132   Mean   :-0.004299   Mean   :-0.01786   Mean   : 0.007239  
##  3rd Qu.: 0.723834   3rd Qu.: 0.630877   3rd Qu.: 0.55894   3rd Qu.: 0.648215  
##  Max.   : 2.621032   Max.   : 2.342300   Max.   : 2.50557   Max.   : 2.991603  
##       V11                 V12                  V13                V14          
##  Min.   :-3.379879   Min.   :-2.4268836   Min.   :-2.43750   Min.   :-2.47939  
##  1st Qu.:-0.559049   1st Qu.:-0.5582567   1st Qu.:-0.57410   1st Qu.:-0.52845  
##  Median : 0.012261   Median :-0.0174290   Median :-0.04218   Median :-0.09599  
##  Mean   : 0.000516   Mean   :-0.0009097   Mean   : 0.01468   Mean   :-0.00148  
##  3rd Qu.: 0.600774   3rd Qu.: 0.6148613   3rd Qu.: 0.58357   3rd Qu.: 0.66432  
##  Max.   : 2.279635   Max.   : 2.5338432   Max.   : 4.65120   Max.   : 3.34157  
##       V15                 V16                V17                 V18          
##  Min.   :-3.633244   Min.   :-2.32838   Min.   :-2.866723   Min.   :-2.47200  
##  1st Qu.:-0.690213   1st Qu.:-0.52702   1st Qu.:-0.485482   1st Qu.:-0.65646  
##  Median : 0.128835   Median :-0.08551   Median :-0.080362   Median :-0.05715  
##  Mean   :-0.009865   Mean   : 0.01256   Mean   : 0.006671   Mean   : 0.01111  
##  3rd Qu.: 0.631985   3rd Qu.: 0.58627   3rd Qu.: 0.586370   3rd Qu.: 0.70809  
##  Max.   : 3.202808   Max.   : 2.99223   Max.   : 4.899036   Max.   : 4.29775  
##       V19                 V20                V21           
##  Min.   :-3.894471   Min.   :-3.13528   Min.   :-2.621914  
##  1st Qu.:-0.584566   1st Qu.:-0.52702   1st Qu.:-0.720283  
##  Median :-0.032333   Median :-0.11528   Median :-0.086063  
##  Mean   :-0.003165   Mean   :-0.02053   Mean   :-0.003733  
##  3rd Qu.: 0.622024   3rd Qu.: 0.58068   3rd Qu.: 0.709318  
##  Max.   : 4.095676   Max.   : 3.31535   Max.   : 2.637999</code></pre>
<p>Next, we will calculate the variance in observations due to Rasch-model-estimated locations.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="MFR-model.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance of the observations: VO</span></span>
<span id="cb37-2"><a href="MFR-model.html#cb37-2" aria-hidden="true" tabindex="-1"></a>observations.vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(ratings))</span>
<span id="cb37-3"><a href="MFR-model.html#cb37-3" aria-hidden="true" tabindex="-1"></a>VO <span class="ot">&lt;-</span> <span class="fu">var</span>(observations.vector)</span>
<span id="cb37-4"><a href="MFR-model.html#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="MFR-model.html#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance of the residuals: VR</span></span>
<span id="cb37-6"><a href="MFR-model.html#cb37-6" aria-hidden="true" tabindex="-1"></a>residuals.vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(resid.matrix)</span>
<span id="cb37-7"><a href="MFR-model.html#cb37-7" aria-hidden="true" tabindex="-1"></a>VR <span class="ot">&lt;-</span> <span class="fu">var</span>(residuals.vector)</span>
<span id="cb37-8"><a href="MFR-model.html#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="MFR-model.html#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw variance explained by Rasch measures: (VO - VR)/VO</span></span>
<span id="cb37-10"><a href="MFR-model.html#cb37-10" aria-hidden="true" tabindex="-1"></a>(VO <span class="sc">-</span> VR)<span class="sc">/</span>VO</span></code></pre></div>
<pre><code>## [1] 0.7418448</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="MFR-model.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Express the result as a percent:</span></span>
<span id="cb39-2"><a href="MFR-model.html#cb39-2" aria-hidden="true" tabindex="-1"></a>((VO <span class="sc">-</span> VR)<span class="sc">/</span>VO) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 74.18448</code></pre>
<p>Our analysis indicates that approximately 74.18% of the variance in ratings can be explained by the MFRM estimates of student, subgroup, and rater locations on the logit scale that represents the latent variable.</p>
<p><strong><em>Principal Components Analysis of Standardized Residual Correlations</em></strong></p>
<p>Next, we will evaluate the MFRM requirement for unidimensionality using a principal components analysis (PCA) of standardized residual correlations.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="MFR-model.html#cb41-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">pca</span>(std.resid.matrix, <span class="at">nfactors =</span> <span class="fu">ncol</span>(ratings), <span class="at">rotate =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb41-2"><a href="MFR-model.html#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="MFR-model.html#cb41-3" aria-hidden="true" tabindex="-1"></a>contrasts <span class="ot">&lt;-</span> <span class="fu">c</span>(pca<span class="sc">$</span>values[<span class="dv">1</span>], pca<span class="sc">$</span>values[<span class="dv">2</span>], pca<span class="sc">$</span>values[<span class="dv">3</span>], pca<span class="sc">$</span>values[<span class="dv">4</span>], pca<span class="sc">$</span>values[<span class="dv">5</span>])</span>
<span id="cb41-4"><a href="MFR-model.html#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="MFR-model.html#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(contrasts, <span class="at">ylab =</span> <span class="st">&quot;Eigenvalues for Contrasts&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Contrast Number&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Contrasts from PCA of Standardized Residual Correlations&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>In this example, all of the contrasts have eigenvalues that are smaller than <span class="citation"><a href="#ref-PCA_procedure" role="doc-biblioref">John Michael Linacre</a> (<a href="#ref-PCA_procedure" role="doc-biblioref">2016</a>)</span>’s critical value of 2.00. This result suggests that the correlations among the model residuals primarily reflect randomness (i.e., noise)–thus providing evidence that the responses adequately adhere to the Rasch model requirement of unidimensionality.</p>
<p><strong><em>Summaries of Residuals: Infit &amp; Outfit Statistics</em></strong></p>
<p>Next, we will evaluate model-data fit for individual elements of our facets (students, subgroups, and raters) using numeric summaries of the residuals associated with each element, as we have done in previous chapters.</p>
<p><strong><em>Student fit</em></strong></p>
<p>First, we will examine student fit using numeric infit and outfit statistics. We can request these statistics for each student using the <code>tam.personfit()</code> function. We will store the student fit results in an object called <code>student.fit</code>, and then request a summary of the results.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="MFR-model.html#cb42-1" aria-hidden="true" tabindex="-1"></a>student.fit <span class="ot">&lt;-</span> <span class="fu">tam.personfit</span>(RS_MFR_model)</span>
<span id="cb42-2"><a href="MFR-model.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(student.fit)</span></code></pre></div>
<pre><code>##   outfitPerson     outfitPerson_t     infitPerson      infitPerson_t    
##  Min.   :0.02316   Min.   :-4.4319   Min.   :0.02864   Min.   :-4.4127  
##  1st Qu.:0.68599   1st Qu.:-0.9745   1st Qu.:0.71529   1st Qu.:-0.9820  
##  Median :0.86657   Median :-0.3590   Median :0.87397   Median :-0.3395  
##  Mean   :0.89235   Mean   :-0.3164   Mean   :0.90160   Mean   :-0.3018  
##  3rd Qu.:1.05760   3rd Qu.: 0.2927   3rd Qu.:1.03086   3rd Qu.: 0.2107  
##  Max.   :2.27289   Max.   : 3.5578   Max.   :2.39705   Max.   : 3.6511</code></pre>
<p>On average, the outfit and infit <span class="math inline">\(MSE\)</span> statistics are slightly lower than the expected value of 1 (<span class="math inline">\(M\)</span> outfit = 0.89, <span class="math inline">\(M\)</span> infit = 0.90). The average values of the standardized fit statistics are also slightly lower than their expected value of 0 (<span class="math inline">\(M\)</span> standardized outfit = -0.33, <span class="math inline">\(M\)</span> standardized infit = -0.31). For both the standardized and unstandardized fit statistics, there is notable variability across the student sample. This result suggests that model-data fit varies for individual students.</p>
<p><strong><em>Subgroup and Rater Fit</em></strong></p>
<p>We can also examine model-data fit related to the subgroup and rater facets. In the <em>TAM</em> package, fit analysis for facets besides the object of measurement uses combinations of elements within facets. In our example, fit statistics are calculated for rater*subgroup combinations.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="MFR-model.html#cb44-1" aria-hidden="true" tabindex="-1"></a>rater.subgroup.fit <span class="ot">&lt;-</span> <span class="fu">msq.itemfit</span>(RS_MFR_model)</span>
<span id="cb44-2"><a href="MFR-model.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rater.subgroup.fit)</span></code></pre></div>
<pre><code>## ------------------------------------------------------------
## TAM 3.7-16 (2021-06-24 14:31:37) 
## R version 4.1.0 (2021-05-18) x86_64, darwin17.0 | nodename=Chengs-iMac | login=root 
## 
## Date of Analysis: 2021-08-16 10:36:52 
## Time difference of 0.0612421 secs
## Computation time: 0.0612421 
## 
## MSQ item fit statitics (Function &#39;msq.itemfit&#39;)
## 
## Call:
## msq.itemfit(object = RS_MFR_model)
## 
## ****************************************************
## 
## Summary outfit and infit statistic
##      fit     M    SD
## 1 Outfit 0.948 0.187
## 2  Infit 0.956 0.175
## 
## ****************************************************
## 
## Outfit and infit statistic
##                  item fitgroup Outfit Outfit_t Outfit_p Infit Infit_t Infit_p
## 1   rater_1-language1        1  0.538   -4.842    0.000 0.569  -4.906   0.000
## 2   rater_1-language2        2  0.515   -5.661    0.000 0.550  -5.551   0.000
## 3  rater_10-language1        3  0.994   -0.004    0.997 1.010   0.136   0.892
## 4  rater_10-language2        4  1.163    1.417    0.156 1.189   1.870   0.062
## 5  rater_11-language1        5  0.707   -2.821    0.005 0.745  -2.643   0.008
## 6  rater_11-language2        6  0.968   -0.271    0.786 1.000   0.029   0.977
## 7  rater_12-language1        7  0.809   -1.747    0.081 0.835  -1.647   0.100
## 8  rater_12-language2        8  0.859   -1.387    0.165 0.860  -1.478   0.139
## 9  rater_13-language1        9  0.633   -3.645    0.000 0.660  -3.696   0.000
## 10 rater_13-language2       10  0.989   -0.067    0.946 0.997  -0.004   0.997
## 11 rater_14-language1       11  0.945   -0.447    0.655 0.960  -0.341   0.733
## 12 rater_14-language2       12  1.062    0.614    0.539 1.058   0.610   0.542
## 13 rater_15-language1       13  1.095    0.794    0.427 1.070   0.701   0.483
## 14 rater_15-language2       14  1.161    1.413    0.158 1.073   0.772   0.440
## 15 rater_16-language1       15  0.749   -2.340    0.019 0.779  -2.191   0.028
## 16 rater_16-language2       16  0.999    0.031    0.975 0.983  -0.136   0.892
## 17 rater_17-language1       17  0.683   -3.041    0.002 0.689  -3.218   0.001
## 18 rater_17-language2       18  0.889   -1.035    0.300 0.874  -1.302   0.193
## 19 rater_18-language1       19  1.092    0.821    0.412 1.100   0.949   0.343
## 20 rater_18-language2       20  1.240    2.167    0.030 1.203   1.977   0.048
## 21 rater_19-language1       21  0.996    0.007    0.995 1.009   0.123   0.902
## 22 rater_19-language2       22  1.096    0.880    0.379 1.133   1.318   0.188
## 23  rater_2-language1       23  0.769   -2.143    0.032 0.784  -2.212   0.027
## 24  rater_2-language2       24  0.840   -1.586    0.113 0.833  -1.794   0.073
## 25 rater_20-language1       25  0.871   -1.125    0.261 0.883  -1.100   0.271
## 26 rater_20-language2       26  0.963   -0.312    0.755 0.953  -0.456   0.648
## 27 rater_21-language1       27  1.195    1.615    0.106 1.188   1.680   0.093
## 28 rater_21-language2       28  1.240    2.101    0.036 1.268   2.535   0.011
## 29  rater_3-language1       29  0.840   -1.443    0.149 0.851  -1.443   0.149
## 30  rater_3-language2       30  1.002    0.051    0.959 0.982  -0.148   0.882
## 31  rater_4-language1       31  0.772   -2.143    0.032 0.781  -2.205   0.027
## 32  rater_4-language2       32  0.840   -1.592    0.111 0.836  -1.749   0.080
## 33  rater_5-language1       33  1.140    1.140    0.254 1.155   1.476   0.140
## 34  rater_5-language2       34  1.187    1.635    0.102 1.165   1.653   0.098
## 35  rater_6-language1       35  1.047    0.437    0.662 1.047   0.480   0.631
## 36  rater_6-language2       36  1.021    0.238    0.812 1.049   0.534   0.593
## 37  rater_7-language1       37  1.236    1.955    0.051 1.148   1.389   0.165
## 38  rater_7-language2       38  1.090    0.871    0.384 1.116   1.182   0.237
## 39  rater_8-language1       39  1.008    0.111    0.911 1.039   0.392   0.695
## 40  rater_8-language2       40  0.819   -1.793    0.073 0.852  -1.559   0.119
## 41  rater_9-language1       41  0.970   -0.197    0.844 1.031   0.322   0.748
## 42  rater_9-language2       42  0.790   -1.861    0.063 0.853  -1.503   0.133</code></pre>
<p>As needed, researchers can also examine model-data fit statistics specific to subgroups of examinees. This can be accomplished by calculating summary statistics of person fit statistics within examinee subgroups. The code below merges the person fit results with student subgroup identification numbers, and then calculates summary statistics and produces boxplots of the fit statistics by group.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="MFR-model.html#cb46-1" aria-hidden="true" tabindex="-1"></a>fit_with_subgroups <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(style<span class="sc">$</span>language, student.fit)</span>
<span id="cb46-2"><a href="MFR-model.html#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="MFR-model.html#cb46-3" aria-hidden="true" tabindex="-1"></a>fit_group_1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(fit_with_subgroups, fit_with_subgroups<span class="sc">$</span><span class="st">`</span><span class="at">style$language</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb46-4"><a href="MFR-model.html#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="MFR-model.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_group_1)</span></code></pre></div>
<pre><code>##  style$language  outfitPerson     outfitPerson_t     infitPerson     
##  Min.   :1      Min.   :0.02316   Min.   :-4.4319   Min.   :0.02864  
##  1st Qu.:1      1st Qu.:0.68466   1st Qu.:-0.9418   1st Qu.:0.70913  
##  Median :1      Median :0.82739   Median :-0.4485   Median :0.83743  
##  Mean   :1      Mean   :0.85283   Mean   :-0.4074   Mean   :0.85791  
##  3rd Qu.:1      3rd Qu.:1.02341   3rd Qu.: 0.1809   3rd Qu.:0.99769  
##  Max.   :1      Max.   :2.07327   Max.   : 3.3507   Max.   :2.02119  
##  infitPerson_t     
##  Min.   :-4.41269  
##  1st Qu.:-0.97773  
##  Median :-0.44301  
##  Mean   :-0.40876  
##  3rd Qu.: 0.08487  
##  Max.   : 3.28558</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="MFR-model.html#cb48-1" aria-hidden="true" tabindex="-1"></a>fit_group_2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(fit_with_subgroups, fit_with_subgroups<span class="sc">$</span><span class="st">`</span><span class="at">style$language</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb48-2"><a href="MFR-model.html#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="MFR-model.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_group_2)</span></code></pre></div>
<pre><code>##  style$language  outfitPerson    outfitPerson_t     infitPerson    
##  Min.   :2      Min.   :0.1389   Min.   :-3.5105   Min.   :0.1599  
##  1st Qu.:2      1st Qu.:0.6915   1st Qu.:-0.9962   1st Qu.:0.7330  
##  Median :2      Median :0.8848   Median :-0.3268   Median :0.8932  
##  Mean   :2      Mean   :0.9271   Mean   :-0.2365   Mean   :0.9400  
##  3rd Qu.:2      3rd Qu.:1.0873   3rd Qu.: 0.4161   3rd Qu.:1.0843  
##  Max.   :2      Max.   :2.2729   Max.   : 3.5578   Max.   :2.3971  
##  infitPerson_t    
##  Min.   :-3.4856  
##  1st Qu.:-0.9809  
##  Median :-0.2919  
##  Mean   :-0.2078  
##  3rd Qu.: 0.4148  
##  Max.   : 3.6511</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="MFR-model.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots for MSE fit statistics:</span></span>
<span id="cb50-2"><a href="MFR-model.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fit_group_1<span class="sc">$</span>outfitPerson, fit_group_2<span class="sc">$</span>outfitPerson,</span>
<span id="cb50-3"><a href="MFR-model.html#cb50-3" aria-hidden="true" tabindex="-1"></a>        fit_group_1<span class="sc">$</span>infitPerson, fit_group_2<span class="sc">$</span>infitPerson,</span>
<span id="cb50-4"><a href="MFR-model.html#cb50-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;Group 1 </span><span class="sc">\n</span><span class="st">Outfit MSE&quot;</span>, <span class="st">&quot;Group 2 </span><span class="sc">\n</span><span class="st">Outfit MSE&quot;</span>, </span>
<span id="cb50-5"><a href="MFR-model.html#cb50-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Group 1 </span><span class="sc">\n</span><span class="st">Infit MSE&quot;</span>, <span class="st">&quot;Group 2 </span><span class="sc">\n</span><span class="st">Infit MSE&quot;</span>),</span>
<span id="cb50-6"><a href="MFR-model.html#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;white&quot;</span>),</span>
<span id="cb50-7"><a href="MFR-model.html#cb50-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;MSE Fit Statistics for English-not-Best-Language (Group 1) </span><span class="sc">\n</span><span class="st">and English-Best-Language (Group 2) Students&quot;</span>,</span>
<span id="cb50-8"><a href="MFR-model.html#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.main =</span> .<span class="dv">8</span>,</span>
<span id="cb50-9"><a href="MFR-model.html#cb50-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;MSE Fit Statistic&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Student Subgroup&quot;</span>)</span></code></pre></div>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="MFR-model.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots for standardized fit statistics:</span></span>
<span id="cb51-2"><a href="MFR-model.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fit_group_1<span class="sc">$</span>outfitPerson_t, fit_group_2<span class="sc">$</span>outfitPerson_t,</span>
<span id="cb51-3"><a href="MFR-model.html#cb51-3" aria-hidden="true" tabindex="-1"></a>        fit_group_1<span class="sc">$</span>infitPerson_t, fit_group_2<span class="sc">$</span>infitPerson_t,</span>
<span id="cb51-4"><a href="MFR-model.html#cb51-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;Group 1 </span><span class="sc">\n</span><span class="st">Std. Outfit&quot;</span>, <span class="st">&quot;Group 2 </span><span class="sc">\n</span><span class="st">Std. Outfit&quot;</span>, </span>
<span id="cb51-5"><a href="MFR-model.html#cb51-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Group 1 </span><span class="sc">\n</span><span class="st">Std. Infit&quot;</span>, <span class="st">&quot;Group 2 </span><span class="sc">\n</span><span class="st">Std. Infit&quot;</span>),</span>
<span id="cb51-6"><a href="MFR-model.html#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;white&quot;</span>),</span>
<span id="cb51-7"><a href="MFR-model.html#cb51-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Standardized Fit Statistics for English-not-Best-Language (Group 1) </span><span class="sc">\n</span><span class="st">and English-Best-Language (Group 2) Students&quot;</span>,</span>
<span id="cb51-8"><a href="MFR-model.html#cb51-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.main =</span> .<span class="dv">8</span>,</span>
<span id="cb51-9"><a href="MFR-model.html#cb51-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;MSE Fit Statistic&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Student Subgroup&quot;</span>)</span></code></pre></div>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Finally, it may be useful to examine fit statistics as they apply to individual raters. This can be accomplished by extracting rater-specific fit statistics within each subgroup. The code below calculates rater fit statistics within each subgroup.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="MFR-model.html#cb52-1" aria-hidden="true" tabindex="-1"></a>ngroups <span class="ot">&lt;-</span> <span class="fu">nrow</span>(subgroup.estimates)</span>
<span id="cb52-2"><a href="MFR-model.html#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="MFR-model.html#cb52-3" aria-hidden="true" tabindex="-1"></a>rater.fit <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">ncol</span>(ratings), <span class="at">ncol =</span> (ngroups <span class="sc">*</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="dv">1</span> )</span>
<span id="cb52-4"><a href="MFR-model.html#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="MFR-model.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rater.number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ratings)){</span>
<span id="cb52-6"><a href="MFR-model.html#cb52-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-7"><a href="MFR-model.html#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate rater-specific fit statistics:</span></span>
<span id="cb52-8"><a href="MFR-model.html#cb52-8" aria-hidden="true" tabindex="-1"></a>  rater.outfit <span class="ot">&lt;-</span> rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit[((rater.number<span class="sc">*</span>ngroups) <span class="sc">-</span> (ngroups <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">:</span> (rater.number<span class="sc">*</span>ngroups)]</span>
<span id="cb52-9"><a href="MFR-model.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-10"><a href="MFR-model.html#cb52-10" aria-hidden="true" tabindex="-1"></a>    rater.infit <span class="ot">&lt;-</span> rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit[((rater.number<span class="sc">*</span>ngroups) <span class="sc">-</span> (ngroups <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">:</span> (rater.number<span class="sc">*</span>ngroups)]</span>
<span id="cb52-11"><a href="MFR-model.html#cb52-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-12"><a href="MFR-model.html#cb52-12" aria-hidden="true" tabindex="-1"></a>   rater.std.outfit <span class="ot">&lt;-</span> rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit_t[((rater.number<span class="sc">*</span>ngroups) <span class="sc">-</span> (ngroups <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">:</span> (rater.number<span class="sc">*</span>ngroups)]</span>
<span id="cb52-13"><a href="MFR-model.html#cb52-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-14"><a href="MFR-model.html#cb52-14" aria-hidden="true" tabindex="-1"></a>  rater.std.infit <span class="ot">&lt;-</span> rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit_t[((rater.number<span class="sc">*</span>ngroups) <span class="sc">-</span> (ngroups <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">:</span> (rater.number<span class="sc">*</span>ngroups)]</span>
<span id="cb52-15"><a href="MFR-model.html#cb52-15" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb52-16"><a href="MFR-model.html#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the fit statistics to the matrix:  </span></span>
<span id="cb52-17"><a href="MFR-model.html#cb52-17" aria-hidden="true" tabindex="-1"></a>  rater.fit[rater.number, ] <span class="ot">&lt;-</span>  <span class="fu">c</span>(rater.number, rater.outfit, rater.infit,</span>
<span id="cb52-18"><a href="MFR-model.html#cb52-18" aria-hidden="true" tabindex="-1"></a>                                  rater.std.outfit, rater.std.infit)</span>
<span id="cb52-19"><a href="MFR-model.html#cb52-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-20"><a href="MFR-model.html#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="MFR-model.html#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="MFR-model.html#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the rater fit results to a dataframe object and add meaningful column names:  </span></span>
<span id="cb52-23"><a href="MFR-model.html#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="MFR-model.html#cb52-24" aria-hidden="true" tabindex="-1"></a>rater.fit_results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(rater.fit)</span>
<span id="cb52-25"><a href="MFR-model.html#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="MFR-model.html#cb52-26" aria-hidden="true" tabindex="-1"></a>infit_mse_labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb52-27"><a href="MFR-model.html#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(group <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ngroups){</span>
<span id="cb52-28"><a href="MFR-model.html#cb52-28" aria-hidden="true" tabindex="-1"></a>  infit_mse_labels[group] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Infit_MSE_Group&quot;</span>, group, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb52-29"><a href="MFR-model.html#cb52-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-30"><a href="MFR-model.html#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="MFR-model.html#cb52-31" aria-hidden="true" tabindex="-1"></a>outfit_mse_labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb52-32"><a href="MFR-model.html#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(group <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ngroups){</span>
<span id="cb52-33"><a href="MFR-model.html#cb52-33" aria-hidden="true" tabindex="-1"></a>  outfit_mse_labels[group] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Outfit_MSE_Group&quot;</span>, group, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb52-34"><a href="MFR-model.html#cb52-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-35"><a href="MFR-model.html#cb52-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-36"><a href="MFR-model.html#cb52-36" aria-hidden="true" tabindex="-1"></a>std_infit_mse_labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb52-37"><a href="MFR-model.html#cb52-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(group <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ngroups){</span>
<span id="cb52-38"><a href="MFR-model.html#cb52-38" aria-hidden="true" tabindex="-1"></a>  std_infit_mse_labels[group] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Std.Infit_MSE_Group&quot;</span>, group, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb52-39"><a href="MFR-model.html#cb52-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-40"><a href="MFR-model.html#cb52-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-41"><a href="MFR-model.html#cb52-41" aria-hidden="true" tabindex="-1"></a>std_outfit_mse_labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb52-42"><a href="MFR-model.html#cb52-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(group <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ngroups){</span>
<span id="cb52-43"><a href="MFR-model.html#cb52-43" aria-hidden="true" tabindex="-1"></a>  std_outfit_mse_labels[group] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Std.Outfit_MSE_Group&quot;</span>, group, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb52-44"><a href="MFR-model.html#cb52-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-45"><a href="MFR-model.html#cb52-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-46"><a href="MFR-model.html#cb52-46" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rater.fit_results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Rater&quot;</span>, outfit_mse_labels, infit_mse_labels,</span>
<span id="cb52-47"><a href="MFR-model.html#cb52-47" aria-hidden="true" tabindex="-1"></a>                              std_outfit_mse_labels, std_infit_mse_labels)</span>
<span id="cb52-48"><a href="MFR-model.html#cb52-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-49"><a href="MFR-model.html#cb52-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the rater fit results for the first six raters using the head() function:</span></span>
<span id="cb52-50"><a href="MFR-model.html#cb52-50" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rater.fit_results)</span></code></pre></div>
<pre><code>##   Rater Outfit_MSE_Group1 Outfit_MSE_Group2 Infit_MSE_Group1 Infit_MSE_Group2
## 1     1         0.5378319         0.5152339        0.5685180        0.5500132
## 2     2         0.9943884         1.1627861        1.0104348        1.1889506
## 3     3         0.7072920         0.9684632        0.7454948        0.9996399
## 4     4         0.8087563         0.8586822        0.8348633        0.8604496
## 5     5         0.6328367         0.9893404        0.6602235        0.9965140
## 6     6         0.9454056         1.0622633        0.9602931        1.0577594
##   Std.Outfit_MSE_Group1 Std.Outfit_MSE_Group2 Std.Infit_MSE_Group1
## 1           -4.84231202           -5.66063470           -4.9062354
## 2           -0.00409796            1.41721943            0.1355469
## 3           -2.82054661           -0.27109066           -2.6428614
## 4           -1.74675007           -1.38725250           -1.6466281
## 5           -3.64467726           -0.06720607           -3.6957750
## 6           -0.44670525            0.61361924           -0.3414119
##   Std.Infit_MSE_Group2
## 1         -5.551375656
## 2          1.869833670
## 3          0.028685263
## 4         -1.477855312
## 5         -0.003650316
## 6          0.610061859</code></pre>
<p>Now that we have created a data frame with the rater-specific fit statistics, we can summarize the results.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="MFR-model.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rater.fit_results)</span></code></pre></div>
<pre><code>##      Rater    Outfit_MSE_Group1 Outfit_MSE_Group2 Infit_MSE_Group1
##  Min.   : 1   Min.   :0.5378    Min.   :0.5152    Min.   :0.5685  
##  1st Qu.: 6   1st Qu.:0.7694    1st Qu.:0.8587    1st Qu.:0.7814  
##  Median :11   Median :0.9454    Median :0.9995    Median :0.9603  
##  Mean   :11   Mean   :0.9091    Mean   :0.9873    Mean   :0.9207  
##  3rd Qu.:16   3rd Qu.:1.0466    3rd Qu.:1.0958    3rd Qu.:1.0470  
##  Max.   :21   Max.   :1.2359    Max.   :1.2400    Max.   :1.1878  
##  Infit_MSE_Group2 Std.Outfit_MSE_Group1 Std.Outfit_MSE_Group2
##  Min.   :0.5500   Min.   :-4.8423       Min.   :-5.66064     
##  1st Qu.:0.8604   1st Qu.:-2.1434       1st Qu.:-1.38725     
##  Median :0.9965   Median :-0.4467       Median : 0.03104     
##  Mean   :0.9918   Mean   :-0.9075       Mean   :-0.19763     
##  3rd Qu.:1.1159   3rd Qu.: 0.4368       3rd Qu.: 0.87994     
##  Max.   :1.2682   Max.   : 1.9554       Max.   : 2.16736     
##  Std.Infit_MSE_Group1 Std.Infit_MSE_Group2
##  Min.   :-4.9062      Min.   :-5.55138    
##  1st Qu.:-2.2053      1st Qu.:-1.47785    
##  Median :-0.3414      Median :-0.00365    
##  Mean   :-0.8551      Mean   :-0.15246    
##  3rd Qu.: 0.4802      3rd Qu.: 1.18162    
##  Max.   : 1.6800      Max.   : 2.53485</code></pre>
<p><strong><em>Graphical Displays of Residuals</em></strong></p>
<p>Continuing our fit analysis, we will construct plots of standardized residuals associated with individual raters. These plots can demonstrate patterns in unexpected and expected responses that can be useful for understanding responses and interpreting results specific to individual raters. In other applications of the MFRM, researchers can construct similar plots for other facets.</p>
<p>Earlier in this chapter, we stored the standardized residuals in an object called <code>std.resid.matrix</code>. We will use this object to create plots for individual raters via a for-loop. For brevity, we have only included plots for the first three raters in this book. The specific raters to be plotted can be controlled by changing the items included in the <code>raters.to.plot</code> object.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="MFR-model.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Before constructing the plots, find the maximum and minimum values of the standardized residuals to set limits for the axes:</span></span>
<span id="cb56-2"><a href="MFR-model.html#cb56-2" aria-hidden="true" tabindex="-1"></a>max.resid <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">max</span>(std.resid.matrix))</span>
<span id="cb56-3"><a href="MFR-model.html#cb56-3" aria-hidden="true" tabindex="-1"></a>min.resid <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">min</span>(std.resid.matrix))</span>
<span id="cb56-4"><a href="MFR-model.html#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="MFR-model.html#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The code below will produce plots of standardized residuals for selected raters as listed in raters.to.plot:</span></span>
<span id="cb56-6"><a href="MFR-model.html#cb56-6" aria-hidden="true" tabindex="-1"></a>raters.to.plot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb56-7"><a href="MFR-model.html#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="MFR-model.html#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rater.number <span class="cf">in</span> raters.to.plot){</span>
<span id="cb56-9"><a href="MFR-model.html#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(std.resid.matrix[, rater.number], <span class="at">ylim =</span> <span class="fu">c</span>(min.resid, max.resid),</span>
<span id="cb56-10"><a href="MFR-model.html#cb56-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Standardized Residuals for Rater &quot;</span>, rater.number, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb56-11"><a href="MFR-model.html#cb56-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Standardized Residual&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Person Index&quot;</span>)</span>
<span id="cb56-12"><a href="MFR-model.html#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb56-13"><a href="MFR-model.html#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb56-14"><a href="MFR-model.html#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb56-15"><a href="MFR-model.html#cb56-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-16"><a href="MFR-model.html#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Std. Residual&quot;</span>, <span class="st">&quot;Observed = Expected&quot;</span>, <span class="st">&quot;+/- 2 SD&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), </span>
<span id="cb56-17"><a href="MFR-model.html#cb56-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb56-18"><a href="MFR-model.html#cb56-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">cex =</span> .<span class="dv">8</span>)</span>
<span id="cb56-19"><a href="MFR-model.html#cb56-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-37-1.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-37-2.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-37-3.png" width="672" /></p>
<p>A separate plot is produced for each rater In each plot, the y-axis shows values of the standardized residuals, and the x-axis shows the students, ordered by their relative position in the data set. Open-circle plotting symbols show the standardized residual associated with each student’s rating from the rater of interest.</p>
<p>Horizontal lines are used to assist in the interpretation of the values of the standardized residuals. First, a solid line is plotted at a value of 0; standardized residuals equal to zero indicate that the observed response was equal to the model-expected response given student and rater locations. Standardized residuals that are greater than zero indicate unexpectedly high ratings, and standardized residuals that are less than zero indicate unexpectedly low ratings. Dashed lines are plotted at values of +2 and -2 to indicate standardized residuals that are two standard deviations above or below model expectations, respectively. Researchers often interpret standardized residuals that exceed +/- 2 as indicating statistically significant unexpected responses.</p>
<p><strong><em>Expected and Observed Response Functions</em></strong></p>
<p>As a final step in our fit analysis, we will construct plots of expected and observed response functions. By default, the <em>TAM</em> package combines the item facet (in this case, raters), with levels of the other facets (in this case, language subgroups) when constructing expected and observed response function plots.</p>
<p>For brevity, we only plot the expected and observed response functions for three selected rater*item combinations. Readers can adjust the <code>items=</code> specification to construct plots for elements of interest for their analyses.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="MFR-model.html#cb57-1" aria-hidden="true" tabindex="-1"></a>raters.to.plot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb57-2"><a href="MFR-model.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(RS_MFR_model, <span class="at">type =</span> <span class="st">&quot;expected&quot;</span>, <span class="at">items =</span> raters.to.plot)</span></code></pre></div>
<pre><code>## Iteration in WLE/MLE estimation  1   | Maximal change  2.9877 
## Iteration in WLE/MLE estimation  2   | Maximal change  2.1965 
## Iteration in WLE/MLE estimation  3   | Maximal change  0.605 
## Iteration in WLE/MLE estimation  4   | Maximal change  0.1983 
## Iteration in WLE/MLE estimation  5   | Maximal change  0.009 
## Iteration in WLE/MLE estimation  6   | Maximal change  5e-04 
## Iteration in WLE/MLE estimation  7   | Maximal change  0 
## ----
##  WLE Reliability= 0.977</code></pre>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-38-1.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-38-2.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-38-3.png" width="672" /></p>
<pre><code>## ....................................................
##  Plots exported in png format into folder:
##  /Users/chenghua/Documents/GitHub/The Rasch Book/Plots</code></pre>
<p><strong><em>Summarize the Results in Tables</em></strong></p>
<p>As a final step, we will create tables that summarize the calibrations of the students, subgroups, raters, and rating scale category thresholds.</p>
<p>Table 1 provides an overview of the logit scale locations, standard errors and fit statistics for all of the facets in the analysis. This table provides a quick overview of the location estimates and numeric model-data fit statistics for the facets in a MFRM.</p>
<p>Because of the estimation procedure for the MFRM in <em>TAM</em>, fit statistics are combined for the item facet and other facets. As a result, the fit statistics in this table will be the same for the rater facet and the subgroup facets.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="MFR-model.html#cb60-1" aria-hidden="true" tabindex="-1"></a>RS_MFRM_summary.table.statistics <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Logit Scale Location Mean&quot;</span>,</span>
<span id="cb60-2"><a href="MFR-model.html#cb60-2" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Logit Scale Location SD&quot;</span>,</span>
<span id="cb60-3"><a href="MFR-model.html#cb60-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Standard Error Mean&quot;</span>,</span>
<span id="cb60-4"><a href="MFR-model.html#cb60-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Standard Error SD&quot;</span>,</span>
<span id="cb60-5"><a href="MFR-model.html#cb60-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Outfit MSE Mean&quot;</span>,</span>
<span id="cb60-6"><a href="MFR-model.html#cb60-6" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Outfit MSE SD&quot;</span>,</span>
<span id="cb60-7"><a href="MFR-model.html#cb60-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Infit MSE Mean&quot;</span>,</span>
<span id="cb60-8"><a href="MFR-model.html#cb60-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Infit MSE SD&quot;</span>,</span>
<span id="cb60-9"><a href="MFR-model.html#cb60-9" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Std. Outfit Mean&quot;</span>,</span>
<span id="cb60-10"><a href="MFR-model.html#cb60-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Std. Outfit SD&quot;</span>,</span>
<span id="cb60-11"><a href="MFR-model.html#cb60-11" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Std. Infit Mean&quot;</span>,</span>
<span id="cb60-12"><a href="MFR-model.html#cb60-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Std. Infit SD&quot;</span>)</span>
<span id="cb60-13"><a href="MFR-model.html#cb60-13" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb60-14"><a href="MFR-model.html#cb60-14" aria-hidden="true" tabindex="-1"></a>RS_MFRM_student.summary.results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">mean</span>(student.locations_RSMFR<span class="sc">$</span>theta),</span>
<span id="cb60-15"><a href="MFR-model.html#cb60-15" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.locations_RSMFR<span class="sc">$</span>theta),</span>
<span id="cb60-16"><a href="MFR-model.html#cb60-16" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.locations_RSMFR<span class="sc">$</span>se),</span>
<span id="cb60-17"><a href="MFR-model.html#cb60-17" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.locations_RSMFR<span class="sc">$</span>se),</span>
<span id="cb60-18"><a href="MFR-model.html#cb60-18" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.fit<span class="sc">$</span>outfitPerson),</span>
<span id="cb60-19"><a href="MFR-model.html#cb60-19" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.fit<span class="sc">$</span>outfitPerson),</span>
<span id="cb60-20"><a href="MFR-model.html#cb60-20" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.fit<span class="sc">$</span>infitPerson),</span>
<span id="cb60-21"><a href="MFR-model.html#cb60-21" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.fit<span class="sc">$</span>infitPerson),</span>
<span id="cb60-22"><a href="MFR-model.html#cb60-22" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.fit<span class="sc">$</span>outfitPerson_t),</span>
<span id="cb60-23"><a href="MFR-model.html#cb60-23" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.fit<span class="sc">$</span>outfitPerson_t),</span>
<span id="cb60-24"><a href="MFR-model.html#cb60-24" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.fit<span class="sc">$</span>infitPerson_t),</span>
<span id="cb60-25"><a href="MFR-model.html#cb60-25" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.fit<span class="sc">$</span>infitPerson_t))</span>
<span id="cb60-26"><a href="MFR-model.html#cb60-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-27"><a href="MFR-model.html#cb60-27" aria-hidden="true" tabindex="-1"></a>RS_MFRM_subgroup.summary.results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">mean</span>(subgroup.estimates<span class="sc">$</span>xsi),</span>
<span id="cb60-28"><a href="MFR-model.html#cb60-28" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(subgroup.estimates<span class="sc">$</span>xsi),</span>
<span id="cb60-29"><a href="MFR-model.html#cb60-29" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(subgroup.estimates<span class="sc">$</span>se.xsi),</span>
<span id="cb60-30"><a href="MFR-model.html#cb60-30" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(subgroup.estimates<span class="sc">$</span>se.xsi),</span>
<span id="cb60-31"><a href="MFR-model.html#cb60-31" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit),</span>
<span id="cb60-32"><a href="MFR-model.html#cb60-32" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit),</span>
<span id="cb60-33"><a href="MFR-model.html#cb60-33" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit),</span>
<span id="cb60-34"><a href="MFR-model.html#cb60-34" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit),</span>
<span id="cb60-35"><a href="MFR-model.html#cb60-35" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit_t),</span>
<span id="cb60-36"><a href="MFR-model.html#cb60-36" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit_t),</span>
<span id="cb60-37"><a href="MFR-model.html#cb60-37" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit_t),</span>
<span id="cb60-38"><a href="MFR-model.html#cb60-38" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit_t))</span>
<span id="cb60-39"><a href="MFR-model.html#cb60-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-40"><a href="MFR-model.html#cb60-40" aria-hidden="true" tabindex="-1"></a>RS_MFRM_rater.summary.results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">mean</span>(rater.estimates<span class="sc">$</span>xsi),</span>
<span id="cb60-41"><a href="MFR-model.html#cb60-41" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">sd</span>(rater.estimates<span class="sc">$</span>xsi),</span>
<span id="cb60-42"><a href="MFR-model.html#cb60-42" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.estimates<span class="sc">$</span>se.xsi),</span>
<span id="cb60-43"><a href="MFR-model.html#cb60-43" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.estimates<span class="sc">$</span>se.xsi),</span>
<span id="cb60-44"><a href="MFR-model.html#cb60-44" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit),</span>
<span id="cb60-45"><a href="MFR-model.html#cb60-45" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit),</span>
<span id="cb60-46"><a href="MFR-model.html#cb60-46" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit),</span>
<span id="cb60-47"><a href="MFR-model.html#cb60-47" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit),</span>
<span id="cb60-48"><a href="MFR-model.html#cb60-48" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit_t),</span>
<span id="cb60-49"><a href="MFR-model.html#cb60-49" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Outfit_t),</span>
<span id="cb60-50"><a href="MFR-model.html#cb60-50" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit_t),</span>
<span id="cb60-51"><a href="MFR-model.html#cb60-51" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.subgroup.fit<span class="sc">$</span>itemfit<span class="sc">$</span>Infit_t))</span>
<span id="cb60-52"><a href="MFR-model.html#cb60-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-53"><a href="MFR-model.html#cb60-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-54"><a href="MFR-model.html#cb60-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the values for presentation in a table:</span></span>
<span id="cb60-55"><a href="MFR-model.html#cb60-55" aria-hidden="true" tabindex="-1"></a>RS_MFRM_student.summary.results_rounded <span class="ot">&lt;-</span> <span class="fu">round</span>(RS_MFRM_student.summary.results, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb60-56"><a href="MFR-model.html#cb60-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-57"><a href="MFR-model.html#cb60-57" aria-hidden="true" tabindex="-1"></a>RS_MFRM_subgroup.summary.results_rounded <span class="ot">&lt;-</span> <span class="fu">round</span>(RS_MFRM_subgroup.summary.results, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb60-58"><a href="MFR-model.html#cb60-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-59"><a href="MFR-model.html#cb60-59" aria-hidden="true" tabindex="-1"></a>RS_MFRM_rater.summary.results_rounded <span class="ot">&lt;-</span> <span class="fu">round</span>(RS_MFRM_rater.summary.results, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb60-60"><a href="MFR-model.html#cb60-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-61"><a href="MFR-model.html#cb60-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-62"><a href="MFR-model.html#cb60-62" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table1 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(RS_MFRM_summary.table.statistics,</span>
<span id="cb60-63"><a href="MFR-model.html#cb60-63" aria-hidden="true" tabindex="-1"></a>                           RS_MFRM_student.summary.results_rounded,</span>
<span id="cb60-64"><a href="MFR-model.html#cb60-64" aria-hidden="true" tabindex="-1"></a>                           RS_MFRM_subgroup.summary.results_rounded,</span>
<span id="cb60-65"><a href="MFR-model.html#cb60-65" aria-hidden="true" tabindex="-1"></a>                           RS_MFRM_rater.summary.results_rounded)</span>
<span id="cb60-66"><a href="MFR-model.html#cb60-66" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb60-67"><a href="MFR-model.html#cb60-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-68"><a href="MFR-model.html#cb60-68" aria-hidden="true" tabindex="-1"></a><span class="co"># add descriptive column labels:</span></span>
<span id="cb60-69"><a href="MFR-model.html#cb60-69" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(RS_MFRM_Table1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Statistic&quot;</span>, <span class="st">&quot;Students&quot;</span>, <span class="st">&quot;Subgroups&quot;</span>, <span class="st">&quot;Raters&quot;</span>)  </span>
<span id="cb60-70"><a href="MFR-model.html#cb60-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-71"><a href="MFR-model.html#cb60-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the table to the console</span></span>
<span id="cb60-72"><a href="MFR-model.html#cb60-72" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table1</span></code></pre></div>
<pre><code>##                    Statistic Students Subgroups Raters
## 1  Logit Scale Location Mean     0.47      0.00   0.00
## 2    Logit Scale Location SD     3.17      0.09   0.52
## 3        Standard Error Mean     0.47      0.02   0.09
## 4          Standard Error SD     0.12      0.00   0.06
## 5            Outfit MSE Mean     0.89      0.95   0.95
## 6              Outfit MSE SD     0.35      0.19   0.19
## 7             Infit MSE Mean     0.90      0.96   0.96
## 8               Infit MSE SD     0.35      0.17   0.17
## 9           Std. Outfit Mean    -0.32     -0.55  -0.55
## 10            Std. Outfit SD     1.13      1.82   1.82
## 11           Std. Infit Mean    -0.30     -0.50  -0.50
## 12             Std. Infit SD     1.12      1.85   1.85</code></pre>
<p>Table 2 summarizes the overall calibrations of individual raters. For data sets with manageable sample sizes such as the style ratings example in this chapter, we recommend reporting details about each element of explanatory facets (e.g., individual raters) in a table similar to this one.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="MFR-model.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average rating for each rater:</span></span>
<span id="cb62-2"><a href="MFR-model.html#cb62-2" aria-hidden="true" tabindex="-1"></a>Avg_Rating <span class="ot">&lt;-</span> <span class="fu">apply</span>(ratings, <span class="dv">2</span>, mean)</span>
<span id="cb62-3"><a href="MFR-model.html#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="MFR-model.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine rater calibration results in a table:</span></span>
<span id="cb62-5"><a href="MFR-model.html#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="MFR-model.html#cb62-6" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table2 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ratings)), </span>
<span id="cb62-7"><a href="MFR-model.html#cb62-7" aria-hidden="true" tabindex="-1"></a>                           Avg_Rating,</span>
<span id="cb62-8"><a href="MFR-model.html#cb62-8" aria-hidden="true" tabindex="-1"></a>                           rater.estimates<span class="sc">$</span>xsi,</span>
<span id="cb62-9"><a href="MFR-model.html#cb62-9" aria-hidden="true" tabindex="-1"></a>                           rater_thresholds,</span>
<span id="cb62-10"><a href="MFR-model.html#cb62-10" aria-hidden="true" tabindex="-1"></a>                           rater.fit_results[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb62-11"><a href="MFR-model.html#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="MFR-model.html#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(RS_MFRM_Table2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Rater ID&quot;</span>, <span class="st">&quot;Average Rating&quot;</span>, <span class="st">&quot;Rater Location&quot;</span>,<span class="st">&quot;Threshold 1&quot;</span>, <span class="st">&quot;Threshold 2&quot;</span>, <span class="st">&quot;Threshold 3&quot;</span>, <span class="fu">names</span>(rater.fit_results[, <span class="sc">-</span><span class="dv">1</span>]))                           </span>
<span id="cb62-13"><a href="MFR-model.html#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="MFR-model.html#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort Table 2 by rater severity:</span></span>
<span id="cb62-15"><a href="MFR-model.html#cb62-15" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table2 <span class="ot">&lt;-</span> RS_MFRM_Table2[<span class="fu">order</span>(<span class="sc">-</span>RS_MFRM_Table2<span class="sc">$</span><span class="st">`</span><span class="at">Rater Location</span><span class="st">`</span>),]</span>
<span id="cb62-16"><a href="MFR-model.html#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="MFR-model.html#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the numeric values (all columns except the first one) to 2 digits:</span></span>
<span id="cb62-18"><a href="MFR-model.html#cb62-18" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table2[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(RS_MFRM_Table2[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb62-19"><a href="MFR-model.html#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="MFR-model.html#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the table to the console</span></span>
<span id="cb62-21"><a href="MFR-model.html#cb62-21" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table2</span></code></pre></div>
<pre><code>##          Rater ID Average Rating Rater Location Threshold 1 Threshold 2
## rater_9         9           1.35           1.12       -2.89        1.35
## rater_19       19           1.45           0.66       -3.35        0.90
## rater_21       21           1.49           0.50       -3.50        0.74
## rater_17       17           1.51           0.45       -3.56        0.68
## rater_16       16           1.51           0.44       -3.57        0.67
## rater_20       20           1.51           0.44       -3.57        0.67
## rater_8         8           1.55           0.27       -3.74        0.50
## rater_14       14           1.55           0.26       -3.75        0.49
## rater_3         3           1.57           0.17       -3.84        0.40
## rater_18       18           1.59           0.11       -3.90        0.35
## rater_4         4           1.60           0.03       -3.98        0.27
## rater_11       11           1.66          -0.21       -4.22        0.02
## rater_7         7           1.67          -0.22       -4.23        0.01
## rater_1         1           1.68          -0.28       -4.29       -0.04
## rater_12       12           1.68          -0.28       -4.29       -0.04
## rater_2         2           1.69          -0.31       -4.32       -0.08
## rater_6         6           1.69          -0.34       -4.35       -0.10
## rater_13       13           1.69          -0.34       -4.35       -0.10
## rater_5         5           1.80          -0.78       -4.79       -0.54
## rater_15       15           1.81          -0.82       -4.83       -0.59
## rater_10       10           1.82          -0.87       -4.88       -0.63
##          Threshold 3 Outfit_MSE_Group1 Outfit_MSE_Group2 Infit_MSE_Group1
## rater_9         4.89              0.68              0.89             0.69
## rater_19        4.44              1.24              1.09             1.15
## rater_21        4.28              0.97              0.79             1.03
## rater_17        4.22              1.14              1.19             1.16
## rater_16        4.21              0.77              0.84             0.78
## rater_20        4.21              1.01              0.82             1.04
## rater_8         4.04              0.75              1.00             0.78
## rater_14        4.03              1.20              1.24             1.19
## rater_3         3.94              0.71              0.97             0.75
## rater_18        3.89              1.05              1.02             1.05
## rater_4         3.81              0.81              0.86             0.83
## rater_11        3.56              1.00              1.10             1.01
## rater_7         3.55              1.10              1.16             1.07
## rater_1         3.49              0.54              0.52             0.57
## rater_12        3.49              0.77              0.84             0.78
## rater_2         3.46              0.99              1.16             1.01
## rater_6         3.44              0.95              1.06             0.96
## rater_13        3.44              0.87              0.96             0.88
## rater_5         3.00              0.63              0.99             0.66
## rater_15        2.95              0.84              1.00             0.85
## rater_10        2.91              1.09              1.24             1.10
##          Infit_MSE_Group2 Std.Outfit_MSE_Group1 Std.Outfit_MSE_Group2
## rater_9              0.87                 -3.04                 -1.04
## rater_19             1.12                  1.96                  0.87
## rater_21             0.85                 -0.20                 -1.86
## rater_17             1.17                  1.14                  1.63
## rater_16             0.84                 -2.14                 -1.59
## rater_20             0.85                  0.11                 -1.79
## rater_8              0.98                 -2.34                  0.03
## rater_14             1.27                  1.62                  2.10
## rater_3              1.00                 -2.82                 -0.27
## rater_18             1.05                  0.44                  0.24
## rater_4              0.86                 -1.75                 -1.39
## rater_11             1.13                  0.01                  0.88
## rater_7              1.07                  0.79                  1.41
## rater_1              0.55                 -4.84                 -5.66
## rater_12             0.83                 -2.14                 -1.59
## rater_2              1.19                  0.00                  1.42
## rater_6              1.06                 -0.45                  0.61
## rater_13             0.95                 -1.13                 -0.31
## rater_5              1.00                 -3.64                 -0.07
## rater_15             0.98                 -1.44                  0.05
## rater_10             1.20                  0.82                  2.17
##          Std.Infit_MSE_Group1 Std.Infit_MSE_Group2
## rater_9                 -3.22                -1.30
## rater_19                 1.39                 1.18
## rater_21                 0.32                -1.50
## rater_17                 1.48                 1.65
## rater_16                -2.21                -1.75
## rater_20                 0.39                -1.56
## rater_8                 -2.19                -0.14
## rater_14                 1.68                 2.53
## rater_3                 -2.64                 0.03
## rater_18                 0.48                 0.53
## rater_4                 -1.65                -1.48
## rater_11                 0.12                 1.32
## rater_7                  0.70                 0.77
## rater_1                 -4.91                -5.55
## rater_12                -2.21                -1.79
## rater_2                  0.14                 1.87
## rater_6                 -0.34                 0.61
## rater_13                -1.10                -0.46
## rater_5                 -3.70                 0.00
## rater_15                -1.44                -0.15
## rater_10                 0.95                 1.98</code></pre>
<p>Table 3 provides a summary of the student calibrations. When there is a relatively large person sample size, it may be more useful to present the results as they relate to individual persons or subsets of the person sample as they are relevant to the purpose of the analysis.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="MFR-model.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average ratings for students:</span></span>
<span id="cb64-2"><a href="MFR-model.html#cb64-2" aria-hidden="true" tabindex="-1"></a>Person_Avg_Rating <span class="ot">&lt;-</span> <span class="fu">apply</span>(ratings, <span class="dv">1</span>, mean)</span>
<span id="cb64-3"><a href="MFR-model.html#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="MFR-model.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine person calibration results in a table:</span></span>
<span id="cb64-5"><a href="MFR-model.html#cb64-5" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table3 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="fu">rownames</span>(student.locations_RSMFR),</span>
<span id="cb64-6"><a href="MFR-model.html#cb64-6" aria-hidden="true" tabindex="-1"></a>                          Person_Avg_Rating,</span>
<span id="cb64-7"><a href="MFR-model.html#cb64-7" aria-hidden="true" tabindex="-1"></a>                          student.locations_RSMFR<span class="sc">$</span>theta,</span>
<span id="cb64-8"><a href="MFR-model.html#cb64-8" aria-hidden="true" tabindex="-1"></a>                          student.locations_RSMFR<span class="sc">$</span>se,</span>
<span id="cb64-9"><a href="MFR-model.html#cb64-9" aria-hidden="true" tabindex="-1"></a>                          student.fit<span class="sc">$</span>outfitPerson,</span>
<span id="cb64-10"><a href="MFR-model.html#cb64-10" aria-hidden="true" tabindex="-1"></a>                          student.fit<span class="sc">$</span>outfitPerson_t,</span>
<span id="cb64-11"><a href="MFR-model.html#cb64-11" aria-hidden="true" tabindex="-1"></a>                          student.fit<span class="sc">$</span>infitPerson,</span>
<span id="cb64-12"><a href="MFR-model.html#cb64-12" aria-hidden="true" tabindex="-1"></a>                          student.fit<span class="sc">$</span>infitPerson_t)</span>
<span id="cb64-13"><a href="MFR-model.html#cb64-13" aria-hidden="true" tabindex="-1"></a>                          </span>
<span id="cb64-14"><a href="MFR-model.html#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(RS_MFRM_Table3) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Student ID&quot;</span>, <span class="st">&quot;Average Rating&quot;</span>, <span class="st">&quot;Student Location&quot;</span>,<span class="st">&quot;Student SE&quot;</span>,<span class="st">&quot;Outfit MSE&quot;</span>,<span class="st">&quot;Std. Outfit&quot;</span>, <span class="st">&quot;Infit MSE&quot;</span>,<span class="st">&quot;Std. Infit&quot;</span>)</span>
<span id="cb64-15"><a href="MFR-model.html#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="MFR-model.html#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort Table 3 by student location:</span></span>
<span id="cb64-17"><a href="MFR-model.html#cb64-17" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table3 <span class="ot">&lt;-</span> RS_MFRM_Table3[<span class="fu">order</span>(<span class="sc">-</span>RS_MFRM_Table3<span class="sc">$</span><span class="st">`</span><span class="at">Student Location</span><span class="st">`</span>),]</span>
<span id="cb64-18"><a href="MFR-model.html#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="MFR-model.html#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the numeric values (all columns except the first one) to 2 digits:</span></span>
<span id="cb64-20"><a href="MFR-model.html#cb64-20" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table3[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(RS_MFRM_Table3[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb64-21"><a href="MFR-model.html#cb64-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-22"><a href="MFR-model.html#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first six rows of the table to the console</span></span>
<span id="cb64-23"><a href="MFR-model.html#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RS_MFRM_Table3)</span></code></pre></div>
<pre><code>##     Student ID Average Rating Student Location Student SE Outfit MSE
## 69          69           3.00             7.60       1.47       0.02
## 44          44           2.95             6.57       0.87       0.54
## 45          45           2.95             6.57       0.87       0.44
## 12          12           2.95             6.44       0.87       0.54
## 70          70           2.95             6.44       0.87       0.76
## 269        269           2.95             6.44       0.87       0.54
##     Std. Outfit Infit MSE Std. Infit
## 69        -0.81      0.03      -1.02
## 44        -0.36      0.71      -0.18
## 45        -0.54      0.68      -0.23
## 12        -0.36      0.71      -0.18
## 70        -0.01      0.79      -0.06
## 269       -0.36      0.71      -0.18</code></pre>
<p>Table 4 provides a summary of the student calibrations within subgroups.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="MFR-model.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average ratings for student subgroups:</span></span>
<span id="cb66-2"><a href="MFR-model.html#cb66-2" aria-hidden="true" tabindex="-1"></a>group.<span class="fl">1.</span>style <span class="ot">&lt;-</span> <span class="fu">subset</span>(style, style<span class="sc">$</span>language <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb66-3"><a href="MFR-model.html#cb66-3" aria-hidden="true" tabindex="-1"></a>group.<span class="fl">2.</span>style <span class="ot">&lt;-</span> <span class="fu">subset</span>(style, style<span class="sc">$</span>language <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb66-4"><a href="MFR-model.html#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="MFR-model.html#cb66-5" aria-hidden="true" tabindex="-1"></a>group<span class="fl">.1</span>_Avg_Rating <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(group.<span class="fl">1.</span>style[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)], <span class="dv">1</span>, mean))</span>
<span id="cb66-6"><a href="MFR-model.html#cb66-6" aria-hidden="true" tabindex="-1"></a>group<span class="fl">.2</span>_Avg_Rating <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(group.<span class="fl">2.</span>style[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)], <span class="dv">1</span>, mean))</span>
<span id="cb66-7"><a href="MFR-model.html#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="MFR-model.html#cb66-8" aria-hidden="true" tabindex="-1"></a>Subgroup_Avg_Rating <span class="ot">&lt;-</span> <span class="fu">c</span>(group<span class="fl">.1</span>_Avg_Rating, group<span class="fl">.2</span>_Avg_Rating)</span>
<span id="cb66-9"><a href="MFR-model.html#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="MFR-model.html#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine subgroup calibration results in a table:</span></span>
<span id="cb66-11"><a href="MFR-model.html#cb66-11" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table4 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(subgroup.estimates<span class="sc">$</span>parameter,</span>
<span id="cb66-12"><a href="MFR-model.html#cb66-12" aria-hidden="true" tabindex="-1"></a>                          Subgroup_Avg_Rating,</span>
<span id="cb66-13"><a href="MFR-model.html#cb66-13" aria-hidden="true" tabindex="-1"></a>                          subgroup.estimates<span class="sc">$</span>xsi,</span>
<span id="cb66-14"><a href="MFR-model.html#cb66-14" aria-hidden="true" tabindex="-1"></a>                          subgroup.estimates<span class="sc">$</span>se.xsi,</span>
<span id="cb66-15"><a href="MFR-model.html#cb66-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="fu">mean</span>(fit_group_1<span class="sc">$</span>outfitPerson), <span class="fu">mean</span>(fit_group_2<span class="sc">$</span>outfitPerson)),</span>
<span id="cb66-16"><a href="MFR-model.html#cb66-16" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="fu">mean</span>(fit_group_1<span class="sc">$</span>outfitPerson_t), <span class="fu">mean</span>(fit_group_2<span class="sc">$</span>outfitPerson_t)),</span>
<span id="cb66-17"><a href="MFR-model.html#cb66-17" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="fu">mean</span>(fit_group_1<span class="sc">$</span>infitPerson), <span class="fu">mean</span>(fit_group_2<span class="sc">$</span>infitPerson)),</span>
<span id="cb66-18"><a href="MFR-model.html#cb66-18" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="fu">mean</span>(fit_group_1<span class="sc">$</span>infitPerson_t), <span class="fu">mean</span>(fit_group_2<span class="sc">$</span>infitPerson_t)))</span>
<span id="cb66-19"><a href="MFR-model.html#cb66-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-20"><a href="MFR-model.html#cb66-20" aria-hidden="true" tabindex="-1"></a>                          </span>
<span id="cb66-21"><a href="MFR-model.html#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(RS_MFRM_Table4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Subgroup&quot;</span>, <span class="st">&quot;Average Rating&quot;</span>, <span class="st">&quot;Subgroup Location&quot;</span>,<span class="st">&quot;Subgroup Location SE&quot;</span>,<span class="st">&quot;Outfit MSE&quot;</span>,<span class="st">&quot;Std. Outfit&quot;</span>, <span class="st">&quot;Infit MSE&quot;</span>,<span class="st">&quot;Std. Infit&quot;</span>)</span>
<span id="cb66-22"><a href="MFR-model.html#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="MFR-model.html#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort Table 4 by subgroup location:</span></span>
<span id="cb66-24"><a href="MFR-model.html#cb66-24" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table4 <span class="ot">&lt;-</span> RS_MFRM_Table4[<span class="fu">order</span>(<span class="sc">-</span>RS_MFRM_Table4<span class="sc">$</span><span class="st">`</span><span class="at">Subgroup Location</span><span class="st">`</span>),]</span>
<span id="cb66-25"><a href="MFR-model.html#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="MFR-model.html#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the numeric values (all columns except the first one) to 2 digits:</span></span>
<span id="cb66-27"><a href="MFR-model.html#cb66-27" aria-hidden="true" tabindex="-1"></a>RS_MFRM_Table4[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(RS_MFRM_Table4[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb66-28"><a href="MFR-model.html#cb66-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-29"><a href="MFR-model.html#cb66-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the table to the console</span></span>
<span id="cb66-30"><a href="MFR-model.html#cb66-30" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RS_MFRM_Table4)</span></code></pre></div>
<pre><code>##    Subgroup Average Rating Subgroup Location Subgroup Location SE Outfit MSE
## 2 language2           1.59              0.07                 0.02       0.93
## 1 language1           1.63             -0.07                 0.02       0.85
##   Std. Outfit Infit MSE Std. Infit
## 2       -0.24      0.94      -0.21
## 1       -0.41      0.86      -0.41</code></pre>
</div>
<div id="another-example-running-pc-mfrm-with-long-format-data-using-the-tam-package" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Another Example: Running PC-MFRM with Long-Format Data using the <em>TAM</em> Package</h2>
<p>In the next section, we provide a step-by-step demonstration of a MFRM analysis using the <em>TAM</em> package <span class="citation">(<a href="#ref-TAM" role="doc-biblioref">Robitzsch, Kiefer, and Wu 2021</a>)</span> for data that are stored in <em>long format</em>. We encourage readers to use the example data set for this chapter that is provided in the online supplement to conduct the analysis along with us.</p>
<p>For this example, we use a subset of the writing assessment data that includes students’ scores related to four domains: Style, Organization, Conventions, and Sentence Formation.</p>
<p>Compared to the first example in this chapter, our description of the second example is less detailed. In cases where there are important differences between the two examples, we describe them. In other cases, we encourage readers to refer to the first example.</p>
<p><strong><em>Prepare for the Analyses </em></strong></p>
<p>Before proceeding with the analysis, readers should ensure that they have installed and loaded all three of the packages described earlier in this chapter: <em>TAM</em>, <em>WrightMap</em>, and <em>psych</em>.</p>
<p>Next, we will import the data for our analysis. The data for this example are stored in the file named <code>writing.csv</code>. We will save these data in an object called <code>writing.</code></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="MFR-model.html#cb68-1" aria-hidden="true" tabindex="-1"></a>writing <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;writing.csv&quot;</span>)</span></code></pre></div>
<p>Note that the writing data are in <em>long</em> format: This means that there are multiple rows for each element within the object of measurement. In the case of our example data, there are multiple rows for each student. Each row includes one rater’s ratings of one student on all four of the domains in the assessment: Style, Organization, Conventions, and Sentence Formation. We can see this structure by printing the first six rows of the data.frame object to our console using the <em>head()</em> function.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="MFR-model.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(writing)</span></code></pre></div>
<pre><code>##   student language rater style org conv sent_form
## 1       3        1     1     2   2    2         2
## 2       3        1     2     2   2    2         3
## 3       3        1     3     2   2    1         2
## 4       3        1     4     2   3    2         3
## 5       3        1     5     3   3    2         3
## 6       3        1     6     3   3    2         2</code></pre>
<p>Next, we will explore the data using descriptive statistics using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="MFR-model.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(writing)</span></code></pre></div>
<pre><code>##     student          language         rater        style            org       
##  Min.   :   3.0   Min.   :1.000   Min.   : 1   Min.   :0.000   Min.   :0.000  
##  1st Qu.: 392.0   1st Qu.:1.000   1st Qu.: 6   1st Qu.:1.000   1st Qu.:1.000  
##  Median : 782.0   Median :2.000   Median :11   Median :2.000   Median :2.000  
##  Mean   : 784.3   Mean   :1.532   Mean   :11   Mean   :1.613   Mean   :1.521  
##  3rd Qu.:1171.2   3rd Qu.:2.000   3rd Qu.:16   3rd Qu.:2.000   3rd Qu.:2.000  
##  Max.   :1574.0   Max.   :2.000   Max.   :21   Max.   :3.000   Max.   :3.000  
##       conv         sent_form    
##  Min.   :0.000   Min.   :0.000  
##  1st Qu.:1.000   1st Qu.:1.000  
##  Median :2.000   Median :2.000  
##  Mean   :1.711   Mean   :1.918  
##  3rd Qu.:2.000   3rd Qu.:3.000  
##  Max.   :3.000   Max.   :3.000</code></pre>
<p>From the summary of <code>writing</code>, we can see there are no missing data. In addition, we can get a general sense of the scales, range, and distribution of each variable in the data set. First, we can see that student identification numbers range from 3 to 1574. We can identify the number of unique students in the data using the following code.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="MFR-model.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(writing<span class="sc">$</span>student))</span></code></pre></div>
<pre><code>## [1] 372</code></pre>
<p>There are 372 unique student identification numbers in our data. Returning to the summary of the writing data, we can see that the minimum rating on each domain was <span class="math inline">\(x = 0\)</span>, and the maximum rating was <span class="math inline">\(x = 3\)</span>.</p>
<div id="specify-the-pc-mfrm" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Specify the PC-MFRM:</h3>
<p>We will analyze the writing data using a Partial Credit MFRM (PC-MFRM), where we specify rating scale category thresholds separately for the domains in the writing assessment. The facets in this model will include raters and domains.</p>
<p><span class="math display">\[\begin{equation}\tag{6.3}\ln\left(\frac{P_{n \operatorname{mi}(x=k)}}{P_{n \operatorname{mi}(x=k-1)}}\right)=\theta_{n}-\delta_{m}-\lambda_{i}-\tau_{m k}\end{equation}\]</span></p>
<p>In Equation 6.3, <span class="math inline">\(\theta_n\)</span> and <span class="math inline">\(\lambda_i\)</span> are defined as in Equation 6.1 and Equation 6.2. <span class="math inline">\(\delta_m\)</span> is the logit-scale location for domain <span class="math inline">\(m\)</span>. Lower domain locations indicate relatively easy domains, and higher domain locations indicate relatively difficult domains. <span class="math inline">\(\tau_mk\)</span> is the rating scale category threshold where there is an equal probability for a rating in category <span class="math inline">\(k\)</span> and category <span class="math inline">\(k-1\)</span>, specific to domain <span class="math inline">\(m\)</span>. This formulation of the PC-MFR model allows us to examine each rater’s use of the rating scale separately.</p>
<p>With long format data, we need to ensure that the person identification numbers (in this case, student labels) are sorted from low to high before we can run the analysis.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="MFR-model.html#cb75-1" aria-hidden="true" tabindex="-1"></a>writing <span class="ot">&lt;-</span> writing[<span class="fu">order</span>(writing<span class="sc">$</span>student), ]</span></code></pre></div>
<p>Next, we specify the components of the PC-MFRM. In this long-format data analysis, the <em>TAM</em> package will treat domains as “items” because they make up the columns of the response matrix. Therefore, our <code>writing.facets</code> object includes raters.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="MFR-model.html#cb76-1" aria-hidden="true" tabindex="-1"></a>writing.facets <span class="ot">&lt;-</span> writing[, <span class="fu">c</span>(<span class="st">&quot;rater&quot;</span>), drop <span class="ot">=</span> <span class="cn">FALSE</span>] </span></code></pre></div>
<p>Next, we identify the object of measurement as students:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="MFR-model.html#cb77-1" aria-hidden="true" tabindex="-1"></a>writing.pid <span class="ot">&lt;-</span> writing<span class="sc">$</span>student</span></code></pre></div>
<p>The response matrix includes students’ ratings on the four domains:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="MFR-model.html#cb78-1" aria-hidden="true" tabindex="-1"></a>writing.resp <span class="ot">&lt;-</span> <span class="fu">subset</span>(writing, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(student, language, rater))</span></code></pre></div>
<p>We specify the PC-MFRM from Equation 6.3 in an object for use with <em>TAM</em> as follows. First, we specify a name for the model object (<code>writing_PC_MFRM</code>), which is defined using the tilde symbol (~), followed by the facet names. As a reminder, the model must include a facet named <code>item</code>; in our example, the item facet is made up of domains, because the domains make up the columns in our long-format response matrix. We also include <code>rater</code> as a facet. Finally, we use <code>item:step</code> to indicate the PC model.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="MFR-model.html#cb79-1" aria-hidden="true" tabindex="-1"></a>PC.writing.formula <span class="ot">&lt;-</span> <span class="er">~</span> item <span class="sc">+</span> rater <span class="sc">+</span> item<span class="sc">:</span>step</span></code></pre></div>
<p>We run the PC-MFR model using the <code>tam.mml.mfr()</code> function:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="MFR-model.html#cb80-1" aria-hidden="true" tabindex="-1"></a>writing_PC_MFRM.model <span class="ot">&lt;-</span> <span class="fu">tam.mml.mfr</span>(<span class="at">resp=</span>writing.resp, <span class="at">facets=</span>writing.facets,</span>
<span id="cb80-2"><a href="MFR-model.html#cb80-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">formulaA=</span>PC.writing.formula, <span class="at">pid=</span>writing.pid, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">constraint =</span> <span class="st">&quot;items&quot;</span>)</span></code></pre></div>
<p>Analysts who are interested in overall model-fit indices or other details that are included in the summary of the MFRM may request it using the <code>summary()</code> function:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="MFR-model.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(writing_PC_MFRM.model)</span></code></pre></div>
<pre><code>## ------------------------------------------------------------
## TAM 3.7-16 (2021-06-24 14:31:37) 
## R version 4.1.0 (2021-05-18) x86_64, darwin17.0 | nodename=Chengs-iMac | login=root 
## 
## Date of Analysis: 2021-08-16 10:36:54 
## Time difference of 0.984524 secs
## Computation time: 0.984524 
## 
## Multidimensional Item Response Model in TAM 
## 
## IRT Model: 1PL
## Call:
## tam.mml.mfr(resp = writing.resp, pid = writing.pid, formulaA = PC.writing.formula, 
##     constraint = &quot;items&quot;, facets = writing.facets, verbose = FALSE)
## 
## ------------------------------------------------------------
## Number of iterations = 258 
## Numeric integration with 21 integration points
## 
## Deviance = 46111.6 
## Log likelihood = -23055.8 
## Number of persons = 372 
## Number of persons used = 372 
## Number of generalized items = 84 
## Number of items = 4 
## Number of estimated parameters = 33 
##     Item threshold parameters = 31 
##     Item slope parameters = 0 
##     Regression parameters = 1 
##     Variance/covariance parameters = 1 
## 
## AIC = 46178  | penalty=66    | AIC=-2*LL + 2*p 
## AIC3 = 46211  | penalty=99    | AIC3=-2*LL + 3*p 
## BIC = 46307  | penalty=195.32    | BIC=-2*LL + log(n)*p 
## aBIC = 46202  | penalty=90.27    | aBIC=-2*LL + log((n-2)/24)*p  (adjusted BIC) 
## CAIC = 46340  | penalty=228.32    | CAIC=-2*LL + [log(n)+1]*p  (consistent AIC) 
## AICc = 46184  | penalty=72.64    | AICc=-2*LL + 2*p + 2*p*(p+1)/(n-p-1)  (bias corrected AIC) 
## GHP = 0.73889     | GHP=( -LL + p ) / (#Persons * #Items)  (Gilula-Haberman log penalty) 
## 
## ------------------------------------------------------------
## EAP Reliability
## [1] 0.994
## ------------------------------------------------------------
## Covariances and Variances
##       [,1]
## [1,] 8.198
## ------------------------------------------------------------
## Correlations and Standard Deviations (in the diagonal)
##       [,1]
## [1,] 2.863
## ------------------------------------------------------------
## Regression Coefficients
##         [,1]
## [1,] 0.70622
## ------------------------------------------------------------
## Item Parameters -A*Xsi
##              item   N     M xsi.item AXsi_.Cat1 AXsi_.Cat2 AXsi_.Cat3
## 1   conv-rater_1_ 372 1.753   -0.280     -3.891     -4.261     -0.841
## 2   conv-rater_10 372 1.871   -0.563     -4.173     -4.825     -1.688
## 3   conv-rater_11 372 1.653   -0.164     -3.775     -4.028     -0.492
## 4   conv-rater_12 372 1.734   -0.257     -3.867     -4.213     -0.770
## 5   conv-rater_13 372 1.489    0.076     -3.535     -3.549      0.227
## 6   conv-rater_14 372 1.828    0.086     -3.525     -3.528      0.259
## 7   conv-rater_15 372 1.664   -0.638     -4.249     -4.976     -1.914
## 8   conv-rater_16 372 1.645    0.317     -3.294     -3.066      0.951
## 9   conv-rater_17 372 1.863    0.034     -3.577     -3.633      0.101
## 10  conv-rater_18 372 1.554    0.414     -3.197     -2.872      1.242
## 11  conv-rater_19 372 1.798   -0.024     -3.635     -3.749     -0.073
## 12  conv-rater_2_ 372 1.680   -0.109     -3.719     -3.917     -0.326
## 13  conv-rater_20 372 1.621    0.068     -3.543     -3.564      0.203
## 14  conv-rater_21 372 1.780   -0.132     -3.743     -3.965     -0.397
## 15  conv-rater_3_ 372 1.774   -0.090     -3.701     -3.880     -0.270
## 16  conv-rater_4_ 372 1.685    0.015     -3.596     -3.670      0.046
## 17  conv-rater_5_ 372 1.642   -0.363     -3.973     -4.425     -1.088
## 18  conv-rater_6_ 372 1.941   -0.541     -4.152     -4.782     -1.624
## 19  conv-rater_7_ 372 1.737   -0.568     -4.179     -4.836     -1.704
## 20  conv-rater_8_ 372 1.632    0.186     -3.425     -3.328      0.558
## 21  conv-rater_9_ 372 1.589    0.676     -2.935     -2.348      2.028
## 22 item4-rater_1_ 372 1.968   -1.000     -4.125     -5.335     -3.001
## 23 item4-rater_10 372 2.051   -1.283     -4.407     -5.899     -3.848
## 24 item4-rater_11 372 1.941   -0.884     -4.008     -5.102     -2.652
## 25 item4-rater_12 372 1.914   -0.977     -4.101     -5.287     -2.930
## 26 item4-rater_13 372 1.769   -0.644     -3.769     -4.623     -1.933
## 27 item4-rater_14 372 1.815   -0.634     -3.758     -4.602     -1.902
## 28 item4-rater_15 372 2.056   -1.358     -4.482     -6.050     -4.074
## 29 item4-rater_16 372 1.742   -0.403     -3.527     -4.140     -1.209
## 30 item4-rater_17 372 1.831   -0.686     -3.811     -4.707     -2.059
## 31 item4-rater_18 372 1.718   -0.306     -3.430     -3.946     -0.918
## 32 item4-rater_19 372 2.027   -0.744     -3.869     -4.823     -2.233
## 33 item4-rater_2_ 372 1.903   -0.829     -3.953     -4.991     -2.486
## 34 item4-rater_20 372 2.043   -0.652     -3.777     -4.638     -1.957
## 35 item4-rater_21 372 2.132   -0.852     -3.977     -5.039     -2.557
## 36 item4-rater_3_ 372 1.895   -0.810     -3.935     -4.954     -2.431
## 37 item4-rater_4_ 372 1.892   -0.705     -3.829     -4.744     -2.115
## 38 item4-rater_5_ 372 1.895   -1.083     -4.207     -5.499     -3.248
## 39 item4-rater_6_ 372 1.984   -1.261     -4.386     -5.856     -3.784
## 40 item4-rater_7_ 372 2.022   -1.288     -4.412     -5.910     -3.864
## 41 item4-rater_8_ 372 1.949   -0.534     -3.658     -4.402     -1.602
## 42 item4-rater_9_ 372 1.737   -0.044     -3.169     -3.422     -0.133
## 43   org-rater_1_ 372 1.559    0.442     -3.201     -2.555      1.327
## 44   org-rater_10 372 1.503    0.160     -3.483     -3.120      0.480
## 45   org-rater_11 372 1.583    0.559     -3.084     -2.322      1.676
## 46   org-rater_12 372 1.608    0.466     -3.177     -2.507      1.398
## 47   org-rater_13 372 1.645    0.798     -2.844     -1.843      2.395
## 48   org-rater_14 372 1.392    0.809     -2.834     -1.822      2.427
## 49   org-rater_15 372 1.790    0.085     -3.558     -3.270      0.254
## 50   org-rater_16 372 1.454    1.040     -2.603     -1.360      3.119
## 51   org-rater_17 372 1.441    0.756     -2.887     -1.927      2.269
## 52   org-rater_18 372 1.392    1.137     -2.506     -1.166      3.410
## 53   org-rater_19 372 1.419    0.698     -2.944     -2.043      2.095
## 54   org-rater_2_ 372 1.513    0.614     -3.029     -2.211      1.842
## 55   org-rater_20 372 1.433    0.790     -2.852     -1.859      2.371
## 56   org-rater_21 372 1.406    0.590     -3.052     -2.259      1.771
## 57   org-rater_3_ 372 1.524    0.633     -3.010     -2.174      1.898
## 58   org-rater_4_ 372 1.476    0.738     -2.905     -1.964      2.214
## 59   org-rater_5_ 372 1.707    0.360     -3.283     -2.719      1.080
## 60   org-rater_6_ 372 1.605    0.181     -3.461     -3.077      0.544
## 61   org-rater_7_ 372 1.825    0.155     -3.488     -3.130      0.464
## 62   org-rater_8_ 372 1.355    0.909     -2.734     -1.622      2.726
## 63   org-rater_9_ 372 1.309    1.399     -2.244     -0.643      4.196
## 64 style-rater_1_ 372 1.680    0.071     -3.655     -3.308      0.212
## 65 style-rater_10 372 1.820   -0.212     -3.937     -3.872     -0.635
## 66 style-rater_11 372 1.664    0.187     -3.538     -3.075      0.561
## 67 style-rater_12 372 1.680    0.095     -3.631     -3.260      0.284
## 68 style-rater_13 372 1.694    0.427     -3.299     -2.596      1.280
## 69 style-rater_14 372 1.551    0.437     -3.288     -2.575      1.312
## 70 style-rater_15 372 1.809   -0.287     -4.012     -4.023     -0.860
## 71 style-rater_16 372 1.508    0.668     -3.057     -2.113      2.004
## 72 style-rater_17 372 1.505    0.385     -3.341     -2.680      1.154
## 73 style-rater_18 372 1.586    0.765     -2.960     -1.919      2.296
## 74 style-rater_19 372 1.454    0.327     -3.398     -2.796      0.980
## 75 style-rater_2_ 372 1.688    0.243     -3.483     -2.964      0.728
## 76 style-rater_20 372 1.508    0.419     -3.306     -2.611      1.257
## 77 style-rater_21 372 1.492    0.219     -3.506     -3.012      0.656
## 78 style-rater_3_ 372 1.573    0.261     -3.464     -2.927      0.783
## 79 style-rater_4_ 372 1.605    0.366     -3.359     -2.717      1.099
## 80 style-rater_5_ 372 1.798   -0.012     -3.737     -3.472     -0.035
## 81 style-rater_6_ 372 1.694   -0.190     -3.915     -3.830     -0.570
## 82 style-rater_7_ 372 1.667   -0.217     -3.942     -3.883     -0.651
## 83 style-rater_8_ 372 1.548    0.537     -3.188     -2.375      1.611
## 84 style-rater_9_ 372 1.347    1.027     -2.698     -1.395      3.081
##    B.Cat1.Dim1 B.Cat2.Dim1 B.Cat3.Dim1
## 1            1           2           3
## 2            1           2           3
## 3            1           2           3
## 4            1           2           3
## 5            1           2           3
## 6            1           2           3
## 7            1           2           3
## 8            1           2           3
## 9            1           2           3
## 10           1           2           3
## 11           1           2           3
## 12           1           2           3
## 13           1           2           3
## 14           1           2           3
## 15           1           2           3
## 16           1           2           3
## 17           1           2           3
## 18           1           2           3
## 19           1           2           3
## 20           1           2           3
## 21           1           2           3
## 22           1           2           3
## 23           1           2           3
## 24           1           2           3
## 25           1           2           3
## 26           1           2           3
## 27           1           2           3
## 28           1           2           3
## 29           1           2           3
## 30           1           2           3
## 31           1           2           3
## 32           1           2           3
## 33           1           2           3
## 34           1           2           3
## 35           1           2           3
## 36           1           2           3
## 37           1           2           3
## 38           1           2           3
## 39           1           2           3
## 40           1           2           3
## 41           1           2           3
## 42           1           2           3
## 43           1           2           3
## 44           1           2           3
## 45           1           2           3
## 46           1           2           3
## 47           1           2           3
## 48           1           2           3
## 49           1           2           3
## 50           1           2           3
## 51           1           2           3
## 52           1           2           3
## 53           1           2           3
## 54           1           2           3
## 55           1           2           3
## 56           1           2           3
## 57           1           2           3
## 58           1           2           3
## 59           1           2           3
## 60           1           2           3
## 61           1           2           3
## 62           1           2           3
## 63           1           2           3
## 64           1           2           3
## 65           1           2           3
## 66           1           2           3
## 67           1           2           3
## 68           1           2           3
## 69           1           2           3
## 70           1           2           3
## 71           1           2           3
## 72           1           2           3
## 73           1           2           3
## 74           1           2           3
## 75           1           2           3
## 76           1           2           3
## 77           1           2           3
## 78           1           2           3
## 79           1           2           3
## 80           1           2           3
## 81           1           2           3
## 82           1           2           3
## 83           1           2           3
## 84           1           2           3
## 
## Item Facet Parameters Xsi
##          parameter     facet    xsi se.xsi
## 1            style      item  0.263  0.016
## 2              org      item  0.634  0.016
## 3             conv      item -0.088  0.016
## 4        sent_form      item -0.809  0.028
## 5         rater_1_     rater -0.192  0.036
## 6         rater_10     rater -0.474  0.036
## 7         rater_11     rater -0.076  0.036
## 8         rater_12     rater -0.168  0.036
## 9         rater_13     rater  0.164  0.036
## 10        rater_14     rater  0.175  0.036
## 11        rater_15     rater -0.549  0.036
## 12        rater_16     rater  0.406  0.036
## 13        rater_17     rater  0.122  0.036
## 14        rater_18     rater  0.503  0.036
## 15        rater_19     rater  0.064  0.036
## 16        rater_2_     rater -0.020  0.036
## 17        rater_20     rater  0.156  0.036
## 18        rater_21     rater -0.044  0.036
## 19        rater_3_     rater -0.002  0.036
## 20        rater_4_     rater  0.104  0.036
## 21        rater_5_     rater -0.274  0.036
## 22        rater_6_     rater -0.453  0.036
## 23        rater_7_     rater -0.480  0.036
## 24        rater_8_     rater  0.274  0.036
## 25        rater_9_     rater  0.764  0.162
## 26     style:step1 item:step -3.725  0.031
## 27       org:step1 item:step -3.643  0.031
## 28      conv:step1 item:step -3.611  0.031
## 29 sent_form:step1 item:step -3.124  0.030
## 30     style:step2 item:step  0.276  0.028
## 31       org:step2 item:step  0.203  0.028
## 32      conv:step2 item:step -0.089  0.027
## 33 sent_form:step2 item:step -0.210  0.027
## 34     style:step3 item:step  3.449  0.041
## 35       org:step3 item:step  3.440  0.042
## 36      conv:step3 item:step  3.700  0.041
## 37 sent_form:step3 item:step  3.334  0.040
## 
## Item Parameters Xsi
##                xsi se.xsi
## style        0.263  0.016
## org          0.634  0.016
## conv        -0.088  0.016
## rater_1_    -0.192  0.036
## rater_10    -0.474  0.036
## rater_11    -0.076  0.036
## rater_12    -0.168  0.036
## rater_13     0.164  0.036
## rater_14     0.175  0.036
## rater_15    -0.549  0.036
## rater_16     0.406  0.036
## rater_17     0.122  0.036
## rater_18     0.503  0.036
## rater_19     0.064  0.036
## rater_2_    -0.020  0.036
## rater_20     0.156  0.036
## rater_21    -0.044  0.036
## rater_3_    -0.002  0.036
## rater_4_     0.104  0.036
## rater_5_    -0.274  0.036
## rater_6_    -0.453  0.036
## rater_7_    -0.480  0.036
## rater_8_     0.274  0.036
## style:step1 -3.725  0.031
## org:step1   -3.643  0.031
## conv:step1  -3.611  0.031
## item4:step1 -3.124  0.030
## style:step2  0.276  0.028
## org:step2    0.203  0.028
## conv:step2  -0.089  0.027
## item4:step2 -0.210  0.027</code></pre>
<p><strong><em>Facet Results</em></strong></p>
<p>Because we used a PC formulation of the MFRM, the thresholds were estimated separately for each rater. We save the facet estimates for domains and raters as we did in the first example. However, for the threshold estimates, we extract the values labeled <code>item:step</code>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="MFR-model.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the facet estimates:</span></span>
<span id="cb83-2"><a href="MFR-model.html#cb83-2" aria-hidden="true" tabindex="-1"></a>facet.estimates <span class="ot">&lt;-</span> writing_PC_MFRM.model<span class="sc">$</span>xsi.facets <span class="co"># all facets together</span></span>
<span id="cb83-3"><a href="MFR-model.html#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="MFR-model.html#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract results for each facet separately:</span></span>
<span id="cb83-5"><a href="MFR-model.html#cb83-5" aria-hidden="true" tabindex="-1"></a>domain.estimates <span class="ot">&lt;-</span> <span class="fu">subset</span>(facet.estimates, facet.estimates<span class="sc">$</span>facet <span class="sc">==</span> <span class="st">&quot;item&quot;</span>)</span>
<span id="cb83-6"><a href="MFR-model.html#cb83-6" aria-hidden="true" tabindex="-1"></a>rater.estimates <span class="ot">&lt;-</span> <span class="fu">subset</span>(facet.estimates, facet.estimates<span class="sc">$</span>facet <span class="sc">==</span> <span class="st">&quot;rater&quot;</span>)</span>
<span id="cb83-7"><a href="MFR-model.html#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="MFR-model.html#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract domain-specific threshold estimates:</span></span>
<span id="cb83-9"><a href="MFR-model.html#cb83-9" aria-hidden="true" tabindex="-1"></a>threshold.estimates <span class="ot">&lt;-</span> <span class="fu">subset</span>(facet.estimates, facet.estimates<span class="sc">$</span>facet <span class="sc">==</span> <span class="st">&quot;item:step&quot;</span>)</span></code></pre></div>
<p><strong><em>Domain facet results</em></strong></p>
<p>Next, we will examine the results for the domain facet. Because there are only four domains, we can print the estimates to the console to view them. We can also calculate summary statistics for the domain facet estimates using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="MFR-model.html#cb84-1" aria-hidden="true" tabindex="-1"></a>domain.estimates</span></code></pre></div>
<pre><code>##   parameter facet         xsi     se.xsi
## 1     style  item  0.26265320 0.01585224
## 2       org  item  0.63426014 0.01584412
## 3      conv  item -0.08840333 0.01599162
## 4 sent_form  item -0.80851000 0.02753292</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="MFR-model.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(domain.estimates)</span></code></pre></div>
<pre><code>##   parameter            facet                xsi               se.xsi       
##  Length:4           Length:4           Min.   :-0.80851   Min.   :0.01584  
##  Class :character   Class :character   1st Qu.:-0.26843   1st Qu.:0.01585  
##  Mode  :character   Mode  :character   Median : 0.08712   Median :0.01592  
##                                        Mean   : 0.00000   Mean   :0.01881  
##                                        3rd Qu.: 0.35555   3rd Qu.:0.01888  
##                                        Max.   : 0.63426   Max.   :0.02753</code></pre>
<p>From the summary of domain locations, we can see that the domain difficulty estimates range from <span class="math inline">\(\delta\)</span> = -0.61 logits for the easiest domain to <span class="math inline">\(\delta\)</span> = 0.67 for the most difficult domain.</p>
<p><strong><em>Rater Facet Results</em></strong></p>
<p>Nest, we will examine the rater estimates using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="MFR-model.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rater.estimates)</span></code></pre></div>
<pre><code>##   parameter            facet                xsi                se.xsi       
##  Length:21          Length:21          Min.   :-0.549431   Min.   :0.03623  
##  Class :character   Class :character   1st Qu.:-0.191938   1st Qu.:0.03625  
##  Mode  :character   Mode  :character   Median :-0.001687   Median :0.03628  
##                                        Mean   : 0.000000   Mean   :0.04231  
##                                        3rd Qu.: 0.164105   3rd Qu.:0.03635  
##                                        Max.   : 0.764278   Max.   :0.16236</code></pre>
<p>The rater location estimates from this model range from <span class="math inline">\(\lambda\)</span> = -0.55 logits for the most lenient rater to <span class="math inline">\(\lambda\)</span> = 0.76 logits for the most severe rater.</p>
<p><strong><em>Student Facet Results</em></strong></p>
<p>Next, we will estimate student locations and store the results in an object called <code>student.ach</code>. We will then store the student identification numbers, location estimates, and standard errors in a new object called <code>student.locations_PCMFR</code>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="MFR-model.html#cb90-1" aria-hidden="true" tabindex="-1"></a>student.ach <span class="ot">&lt;-</span> <span class="fu">tam.wle</span>(writing_PC_MFRM.model, <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb90-2"><a href="MFR-model.html#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="MFR-model.html#cb90-3" aria-hidden="true" tabindex="-1"></a>student.locations_PCMFR <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(student.ach<span class="sc">$</span>pid, student.ach<span class="sc">$</span>theta, student.ach<span class="sc">$</span>error)</span>
<span id="cb90-4"><a href="MFR-model.html#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="MFR-model.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(student.locations_PCMFR) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;theta&quot;</span>, <span class="st">&quot;se&quot;</span>)</span></code></pre></div>
<p>Next, we will examine the student location estimates using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="MFR-model.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(student.locations_PCMFR<span class="sc">$</span>theta)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -7.1284 -1.4232  0.9448  0.7117  2.9680  7.6930</code></pre>
<p>Student achievement ranges from <span class="math inline">\(\theta\)</span> = -7.13 logits for the student with the lowest achievement estimate to <span class="math inline">\(\theta\)</span> = 7.69 logits for the student with the highest achievement estimate. On average, the students were located higher (<span class="math inline">\(M\)</span> <span class="math inline">\(\theta\)</span> = 0.71 logits) than the average domain location (<span class="math inline">\(M\)</span> <span class="math inline">\(\delta\)</span> = 0.00).</p>
<p><strong><em>Threshold estimates</em></strong></p>
<p>Because we used a PC formulation of the MFRM, we have separate estimates of the rating scale category thresholds for each domain. As a result, we can evaluate rating scale category thresholds from the perspective of rating scale analysis <span class="citation">(<a href="#ref-Optimizing_RS" role="doc-biblioref">John M. Linacre 2002</a>)</span>. For example, we can examine the degree to which the thresholds are non-decreasing across increasing rating scale categories, and the degree to which each category describes a unique range of locations on the latent variable. In the following code, we organize the threshold values in a matrix with separate rows for each domain. Then, we print the first six rows of the threshold matrix to the console to preview it.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="MFR-model.html#cb93-1" aria-hidden="true" tabindex="-1"></a>n.domains <span class="ot">&lt;-</span> <span class="fu">nrow</span>(domain.estimates)</span>
<span id="cb93-2"><a href="MFR-model.html#cb93-2" aria-hidden="true" tabindex="-1"></a>n.thresholds <span class="ot">&lt;-</span> <span class="fu">max</span>(writing.resp)</span>
<span id="cb93-3"><a href="MFR-model.html#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="MFR-model.html#cb93-4" aria-hidden="true" tabindex="-1"></a>domain_taus <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> n.domains, <span class="at">ncol =</span> n.thresholds)</span>
<span id="cb93-5"><a href="MFR-model.html#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="MFR-model.html#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(domain.number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.domains){</span>
<span id="cb93-7"><a href="MFR-model.html#cb93-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-8"><a href="MFR-model.html#cb93-8" aria-hidden="true" tabindex="-1"></a>  domain.threshold.labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb93-9"><a href="MFR-model.html#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(step.number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.thresholds){</span>
<span id="cb93-10"><a href="MFR-model.html#cb93-10" aria-hidden="true" tabindex="-1"></a>    domain.threshold.labels[step.number] <span class="ot">&lt;-</span> <span class="fu">paste</span>(domain.estimates<span class="sc">$</span>parameter[domain.number], <span class="st">&quot;:step&quot;</span>, step.number, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb93-11"><a href="MFR-model.html#cb93-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-12"><a href="MFR-model.html#cb93-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-13"><a href="MFR-model.html#cb93-13" aria-hidden="true" tabindex="-1"></a>  domain.thresholds <span class="ot">&lt;-</span> <span class="fu">subset</span>(threshold.estimates, </span>
<span id="cb93-14"><a href="MFR-model.html#cb93-14" aria-hidden="true" tabindex="-1"></a>                           threshold.estimates<span class="sc">$</span>parameter <span class="sc">%in%</span> domain.threshold.labels)</span>
<span id="cb93-15"><a href="MFR-model.html#cb93-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-16"><a href="MFR-model.html#cb93-16" aria-hidden="true" tabindex="-1"></a>  domain.thresholds.t <span class="ot">&lt;-</span> <span class="fu">t</span>(domain.thresholds<span class="sc">$</span>xsi)</span>
<span id="cb93-17"><a href="MFR-model.html#cb93-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-18"><a href="MFR-model.html#cb93-18" aria-hidden="true" tabindex="-1"></a>  domain_taus[domain.number,] <span class="ot">&lt;-</span> domain.thresholds.t[<span class="dv">1</span>,]</span>
<span id="cb93-19"><a href="MFR-model.html#cb93-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-20"><a href="MFR-model.html#cb93-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-21"><a href="MFR-model.html#cb93-21" aria-hidden="true" tabindex="-1"></a>domain_taus <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n.domains), domain_taus)</span>
<span id="cb93-22"><a href="MFR-model.html#cb93-22" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(domain_taus) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;domain&quot;</span>, <span class="st">&quot;t1&quot;</span>, <span class="st">&quot;t2&quot;</span>, <span class="st">&quot;t3&quot;</span>)</span>
<span id="cb93-23"><a href="MFR-model.html#cb93-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-24"><a href="MFR-model.html#cb93-24" aria-hidden="true" tabindex="-1"></a>domain_taus</span></code></pre></div>
<pre><code>##   domain        t1          t2       t3
## 1      1 -3.725268  0.27603490 3.449234
## 2      2 -3.642835  0.20323183 3.439604
## 3      3 -3.610870 -0.08923873 3.700108
## 4      4 -3.124334 -0.20954280 3.333877</code></pre>
<p><strong><em>Wright Map</em></strong></p>
<p>Next, we will plot a Wright Map to display the locations of the parameter estimates for our PC-MFR model. The <code>wrightMap()</code> function requires us to store the domain location estimates as a matrix that shows domain-specific threshold locations. We already did this when we created the <code>domain_taus</code>object earlier.</p>
<p>We can plot the Wright map using the <code>wrightMap()</code> function. We specify several graphical parameters to modify the appearance of the plot.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="MFR-model.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wrightMap</span>(<span class="at">thetas =</span><span class="fu">cbind</span>(student.locations_PCMFR<span class="sc">$</span>theta,</span>
<span id="cb95-2"><a href="MFR-model.html#cb95-2" aria-hidden="true" tabindex="-1"></a>                            rater.estimates<span class="sc">$</span>xsi),</span>
<span id="cb95-3"><a href="MFR-model.html#cb95-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.persons =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb95-4"><a href="MFR-model.html#cb95-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">dim.names =</span> <span class="fu">c</span>(<span class="st">&quot;Students&quot;</span>, <span class="st">&quot;Raters&quot;</span>), </span>
<span id="cb95-5"><a href="MFR-model.html#cb95-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">thresholds =</span> domain_taus[,<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb95-6"><a href="MFR-model.html#cb95-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.thr.lab  =</span> <span class="cn">TRUE</span>,</span>
<span id="cb95-7"><a href="MFR-model.html#cb95-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">label.items.rows=</span> <span class="dv">2</span>,</span>
<span id="cb95-8"><a href="MFR-model.html#cb95-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">label.items =</span> domain.estimates<span class="sc">$</span>parameter,</span>
<span id="cb95-9"><a href="MFR-model.html#cb95-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.items =</span> <span class="st">&quot;Domains&quot;</span>,</span>
<span id="cb95-10"><a href="MFR-model.html#cb95-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title =</span> <span class="st">&quot;Partial Credit Many-Facet Rasch Model </span><span class="sc">\n</span><span class="st">Wright Map: Style Ratings&quot;</span>,</span>
<span id="cb95-11"><a href="MFR-model.html#cb95-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex.main =</span> .<span class="dv">6</span>)</span></code></pre></div>
<pre><code>## Warning in cbind(student.locations_PCMFR$theta, rater.estimates$xsi): number of
## rows of result is not a multiple of vector length (arg 2)</code></pre>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<pre><code>##             t1          t2       t3
## [1,] -3.725268  0.27603490 3.449234
## [2,] -3.642835  0.20323183 3.439604
## [3,] -3.610870 -0.08923873 3.700108
## [4,] -3.124334 -0.20954280 3.333877</code></pre>
<p>In this <em>Wright Map</em> display, the results from the PC-MFRM analysis of the writing assessment ratings are summarized graphically using the same format as the first example in this chapter. The major differences between the models are that domains are included as a facet instead of student subgroups, and each domain has a unique set of threshold estimates.</p>
<p><strong><em>Evaluate Model-Data Fit</em></strong></p>
<p>Next, we will evaluate model-data fit using the same procedures as described earlier in this chapter.</p>
<p><strong><em>Unidimensionality</em></strong></p>
<p>First, we will construct a residual matrix.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="MFR-model.html#cb98-1" aria-hidden="true" tabindex="-1"></a>resids <span class="ot">&lt;-</span> <span class="fu">IRT.residuals</span>(writing_PC_MFRM.model)</span>
<span id="cb98-2"><a href="MFR-model.html#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="MFR-model.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the raw residuals from the residuals object:</span></span>
<span id="cb98-4"><a href="MFR-model.html#cb98-4" aria-hidden="true" tabindex="-1"></a>resid.matrix <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resids<span class="sc">$</span>residuals)</span></code></pre></div>
<p>Next, we will calculate standardized residuals and save them in a matrix.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="MFR-model.html#cb99-1" aria-hidden="true" tabindex="-1"></a>std.resid.matrix <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resids<span class="sc">$</span>stand_residuals)</span></code></pre></div>
<p>Next, we will calculate the variance in observations due to Rasch-model-estimated locations:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="MFR-model.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance of the observations: VO</span></span>
<span id="cb100-2"><a href="MFR-model.html#cb100-2" aria-hidden="true" tabindex="-1"></a>observations.vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(writing.resp))</span>
<span id="cb100-3"><a href="MFR-model.html#cb100-3" aria-hidden="true" tabindex="-1"></a>VO <span class="ot">&lt;-</span> <span class="fu">var</span>(observations.vector)</span>
<span id="cb100-4"><a href="MFR-model.html#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="MFR-model.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance of the residuals: VR</span></span>
<span id="cb100-6"><a href="MFR-model.html#cb100-6" aria-hidden="true" tabindex="-1"></a>residuals.vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(resid.matrix))</span>
<span id="cb100-7"><a href="MFR-model.html#cb100-7" aria-hidden="true" tabindex="-1"></a>VR <span class="ot">&lt;-</span> <span class="fu">var</span>(residuals.vector)</span>
<span id="cb100-8"><a href="MFR-model.html#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="MFR-model.html#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw variance explained by Rasch measures: (VO - VR)/VO</span></span>
<span id="cb100-10"><a href="MFR-model.html#cb100-10" aria-hidden="true" tabindex="-1"></a>(VO <span class="sc">-</span> VR)<span class="sc">/</span>VO</span></code></pre></div>
<pre><code>## [1] 0.7143585</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="MFR-model.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Express the result as a percent:</span></span>
<span id="cb102-2"><a href="MFR-model.html#cb102-2" aria-hidden="true" tabindex="-1"></a>((VO <span class="sc">-</span> VR)<span class="sc">/</span>VO) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 71.43585</code></pre>
<p>Approximately 71.44% of the variance in ratings can be explained by the PC-MFRM estimates of student, domain, and rater locations on the logit scale that represents the latent variable.</p>
<p><strong><em>Principal Components Analysis of Standardized Residual Correlations</em></strong></p>
<p>Next, we will evaluate the MFRM requirement for unidimensionality using a principal components analysis (PCA) of standardized residual correlations.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="MFR-model.html#cb104-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">pca</span>(<span class="fu">as.matrix</span>(std.resid.matrix), <span class="at">rotate =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb104-2"><a href="MFR-model.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="MFR-model.html#cb104-3" aria-hidden="true" tabindex="-1"></a>contrasts <span class="ot">&lt;-</span> <span class="fu">c</span>(pca<span class="sc">$</span>values[<span class="dv">1</span>], pca<span class="sc">$</span>values[<span class="dv">2</span>], pca<span class="sc">$</span>values[<span class="dv">3</span>], pca<span class="sc">$</span>values[<span class="dv">4</span>], pca<span class="sc">$</span>values[<span class="dv">5</span>])</span>
<span id="cb104-4"><a href="MFR-model.html#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="MFR-model.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(contrasts, <span class="at">ylab =</span> <span class="st">&quot;Eigenvalues for Contrasts&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Contrast Number&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Contrasts from PCA of Standardized Residual Correlations </span><span class="sc">\n</span><span class="st">(PC-MFRM)&quot;</span>, <span class="at">cex.main =</span> .<span class="dv">8</span>)</span></code></pre></div>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>In this example, there are three contrasts that have an eigenvalue larger than <span class="citation"><a href="#ref-PCA_procedure" role="doc-biblioref">John Michael Linacre</a> (<a href="#ref-PCA_procedure" role="doc-biblioref">2016</a>)</span>’s critical value of 2.00. This result suggests potential multi-dimensionality. We will explore the results further using residual-based fit statistics.</p>
<p><strong><em>Summaries of Residuals: Infit &amp; Outfit Statistics</em></strong></p>
<p>Next, we will evaluate model-data fit for individual elements of our facets (students, subgroups, and raters) using numeric summaries of the residuals associated with each element, as we have done in previous chapters.</p>
<p><strong><em>Student Fit</em></strong></p>
<p>First, we will examine student fit using numeric outfit and infit statistics. We can request these statistics for each student using the <code>tam.personfit()</code> function. We will store the student fit results in an object called <code>student.fit</code>, and then request a summary of the results.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="MFR-model.html#cb105-1" aria-hidden="true" tabindex="-1"></a>student.fit <span class="ot">&lt;-</span> <span class="fu">tam.personfit</span>(writing_PC_MFRM.model)</span>
<span id="cb105-2"><a href="MFR-model.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(student.fit)</span></code></pre></div>
<pre><code>##   outfitPerson    outfitPerson_t     infitPerson     infitPerson_t    
##  Min.   :0.2405   Min.   :-3.7371   Min.   :0.4884   Min.   :-3.9688  
##  1st Qu.:0.8048   1st Qu.:-1.2204   1st Qu.:0.8268   1st Qu.:-1.1888  
##  Median :0.9465   Median :-0.2436   Median :0.9620   Median :-0.1598  
##  Mean   :0.9618   Mean   :-0.2482   Mean   :0.9714   Mean   :-0.2213  
##  3rd Qu.:1.0954   3rd Qu.: 0.7088   3rd Qu.:1.0871   3rd Qu.: 0.6185  
##  Max.   :1.9949   Max.   : 5.3917   Max.   :1.9824   Max.   : 5.4138</code></pre>
<p>On average, the outfit and infit <span class="math inline">\(MSE\)</span> statistics are slightly lower than the expected value of 1 (<span class="math inline">\(M\)</span> outfit = 0.96, *<span class="math inline">\(M\)</span> infit = 0.97). The average values of the standardized fit statistics are also slightly lower than their expected value of 0 (<span class="math inline">\(M\)</span> std. outfit = -0.25, <span class="math inline">\(M\)</span> std. infit = -0.22). For both the standardized and unstandardized fit statistics, there is notable variability across the student sample. This result suggests that model-data fit varies for individual students.</p>
<p><strong><em>Domain and Rater Fit</em></strong></p>
<p>We can also examine model-data fit related to the domain and rater facets. In the <em>TAM</em> package, fit analysis for facets besides the object of measurement uses combinations of elements within facets. In our example, fit statistics are calculated for rater*subgroup combinations.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="MFR-model.html#cb107-1" aria-hidden="true" tabindex="-1"></a>rater.domain.fit <span class="ot">&lt;-</span> <span class="fu">msq.itemfit</span>(writing_PC_MFRM.model)</span>
<span id="cb107-2"><a href="MFR-model.html#cb107-2" aria-hidden="true" tabindex="-1"></a>rater.domain.fit <span class="ot">&lt;-</span> rater.domain.fit<span class="sc">$</span>itemfit</span>
<span id="cb107-3"><a href="MFR-model.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rater.domain.fit)</span></code></pre></div>
<pre><code>##      item              fitgroup         Outfit          Outfit_t      
##  Length:84          Min.   : 1.00   Min.   :0.5309   Min.   :-7.3816  
##  Class :character   1st Qu.:21.75   1st Qu.:0.8521   1st Qu.:-1.9994  
##  Mode  :character   Median :42.50   Median :0.9584   Median :-0.5210  
##                     Mean   :42.50   Mean   :0.9773   Mean   :-0.4319  
##                     3rd Qu.:63.25   3rd Qu.:1.1410   3rd Qu.: 1.5425  
##                     Max.   :84.00   Max.   :1.5076   Max.   : 5.7335  
##     Outfit_p            Infit           Infit_t           Infit_p        
##  Min.   :0.000000   Min.   :0.5627   Min.   :-7.4049   Min.   :0.000000  
##  1st Qu.:0.003517   1st Qu.:0.8657   1st Qu.:-1.9621   1st Qu.:0.002148  
##  Median :0.092685   Median :0.9784   Median :-0.2818   Median :0.103798  
##  Mean   :0.231879   Mean   :0.9813   Mean   :-0.4201   Mean   :0.234087  
##  3rd Qu.:0.456375   3rd Qu.:1.1088   3rd Qu.: 1.5044   3rd Qu.:0.417554  
##  Max.   :0.990028   Max.   :1.5218   Max.   : 6.3830   Max.   :0.981096</code></pre>
<p>As needed, researchers can also examine model-data fit statistics specific to levels of explanatory facets, such as domains in the current example. This can be accomplished by calculating summaries of fit statistics within domains. The code below calculates averages of rater fit within each domain. For a more detailed view of rater fit within domains, we create an object with domain-specific rater fit statistics in the subsequent code block.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="MFR-model.html#cb109-1" aria-hidden="true" tabindex="-1"></a>ngroups <span class="ot">&lt;-</span> <span class="fu">nrow</span>(domain.estimates)</span>
<span id="cb109-2"><a href="MFR-model.html#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="MFR-model.html#cb109-3" aria-hidden="true" tabindex="-1"></a>domain.fit <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">ncol</span>(domain.estimates), <span class="at">ncol =</span> <span class="dv">4</span> )</span>
<span id="cb109-4"><a href="MFR-model.html#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="MFR-model.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(domain.number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(domain.estimates)){</span>
<span id="cb109-6"><a href="MFR-model.html#cb109-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-7"><a href="MFR-model.html#cb109-7" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> domain.estimates<span class="sc">$</span>parameter[domain.number]</span>
<span id="cb109-8"><a href="MFR-model.html#cb109-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-9"><a href="MFR-model.html#cb109-9" aria-hidden="true" tabindex="-1"></a>  rater.domain.labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb109-10"><a href="MFR-model.html#cb109-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-11"><a href="MFR-model.html#cb109-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rater.estimates)){</span>
<span id="cb109-12"><a href="MFR-model.html#cb109-12" aria-hidden="true" tabindex="-1"></a>      rater_label <span class="ot">&lt;-</span> rater.estimates<span class="sc">$</span>parameter[r]</span>
<span id="cb109-13"><a href="MFR-model.html#cb109-13" aria-hidden="true" tabindex="-1"></a>    rater.domain.labels[r] <span class="ot">&lt;-</span> <span class="fu">paste</span>(d, <span class="st">&quot;-&quot;</span>, rater_label, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb109-14"><a href="MFR-model.html#cb109-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb109-15"><a href="MFR-model.html#cb109-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-16"><a href="MFR-model.html#cb109-16" aria-hidden="true" tabindex="-1"></a>  rater.domain.fit.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(rater.domain.fit, rater.domain.fit<span class="sc">$</span>item <span class="sc">%in%</span> rater.domain.labels) </span>
<span id="cb109-17"><a href="MFR-model.html#cb109-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-18"><a href="MFR-model.html#cb109-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the fit statistics to the matrix:  </span></span>
<span id="cb109-19"><a href="MFR-model.html#cb109-19" aria-hidden="true" tabindex="-1"></a>  domain.fit[domain.number, ] <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="fu">mean</span>(rater.domain.fit.subset<span class="sc">$</span>Infit),</span>
<span id="cb109-20"><a href="MFR-model.html#cb109-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">mean</span>(rater.domain.fit.subset<span class="sc">$</span>Outfit),</span>
<span id="cb109-21"><a href="MFR-model.html#cb109-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">mean</span>(rater.domain.fit.subset<span class="sc">$</span>Infit_t),</span>
<span id="cb109-22"><a href="MFR-model.html#cb109-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">mean</span>(rater.domain.fit.subset<span class="sc">$</span>Outfit_t))</span>
<span id="cb109-23"><a href="MFR-model.html#cb109-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-24"><a href="MFR-model.html#cb109-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-25"><a href="MFR-model.html#cb109-25" aria-hidden="true" tabindex="-1"></a><span class="co"># add domain labels to the domain.fit object:</span></span>
<span id="cb109-26"><a href="MFR-model.html#cb109-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-27"><a href="MFR-model.html#cb109-27" aria-hidden="true" tabindex="-1"></a>domain.fit <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(domain.estimates<span class="sc">$</span>parameter,</span>
<span id="cb109-28"><a href="MFR-model.html#cb109-28" aria-hidden="true" tabindex="-1"></a>                               domain.fit)</span>
<span id="cb109-29"><a href="MFR-model.html#cb109-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-30"><a href="MFR-model.html#cb109-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the domain fit results to a data frame object and add meaningful column names:  </span></span>
<span id="cb109-31"><a href="MFR-model.html#cb109-31" aria-hidden="true" tabindex="-1"></a>domain.fit_results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(domain.fit)</span>
<span id="cb109-32"><a href="MFR-model.html#cb109-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-33"><a href="MFR-model.html#cb109-33" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(domain.fit_results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;domain&quot;</span>, <span class="st">&quot;Mean_Infit_MSE&quot;</span>, <span class="st">&quot;Mean_Outfit_MSE&quot;</span>, </span>
<span id="cb109-34"><a href="MFR-model.html#cb109-34" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;Mean_Std_Infit&quot;</span>, <span class="st">&quot;Mean_Std_Outfit&quot;</span>)</span></code></pre></div>
<p>Now that we have created a data frame with the domain-specific (average) fit statistics, we can summarize the results.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="MFR-model.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(domain.fit_results)</span></code></pre></div>
<pre><code>##     domain          Mean_Infit_MSE   Mean_Outfit_MSE  Mean_Std_Infit   
##  Length:4           Min.   :0.9424   Min.   :0.9390   Min.   :-1.0223  
##  Class :character   1st Qu.:0.9581   1st Qu.:0.9488   1st Qu.:-0.7369  
##  Mode  :character   Median :0.9706   Median :0.9567   Median :-0.5483  
##                     Mean   :0.9813   Mean   :0.9773   Mean   :-0.4201  
##                     3rd Qu.:0.9938   3rd Qu.:0.9852   3rd Qu.:-0.2315  
##                     Max.   :1.0415   Max.   :1.0566   Max.   : 0.4386  
##  Mean_Std_Outfit  
##  Min.   :-1.0032  
##  1st Qu.:-0.7373  
##  Median :-0.6383  
##  Mean   :-0.4319  
##  3rd Qu.:-0.3329  
##  Max.   : 0.5522</code></pre>
<p>Finally, it may be useful to examine fit statistics as they apply to individual raters. This can be accomplished by extracting rater-specific fit statistics within each domain. The code below calculates rater fit statistics within each subgroup.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="MFR-model.html#cb112-1" aria-hidden="true" tabindex="-1"></a>n.domains <span class="ot">&lt;-</span> <span class="fu">nrow</span>(domain.estimates)</span>
<span id="cb112-2"><a href="MFR-model.html#cb112-2" aria-hidden="true" tabindex="-1"></a>n.raters <span class="ot">&lt;-</span> <span class="fu">nrow</span>(rater.estimates)</span>
<span id="cb112-3"><a href="MFR-model.html#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="MFR-model.html#cb112-4" aria-hidden="true" tabindex="-1"></a>rater.fit <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> n.raters, <span class="at">ncol =</span> (n.domains <span class="sc">*</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="dv">1</span> )</span>
<span id="cb112-5"><a href="MFR-model.html#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="MFR-model.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rater.number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rater.estimates)){</span>
<span id="cb112-7"><a href="MFR-model.html#cb112-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-8"><a href="MFR-model.html#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(rater.number <span class="sc">&lt;</span> <span class="dv">10</span>) r <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;rater_&quot;</span>, rater.number, <span class="st">&quot;_&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb112-9"><a href="MFR-model.html#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(rater.number <span class="sc">&gt;=</span> <span class="dv">10</span>) r <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;rater_&quot;</span>, rater.number, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb112-10"><a href="MFR-model.html#cb112-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-11"><a href="MFR-model.html#cb112-11" aria-hidden="true" tabindex="-1"></a>  rater.domain.labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb112-12"><a href="MFR-model.html#cb112-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb112-13"><a href="MFR-model.html#cb112-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(domain.estimates)){</span>
<span id="cb112-14"><a href="MFR-model.html#cb112-14" aria-hidden="true" tabindex="-1"></a>      domain_label <span class="ot">&lt;-</span> domain.estimates<span class="sc">$</span>parameter[d]</span>
<span id="cb112-15"><a href="MFR-model.html#cb112-15" aria-hidden="true" tabindex="-1"></a>    rater.domain.labels[d] <span class="ot">&lt;-</span> <span class="fu">paste</span>(domain_label, <span class="st">&quot;-&quot;</span>, r, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb112-16"><a href="MFR-model.html#cb112-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb112-17"><a href="MFR-model.html#cb112-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-18"><a href="MFR-model.html#cb112-18" aria-hidden="true" tabindex="-1"></a>  rater.domain.fit.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(rater.domain.fit, rater.domain.fit<span class="sc">$</span>item <span class="sc">%in%</span> rater.domain.labels) </span>
<span id="cb112-19"><a href="MFR-model.html#cb112-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-20"><a href="MFR-model.html#cb112-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate rater-specific fit statistics:</span></span>
<span id="cb112-21"><a href="MFR-model.html#cb112-21" aria-hidden="true" tabindex="-1"></a>  rater.outfit <span class="ot">&lt;-</span> rater.domain.fit.subset<span class="sc">$</span>Outfit</span>
<span id="cb112-22"><a href="MFR-model.html#cb112-22" aria-hidden="true" tabindex="-1"></a>  rater.infit <span class="ot">&lt;-</span> rater.domain.fit.subset<span class="sc">$</span>Outfit</span>
<span id="cb112-23"><a href="MFR-model.html#cb112-23" aria-hidden="true" tabindex="-1"></a>  rater.std.outfit <span class="ot">&lt;-</span> rater.domain.fit.subset<span class="sc">$</span>Outfit_t</span>
<span id="cb112-24"><a href="MFR-model.html#cb112-24" aria-hidden="true" tabindex="-1"></a>  rater.std.infit <span class="ot">&lt;-</span> rater.domain.fit.subset<span class="sc">$</span>Infit_t</span>
<span id="cb112-25"><a href="MFR-model.html#cb112-25" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb112-26"><a href="MFR-model.html#cb112-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the fit statistics to the matrix:  </span></span>
<span id="cb112-27"><a href="MFR-model.html#cb112-27" aria-hidden="true" tabindex="-1"></a>  rater.fit[rater.number, ] <span class="ot">&lt;-</span>  <span class="fu">c</span>(rater.number, rater.outfit, rater.infit,</span>
<span id="cb112-28"><a href="MFR-model.html#cb112-28" aria-hidden="true" tabindex="-1"></a>                                  rater.std.outfit, rater.std.infit)</span>
<span id="cb112-29"><a href="MFR-model.html#cb112-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-30"><a href="MFR-model.html#cb112-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-31"><a href="MFR-model.html#cb112-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-32"><a href="MFR-model.html#cb112-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the rater fit results to a dataframe object and add meaningful column names:  </span></span>
<span id="cb112-33"><a href="MFR-model.html#cb112-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-34"><a href="MFR-model.html#cb112-34" aria-hidden="true" tabindex="-1"></a>rater.fit_results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(rater.fit)</span>
<span id="cb112-35"><a href="MFR-model.html#cb112-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-36"><a href="MFR-model.html#cb112-36" aria-hidden="true" tabindex="-1"></a>infit_mse_labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb112-37"><a href="MFR-model.html#cb112-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(domain <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.domains){</span>
<span id="cb112-38"><a href="MFR-model.html#cb112-38" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> domain.estimates<span class="sc">$</span>parameter[domain]</span>
<span id="cb112-39"><a href="MFR-model.html#cb112-39" aria-hidden="true" tabindex="-1"></a>  infit_mse_labels[domain] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Infit_MSE_&quot;</span>, d, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb112-40"><a href="MFR-model.html#cb112-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-41"><a href="MFR-model.html#cb112-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-42"><a href="MFR-model.html#cb112-42" aria-hidden="true" tabindex="-1"></a>outfit_mse_labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb112-43"><a href="MFR-model.html#cb112-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(domain <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.domains){</span>
<span id="cb112-44"><a href="MFR-model.html#cb112-44" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> domain.estimates<span class="sc">$</span>parameter[domain]</span>
<span id="cb112-45"><a href="MFR-model.html#cb112-45" aria-hidden="true" tabindex="-1"></a>  outfit_mse_labels[domain] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;outfit_MSE_&quot;</span>, d, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb112-46"><a href="MFR-model.html#cb112-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-47"><a href="MFR-model.html#cb112-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-48"><a href="MFR-model.html#cb112-48" aria-hidden="true" tabindex="-1"></a>std_infit_mse_labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb112-49"><a href="MFR-model.html#cb112-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(domain <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.domains){</span>
<span id="cb112-50"><a href="MFR-model.html#cb112-50" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> domain.estimates<span class="sc">$</span>parameter[domain]</span>
<span id="cb112-51"><a href="MFR-model.html#cb112-51" aria-hidden="true" tabindex="-1"></a>  std_infit_mse_labels[domain] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;std_infit_MSE_&quot;</span>, d, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb112-52"><a href="MFR-model.html#cb112-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-53"><a href="MFR-model.html#cb112-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-54"><a href="MFR-model.html#cb112-54" aria-hidden="true" tabindex="-1"></a>std_outfit_mse_labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb112-55"><a href="MFR-model.html#cb112-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(domain <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.domains){</span>
<span id="cb112-56"><a href="MFR-model.html#cb112-56" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> domain.estimates<span class="sc">$</span>parameter[domain]</span>
<span id="cb112-57"><a href="MFR-model.html#cb112-57" aria-hidden="true" tabindex="-1"></a>  std_outfit_mse_labels[domain] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;std_outfit_MSE_&quot;</span>, d, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb112-58"><a href="MFR-model.html#cb112-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-59"><a href="MFR-model.html#cb112-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-60"><a href="MFR-model.html#cb112-60" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rater.fit_results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Rater&quot;</span>, outfit_mse_labels, infit_mse_labels,</span>
<span id="cb112-61"><a href="MFR-model.html#cb112-61" aria-hidden="true" tabindex="-1"></a>                              std_outfit_mse_labels, std_infit_mse_labels)</span></code></pre></div>
<p>Now that we have created a data frame with the rater-specific fit statistics, we can summarize the results.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="MFR-model.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rater.fit_results)</span></code></pre></div>
<pre><code>##      Rater    outfit_MSE_style outfit_MSE_org   outfit_MSE_conv 
##  Min.   : 1   Min.   :0.6203   Min.   :0.5349   Min.   :0.5314  
##  1st Qu.: 6   1st Qu.:0.9423   1st Qu.:0.8183   1st Qu.:0.7423  
##  Median :11   Median :0.9803   Median :0.9543   Median :0.9431  
##  Mean   :11   Mean   :1.0566   Mean   :0.9614   Mean   :0.9390  
##  3rd Qu.:16   3rd Qu.:1.1949   3rd Qu.:1.1284   3rd Qu.:1.1079  
##  Max.   :21   Max.   :1.5076   Max.   :1.2498   Max.   :1.2430  
##  outfit_MSE_sent_form Infit_MSE_style  Infit_MSE_org    Infit_MSE_conv  
##  Min.   :0.5309       Min.   :0.6203   Min.   :0.5349   Min.   :0.5314  
##  1st Qu.:0.8777       1st Qu.:0.9423   1st Qu.:0.8183   1st Qu.:0.7423  
##  Median :0.9336       Median :0.9803   Median :0.9543   Median :0.9431  
##  Mean   :0.9520       Mean   :1.0566   Mean   :0.9614   Mean   :0.9390  
##  3rd Qu.:1.0824       3rd Qu.:1.1949   3rd Qu.:1.1284   3rd Qu.:1.1079  
##  Max.   :1.2808       Max.   :1.5076   Max.   :1.2498   Max.   :1.2430  
##  Infit_MSE_sent_form std_outfit_MSE_style std_outfit_MSE_org
##  Min.   :0.5309      Min.   :-5.6828      Min.   :-7.2549   
##  1st Qu.:0.8777      1st Qu.:-0.6897      1st Qu.:-2.3590   
##  Median :0.9336      Median :-0.2269      Median :-0.5642   
##  Mean   :0.9520      Mean   : 0.5522      Mean   :-0.6280   
##  3rd Qu.:1.0824      3rd Qu.: 2.4048      3rd Qu.: 1.4881   
##  Max.   :1.2808      Max.   : 5.7335      Max.   : 2.9812   
##  std_outfit_MSE_conv std_outfit_MSE_sent_form std_infit_MSE_style
##  Min.   :-7.3816     Min.   :-5.8979          Min.   :-5.73380   
##  1st Qu.:-3.6658     1st Qu.:-1.3706          1st Qu.:-0.99401   
##  Median :-0.7047     Median :-0.6790          Median :-0.06115   
##  Mean   :-1.0032     Mean   :-0.6487          Mean   : 0.43862   
##  3rd Qu.: 1.3936     3rd Qu.: 0.9099          3rd Qu.: 2.47375   
##  Max.   : 2.9876     Max.   : 2.9067          Max.   : 6.38299   
##  std_infit_MSE_org std_infit_MSE_conv std_infit_MSE_sent_form
##  Min.   :-7.2672   Min.   :-7.4049    Min.   :-6.5507        
##  1st Qu.:-2.2358   1st Qu.:-4.1189    1st Qu.:-1.4860        
##  Median :-0.1441   Median :-0.6799    Median :-0.7798        
##  Mean   :-0.4549   Mean   :-1.0223    Mean   :-0.6418        
##  3rd Qu.: 1.2517   3rd Qu.: 1.4964    3rd Qu.: 0.8452        
##  Max.   : 3.8177   Max.   : 3.8886    Max.   : 4.0513</code></pre>
<p><strong><em>Graphical Displays of Residuals</em></strong></p>
<p>Next, we will construct plots of standardized residuals associated with individual raters within each domain.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="MFR-model.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Before constructing the plots, find the maximum and minimum values of the standardized residuals to set limits for the axes:</span></span>
<span id="cb115-2"><a href="MFR-model.html#cb115-2" aria-hidden="true" tabindex="-1"></a>max.resid <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">max</span>(std.resid.matrix))</span>
<span id="cb115-3"><a href="MFR-model.html#cb115-3" aria-hidden="true" tabindex="-1"></a>min.resid <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">min</span>(std.resid.matrix))</span>
<span id="cb115-4"><a href="MFR-model.html#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="MFR-model.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The code below will produce plots of standardized residuals for selected raters as listed in raters.to.plot:</span></span>
<span id="cb115-6"><a href="MFR-model.html#cb115-6" aria-hidden="true" tabindex="-1"></a>raters.to.plot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb115-7"><a href="MFR-model.html#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="MFR-model.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rater.number <span class="cf">in</span> raters.to.plot){</span>
<span id="cb115-9"><a href="MFR-model.html#cb115-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-10"><a href="MFR-model.html#cb115-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(rater.number <span class="sc">&lt;</span> <span class="dv">10</span>) r <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;rater_&quot;</span>, rater.number, <span class="st">&quot;_&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb115-11"><a href="MFR-model.html#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(rater.number <span class="sc">&gt;=</span> <span class="dv">10</span>) r <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;rater_&quot;</span>, rater.number, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb115-12"><a href="MFR-model.html#cb115-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-13"><a href="MFR-model.html#cb115-13" aria-hidden="true" tabindex="-1"></a>  rater.domain.labels <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb115-14"><a href="MFR-model.html#cb115-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb115-15"><a href="MFR-model.html#cb115-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(domain.estimates)){</span>
<span id="cb115-16"><a href="MFR-model.html#cb115-16" aria-hidden="true" tabindex="-1"></a>      domain_label <span class="ot">&lt;-</span> domain.estimates<span class="sc">$</span>parameter[d]</span>
<span id="cb115-17"><a href="MFR-model.html#cb115-17" aria-hidden="true" tabindex="-1"></a>    rater.domain.labels[d] <span class="ot">&lt;-</span> <span class="fu">paste</span>(domain_label, <span class="st">&quot;-&quot;</span>, r, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb115-18"><a href="MFR-model.html#cb115-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb115-19"><a href="MFR-model.html#cb115-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-20"><a href="MFR-model.html#cb115-20" aria-hidden="true" tabindex="-1"></a>  std.resid.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(resids<span class="sc">$</span>stand_residuals, <span class="at">select =</span> rater.domain.labels)</span>
<span id="cb115-21"><a href="MFR-model.html#cb115-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-22"><a href="MFR-model.html#cb115-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(domain.number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.domains){</span>
<span id="cb115-23"><a href="MFR-model.html#cb115-23" aria-hidden="true" tabindex="-1"></a>    domain.name <span class="ot">&lt;-</span> domain.estimates<span class="sc">$</span>parameter[domain.number]</span>
<span id="cb115-24"><a href="MFR-model.html#cb115-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(std.resid.subset[, domain.number], <span class="at">ylim =</span> <span class="fu">c</span>(min.resid, max.resid),</span>
<span id="cb115-25"><a href="MFR-model.html#cb115-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Standardized Residuals for Rater &quot;</span>, rater.number, <span class="st">&quot; Domain = &quot;</span>, domain.name, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb115-26"><a href="MFR-model.html#cb115-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Standardized Residual&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Person Index&quot;</span>)</span>
<span id="cb115-27"><a href="MFR-model.html#cb115-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb115-28"><a href="MFR-model.html#cb115-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb115-29"><a href="MFR-model.html#cb115-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb115-30"><a href="MFR-model.html#cb115-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-31"><a href="MFR-model.html#cb115-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Std. Residual&quot;</span>, <span class="st">&quot;Observed = Expected&quot;</span>, <span class="st">&quot;+/- 2 SD&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), </span>
<span id="cb115-32"><a href="MFR-model.html#cb115-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb115-33"><a href="MFR-model.html#cb115-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">cex =</span> .<span class="dv">8</span>)</span>
<span id="cb115-34"><a href="MFR-model.html#cb115-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-35"><a href="MFR-model.html#cb115-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-71-1.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-71-2.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-71-3.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-71-4.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-71-5.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-71-6.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-71-7.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-71-8.png" width="672" /></p>
<p>A separate plot is produced for each rater*domain combination.</p>
<p><strong><em>Expected and Observed Response Functions</em></strong></p>
<p>Finally, we will construct plots of expected and observed response functions. By default, the <em>TAM</em> package combines the item facet (in this case, domains), with levels of the other facets (in this case, raters) when constructing expected and observed response function plots.</p>
<p>For brevity, we only plot the expected and observed response functions for three selected rater*domain combinations. Readers can adjust the <code>items=</code> specification to construct plots for elements of interest for their analyses.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="MFR-model.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(writing_PC_MFRM.model, <span class="at">type =</span> <span class="st">&quot;expected&quot;</span>, <span class="at">items =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Iteration in WLE/MLE estimation  1   | Maximal change  2.2459 
## Iteration in WLE/MLE estimation  2   | Maximal change  0.8781 
## Iteration in WLE/MLE estimation  3   | Maximal change  0.5385 
## Iteration in WLE/MLE estimation  4   | Maximal change  0.1794 
## Iteration in WLE/MLE estimation  5   | Maximal change  0.0144 
## Iteration in WLE/MLE estimation  6   | Maximal change  1e-04 
## Iteration in WLE/MLE estimation  7   | Maximal change  0 
## ----
##  WLE Reliability= 0.993</code></pre>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-72-1.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-72-2.png" width="672" /><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-72-3.png" width="672" /></p>
<pre><code>## ....................................................
##  Plots exported in png format into folder:
##  /Users/chenghua/Documents/GitHub/The Rasch Book/Plots</code></pre>
<p><strong><em>Summarize the Results in Tables</em></strong></p>
<p>As a final step, we will create tables that summarize the calibrations of the students, domains, raters, and rating scale category thresholds.</p>
<p>Table 1 provides an overview of the logit scale locations, standard errors and fit statistics for all of the facets in the analysis. This table provides a quick overview of the location estimates and numeric model-data fit statistics for the facets in a MFRM.</p>
<p>Because of the estimation procedure for the MFRM in <em>TAM</em>, fit statistics are combined for the item facet (in this case, domains) and other facets. As a result, the fit statistics in this table will be the same for the rater facet and the domain facets.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="MFR-model.html#cb119-1" aria-hidden="true" tabindex="-1"></a>PC_MFRM_summary.table.statistics <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Logit Scale Location Mean&quot;</span>,</span>
<span id="cb119-2"><a href="MFR-model.html#cb119-2" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Logit Scale Location SD&quot;</span>,</span>
<span id="cb119-3"><a href="MFR-model.html#cb119-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Standard Error Mean&quot;</span>,</span>
<span id="cb119-4"><a href="MFR-model.html#cb119-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Standard Error SD&quot;</span>,</span>
<span id="cb119-5"><a href="MFR-model.html#cb119-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Outfit MSE Mean&quot;</span>,</span>
<span id="cb119-6"><a href="MFR-model.html#cb119-6" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Outfit MSE SD&quot;</span>,</span>
<span id="cb119-7"><a href="MFR-model.html#cb119-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Infit MSE Mean&quot;</span>,</span>
<span id="cb119-8"><a href="MFR-model.html#cb119-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Infit MSE SD&quot;</span>,</span>
<span id="cb119-9"><a href="MFR-model.html#cb119-9" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Std. Outfit Mean&quot;</span>,</span>
<span id="cb119-10"><a href="MFR-model.html#cb119-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Std. Outfit SD&quot;</span>,</span>
<span id="cb119-11"><a href="MFR-model.html#cb119-11" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Std. Infit Mean&quot;</span>,</span>
<span id="cb119-12"><a href="MFR-model.html#cb119-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Std. Infit SD&quot;</span>)</span>
<span id="cb119-13"><a href="MFR-model.html#cb119-13" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb119-14"><a href="MFR-model.html#cb119-14" aria-hidden="true" tabindex="-1"></a>PC_MFRM_student.summary.results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">mean</span>(student.locations_PCMFR<span class="sc">$</span>theta),</span>
<span id="cb119-15"><a href="MFR-model.html#cb119-15" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.locations_PCMFR<span class="sc">$</span>theta),</span>
<span id="cb119-16"><a href="MFR-model.html#cb119-16" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.locations_PCMFR<span class="sc">$</span>se),</span>
<span id="cb119-17"><a href="MFR-model.html#cb119-17" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.locations_PCMFR<span class="sc">$</span>se),</span>
<span id="cb119-18"><a href="MFR-model.html#cb119-18" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.fit<span class="sc">$</span>outfitPerson),</span>
<span id="cb119-19"><a href="MFR-model.html#cb119-19" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.fit<span class="sc">$</span>outfitPerson),</span>
<span id="cb119-20"><a href="MFR-model.html#cb119-20" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.fit<span class="sc">$</span>infitPerson),</span>
<span id="cb119-21"><a href="MFR-model.html#cb119-21" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.fit<span class="sc">$</span>infitPerson),</span>
<span id="cb119-22"><a href="MFR-model.html#cb119-22" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.fit<span class="sc">$</span>outfitPerson_t),</span>
<span id="cb119-23"><a href="MFR-model.html#cb119-23" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.fit<span class="sc">$</span>outfitPerson_t),</span>
<span id="cb119-24"><a href="MFR-model.html#cb119-24" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(student.fit<span class="sc">$</span>infitPerson_t),</span>
<span id="cb119-25"><a href="MFR-model.html#cb119-25" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(student.fit<span class="sc">$</span>infitPerson_t))</span>
<span id="cb119-26"><a href="MFR-model.html#cb119-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-27"><a href="MFR-model.html#cb119-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-28"><a href="MFR-model.html#cb119-28" aria-hidden="true" tabindex="-1"></a>PC_MFRM_domain.summary.results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">mean</span>(domain.estimates<span class="sc">$</span>xsi),</span>
<span id="cb119-29"><a href="MFR-model.html#cb119-29" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(domain.estimates<span class="sc">$</span>xsi),</span>
<span id="cb119-30"><a href="MFR-model.html#cb119-30" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(domain.estimates<span class="sc">$</span>se.xsi),</span>
<span id="cb119-31"><a href="MFR-model.html#cb119-31" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(domain.estimates<span class="sc">$</span>se.xsi),</span>
<span id="cb119-32"><a href="MFR-model.html#cb119-32" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.domain.fit<span class="sc">$</span>Outfit),</span>
<span id="cb119-33"><a href="MFR-model.html#cb119-33" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.domain.fit<span class="sc">$</span>Outfit),</span>
<span id="cb119-34"><a href="MFR-model.html#cb119-34" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.domain.fit<span class="sc">$</span>Infit),</span>
<span id="cb119-35"><a href="MFR-model.html#cb119-35" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.domain.fit<span class="sc">$</span>Infit),</span>
<span id="cb119-36"><a href="MFR-model.html#cb119-36" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.domain.fit<span class="sc">$</span>Outfit_t),</span>
<span id="cb119-37"><a href="MFR-model.html#cb119-37" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.domain.fit<span class="sc">$</span>Outfit_t),</span>
<span id="cb119-38"><a href="MFR-model.html#cb119-38" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.domain.fit<span class="sc">$</span>Infit_t),</span>
<span id="cb119-39"><a href="MFR-model.html#cb119-39" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.domain.fit<span class="sc">$</span>Infit_t))</span>
<span id="cb119-40"><a href="MFR-model.html#cb119-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-41"><a href="MFR-model.html#cb119-41" aria-hidden="true" tabindex="-1"></a>PC_MFRM_rater.summary.results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">mean</span>(rater.estimates<span class="sc">$</span>xsi),</span>
<span id="cb119-42"><a href="MFR-model.html#cb119-42" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.estimates<span class="sc">$</span>xsi),</span>
<span id="cb119-43"><a href="MFR-model.html#cb119-43" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.estimates<span class="sc">$</span>se.xsi),</span>
<span id="cb119-44"><a href="MFR-model.html#cb119-44" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.estimates<span class="sc">$</span>se.xsi),</span>
<span id="cb119-45"><a href="MFR-model.html#cb119-45" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.domain.fit<span class="sc">$</span>Outfit),</span>
<span id="cb119-46"><a href="MFR-model.html#cb119-46" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.domain.fit<span class="sc">$</span>Outfit),</span>
<span id="cb119-47"><a href="MFR-model.html#cb119-47" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.domain.fit<span class="sc">$</span>Infit),</span>
<span id="cb119-48"><a href="MFR-model.html#cb119-48" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.domain.fit<span class="sc">$</span>Infit),</span>
<span id="cb119-49"><a href="MFR-model.html#cb119-49" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.domain.fit<span class="sc">$</span>Outfit_t),</span>
<span id="cb119-50"><a href="MFR-model.html#cb119-50" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.domain.fit<span class="sc">$</span>Outfit_t),</span>
<span id="cb119-51"><a href="MFR-model.html#cb119-51" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(rater.domain.fit<span class="sc">$</span>Infit_t),</span>
<span id="cb119-52"><a href="MFR-model.html#cb119-52" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sd</span>(rater.domain.fit<span class="sc">$</span>Infit_t))</span>
<span id="cb119-53"><a href="MFR-model.html#cb119-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-54"><a href="MFR-model.html#cb119-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-55"><a href="MFR-model.html#cb119-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the values for presentation in a table:</span></span>
<span id="cb119-56"><a href="MFR-model.html#cb119-56" aria-hidden="true" tabindex="-1"></a>PC_MFRM_student.summary.results_rounded <span class="ot">&lt;-</span> <span class="fu">round</span>(PC_MFRM_student.summary.results, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb119-57"><a href="MFR-model.html#cb119-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-58"><a href="MFR-model.html#cb119-58" aria-hidden="true" tabindex="-1"></a>PC_MFRM_domain.summary.results_rounded <span class="ot">&lt;-</span> <span class="fu">round</span>(PC_MFRM_domain.summary.results, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb119-59"><a href="MFR-model.html#cb119-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-60"><a href="MFR-model.html#cb119-60" aria-hidden="true" tabindex="-1"></a>PC_MFRM_rater.summary.results_rounded <span class="ot">&lt;-</span> <span class="fu">round</span>(PC_MFRM_rater.summary.results, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb119-61"><a href="MFR-model.html#cb119-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-62"><a href="MFR-model.html#cb119-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-63"><a href="MFR-model.html#cb119-63" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table1 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(PC_MFRM_summary.table.statistics,</span>
<span id="cb119-64"><a href="MFR-model.html#cb119-64" aria-hidden="true" tabindex="-1"></a>                           PC_MFRM_student.summary.results_rounded,</span>
<span id="cb119-65"><a href="MFR-model.html#cb119-65" aria-hidden="true" tabindex="-1"></a>                           PC_MFRM_domain.summary.results_rounded,</span>
<span id="cb119-66"><a href="MFR-model.html#cb119-66" aria-hidden="true" tabindex="-1"></a>                           PC_MFRM_rater.summary.results_rounded)</span>
<span id="cb119-67"><a href="MFR-model.html#cb119-67" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb119-68"><a href="MFR-model.html#cb119-68" aria-hidden="true" tabindex="-1"></a><span class="co"># add descriptive column labels:</span></span>
<span id="cb119-69"><a href="MFR-model.html#cb119-69" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PC_MFRM_Table1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Statistic&quot;</span>, <span class="st">&quot;Students&quot;</span>, <span class="st">&quot;Domains&quot;</span>, <span class="st">&quot;Raters&quot;</span>)  </span>
<span id="cb119-70"><a href="MFR-model.html#cb119-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-71"><a href="MFR-model.html#cb119-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the table to the console</span></span>
<span id="cb119-72"><a href="MFR-model.html#cb119-72" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table1</span></code></pre></div>
<pre><code>##                    Statistic Students Domains Raters
## 1  Logit Scale Location Mean     0.71    0.00   0.00
## 2    Logit Scale Location SD     2.92    0.61   0.34
## 3        Standard Error Mean     0.23    0.02   0.04
## 4          Standard Error SD     0.07    0.01   0.03
## 5            Outfit MSE Mean     0.96    0.98   0.98
## 6              Outfit MSE SD     0.23    0.20   0.20
## 7             Infit MSE Mean     0.97    0.98   0.98
## 8               Infit MSE SD     0.22    0.19   0.19
## 9           Std. Outfit Mean    -0.25   -0.43  -0.43
## 10            Std. Outfit SD     1.47    2.66   2.66
## 11           Std. Infit Mean    -0.22   -0.42  -0.42
## 12             Std. Infit SD     1.48    2.80   2.80</code></pre>
<p>Table 2 summarizes the overall calibrations of individual raters. For data sets with manageable sample sizes such as the writing assessment example in this chapter, we recommend reporting details about each level of explanatory facets (e.g., individual raters) in a table similar to this one.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="MFR-model.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average rating for each rater:</span></span>
<span id="cb121-2"><a href="MFR-model.html#cb121-2" aria-hidden="true" tabindex="-1"></a>n.raters <span class="ot">&lt;-</span> <span class="fu">nrow</span>(rater.estimates)</span>
<span id="cb121-3"><a href="MFR-model.html#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="MFR-model.html#cb121-4" aria-hidden="true" tabindex="-1"></a>Avg_Rating_rater.domains <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb121-5"><a href="MFR-model.html#cb121-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-6"><a href="MFR-model.html#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rater.number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.raters){</span>
<span id="cb121-7"><a href="MFR-model.html#cb121-7" aria-hidden="true" tabindex="-1"></a>  rater.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(writing, writing<span class="sc">$</span>rater <span class="sc">==</span> rater.number)</span>
<span id="cb121-8"><a href="MFR-model.html#cb121-8" aria-hidden="true" tabindex="-1"></a>  rater.ratings <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">c</span>(rater.subset<span class="sc">$</span>style,</span>
<span id="cb121-9"><a href="MFR-model.html#cb121-9" aria-hidden="true" tabindex="-1"></a>                     rater.subset<span class="sc">$</span>org, rater.subset<span class="sc">$</span>conv,</span>
<span id="cb121-10"><a href="MFR-model.html#cb121-10" aria-hidden="true" tabindex="-1"></a>                     rater.subset<span class="sc">$</span>sent_form))</span>
<span id="cb121-11"><a href="MFR-model.html#cb121-11" aria-hidden="true" tabindex="-1"></a>  Avg_Rating_rater.domains[rater.number] <span class="ot">&lt;-</span> <span class="fu">mean</span>(rater.ratings)</span>
<span id="cb121-12"><a href="MFR-model.html#cb121-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-13"><a href="MFR-model.html#cb121-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-14"><a href="MFR-model.html#cb121-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-15"><a href="MFR-model.html#cb121-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-16"><a href="MFR-model.html#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine rater calibration results in a table:</span></span>
<span id="cb121-17"><a href="MFR-model.html#cb121-17" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table2 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rater.estimates)), </span>
<span id="cb121-18"><a href="MFR-model.html#cb121-18" aria-hidden="true" tabindex="-1"></a>                           Avg_Rating_rater.domains,</span>
<span id="cb121-19"><a href="MFR-model.html#cb121-19" aria-hidden="true" tabindex="-1"></a>                           rater.estimates<span class="sc">$</span>xsi,</span>
<span id="cb121-20"><a href="MFR-model.html#cb121-20" aria-hidden="true" tabindex="-1"></a>                           rater.estimates<span class="sc">$</span>se.xsi,</span>
<span id="cb121-21"><a href="MFR-model.html#cb121-21" aria-hidden="true" tabindex="-1"></a>                           rater.fit_results[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb121-22"><a href="MFR-model.html#cb121-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-23"><a href="MFR-model.html#cb121-23" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PC_MFRM_Table2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Rater ID&quot;</span>, <span class="st">&quot;Average Rating&quot;</span>, <span class="st">&quot;Rater Location&quot;</span>, <span class="st">&quot;Rater SE&quot;</span>,</span>
<span id="cb121-24"><a href="MFR-model.html#cb121-24" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">names</span>(rater.fit_results[, <span class="sc">-</span><span class="dv">1</span>]))                           </span>
<span id="cb121-25"><a href="MFR-model.html#cb121-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-26"><a href="MFR-model.html#cb121-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort Table 2 by rater severity:</span></span>
<span id="cb121-27"><a href="MFR-model.html#cb121-27" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table2 <span class="ot">&lt;-</span> PC_MFRM_Table2[<span class="fu">order</span>(<span class="sc">-</span>PC_MFRM_Table2<span class="sc">$</span><span class="st">`</span><span class="at">Rater Location</span><span class="st">`</span>),]</span>
<span id="cb121-28"><a href="MFR-model.html#cb121-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-29"><a href="MFR-model.html#cb121-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the numeric values (all columns except the first one) to 2 digits:</span></span>
<span id="cb121-30"><a href="MFR-model.html#cb121-30" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table2[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(PC_MFRM_Table2[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb121-31"><a href="MFR-model.html#cb121-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-32"><a href="MFR-model.html#cb121-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first six rows of the table to the console</span></span>
<span id="cb121-33"><a href="MFR-model.html#cb121-33" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PC_MFRM_Table2)</span></code></pre></div>
<pre><code>##    Rater ID Average Rating Rater Location Rater SE outfit_MSE_style
## 21       21           1.70           0.76     0.16             1.51
## 10       10           1.81           0.50     0.04             1.19
## 8         8           1.62           0.41     0.04             0.95
## 20       20           1.65           0.27     0.04             1.06
## 6         6           1.81           0.17     0.04             1.17
## 5         5           1.76           0.16     0.04             1.23
##    outfit_MSE_org outfit_MSE_conv outfit_MSE_sent_form Infit_MSE_style
## 21           1.25            1.03                 1.14            1.51
## 10           1.23            0.94                 0.88            1.19
## 8            0.82            0.92                 1.00            0.95
## 20           0.97            1.08                 0.90            1.06
## 6            0.91            0.89                 0.92            1.17
## 5            1.05            1.23                 1.19            1.23
##    Infit_MSE_org Infit_MSE_conv Infit_MSE_sent_form std_outfit_MSE_style
## 21          1.25           1.03                1.14                 5.73
## 10          1.23           0.94                0.88                 2.33
## 8           0.82           0.92                1.00                -0.62
## 20          0.97           1.08                0.90                 0.79
## 6           0.91           0.89                0.92                 2.06
## 5           1.05           1.23                1.19                 2.84
##    std_outfit_MSE_org std_outfit_MSE_conv std_outfit_MSE_sent_form
## 21               2.98                0.46                     1.53
## 10               2.78               -0.70                    -1.17
## 8               -2.36               -1.03                     0.02
## 20              -0.34                1.10                    -1.18
## 6               -1.24               -1.39                    -0.70
## 5                0.63                2.81                     1.85
##    std_infit_MSE_style std_infit_MSE_org std_infit_MSE_conv
## 21                6.38              3.82               0.67
## 10                2.47              3.06              -0.68
## 8                -0.56             -2.54              -0.68
## 20                0.21              0.09               1.50
## 6                 2.29             -0.83              -1.49
## 5                 2.94              1.25               3.05
##    std_infit_MSE_sent_form
## 21                    2.53
## 10                   -1.62
## 8                     0.85
## 20                   -0.78
## 6                    -0.82
## 5                     2.63</code></pre>
<p>Table 3 summarizes the calibration of individual domains. For data sets with manageable sample sizes such as the writing assessment example in this chapter, we recommend reporting details about each element of explanatory facets (e.g., individual domains) in a table similar to this one.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="MFR-model.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average rating for each domain:</span></span>
<span id="cb123-2"><a href="MFR-model.html#cb123-2" aria-hidden="true" tabindex="-1"></a>Avg_Rating_domains <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(writing.resp)</span>
<span id="cb123-3"><a href="MFR-model.html#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="MFR-model.html#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine domain calibration results in a table:</span></span>
<span id="cb123-5"><a href="MFR-model.html#cb123-5" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table3 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(domain.estimates<span class="sc">$</span>parameter, </span>
<span id="cb123-6"><a href="MFR-model.html#cb123-6" aria-hidden="true" tabindex="-1"></a>                           Avg_Rating_domains,</span>
<span id="cb123-7"><a href="MFR-model.html#cb123-7" aria-hidden="true" tabindex="-1"></a>                           domain.estimates<span class="sc">$</span>xsi,</span>
<span id="cb123-8"><a href="MFR-model.html#cb123-8" aria-hidden="true" tabindex="-1"></a>                           domain.estimates<span class="sc">$</span>se.xsi,</span>
<span id="cb123-9"><a href="MFR-model.html#cb123-9" aria-hidden="true" tabindex="-1"></a>                           domain_taus[, <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb123-10"><a href="MFR-model.html#cb123-10" aria-hidden="true" tabindex="-1"></a>                           domain.fit_results[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb123-11"><a href="MFR-model.html#cb123-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-12"><a href="MFR-model.html#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PC_MFRM_Table3) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Domain&quot;</span>, <span class="st">&quot;Average Rating&quot;</span>, <span class="st">&quot;Domain Location&quot;</span>, <span class="st">&quot;Domain SE&quot;</span>,</span>
<span id="cb123-13"><a href="MFR-model.html#cb123-13" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Threshold 1&quot;</span>, <span class="st">&quot;Threshold 2&quot;</span>, <span class="st">&quot;Threshold 3&quot;</span>,</span>
<span id="cb123-14"><a href="MFR-model.html#cb123-14" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">names</span>(domain.fit_results[, <span class="sc">-</span><span class="dv">1</span>]))                           </span>
<span id="cb123-15"><a href="MFR-model.html#cb123-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-16"><a href="MFR-model.html#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort Table 3 by domain difficulty:</span></span>
<span id="cb123-17"><a href="MFR-model.html#cb123-17" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table3 <span class="ot">&lt;-</span> PC_MFRM_Table3[<span class="fu">order</span>(<span class="sc">-</span>PC_MFRM_Table3<span class="sc">$</span><span class="st">`</span><span class="at">Domain Location</span><span class="st">`</span>),]</span>
<span id="cb123-18"><a href="MFR-model.html#cb123-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-19"><a href="MFR-model.html#cb123-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the numeric values (all columns except the first one) to 2 digits:</span></span>
<span id="cb123-20"><a href="MFR-model.html#cb123-20" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table3[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(PC_MFRM_Table3[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb123-21"><a href="MFR-model.html#cb123-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-22"><a href="MFR-model.html#cb123-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the table to the console</span></span>
<span id="cb123-23"><a href="MFR-model.html#cb123-23" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table3</span></code></pre></div>
<pre><code>##              Domain Average Rating Domain Location Domain SE Threshold 1
## org             org           1.52            0.63      0.02       -3.64
## style         style           1.61            0.26      0.02       -3.73
## conv           conv           1.71           -0.09      0.02       -3.61
## sent_form sent_form           1.92           -0.81      0.03       -3.12
##           Threshold 2 Threshold 3 Mean_Infit_MSE Mean_Outfit_MSE Mean_Std_Infit
## org              0.20        3.44           0.98            0.96          -0.45
## style            0.28        3.45           1.04            1.06           0.44
## conv            -0.09        3.70           0.94            0.94          -1.02
## sent_form       -0.21        3.33           0.96            0.95          -0.64
##           Mean_Std_Outfit
## org                 -0.63
## style                0.55
## conv                -1.00
## sent_form           -0.65</code></pre>
<p>Finally, Table 4 provides a summary of the student calibrations. When there is a relatively large person sample size, it may be more useful to present the results as they relate to individual persons or subsets of the person sample as they are relevant to the purpose of the analysis.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="MFR-model.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average ratings for students:</span></span>
<span id="cb125-2"><a href="MFR-model.html#cb125-2" aria-hidden="true" tabindex="-1"></a>Person_Avg_Rating <span class="ot">&lt;-</span> <span class="fu">apply</span>(writing.resp, <span class="dv">1</span>, mean)</span>
<span id="cb125-3"><a href="MFR-model.html#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="MFR-model.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine person calibration results in a table:</span></span>
<span id="cb125-5"><a href="MFR-model.html#cb125-5" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table4 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="fu">rownames</span>(student.locations_PCMFR),</span>
<span id="cb125-6"><a href="MFR-model.html#cb125-6" aria-hidden="true" tabindex="-1"></a>                          Person_Avg_Rating,</span>
<span id="cb125-7"><a href="MFR-model.html#cb125-7" aria-hidden="true" tabindex="-1"></a>                          student.locations_PCMFR<span class="sc">$</span>theta,</span>
<span id="cb125-8"><a href="MFR-model.html#cb125-8" aria-hidden="true" tabindex="-1"></a>                          student.locations_PCMFR<span class="sc">$</span>se,</span>
<span id="cb125-9"><a href="MFR-model.html#cb125-9" aria-hidden="true" tabindex="-1"></a>                          student.fit<span class="sc">$</span>outfitPerson,</span>
<span id="cb125-10"><a href="MFR-model.html#cb125-10" aria-hidden="true" tabindex="-1"></a>                          student.fit<span class="sc">$</span>outfitPerson_t,</span>
<span id="cb125-11"><a href="MFR-model.html#cb125-11" aria-hidden="true" tabindex="-1"></a>                          student.fit<span class="sc">$</span>infitPerson,</span>
<span id="cb125-12"><a href="MFR-model.html#cb125-12" aria-hidden="true" tabindex="-1"></a>                          student.fit<span class="sc">$</span>infitPerson_t)</span>
<span id="cb125-13"><a href="MFR-model.html#cb125-13" aria-hidden="true" tabindex="-1"></a>                          </span>
<span id="cb125-14"><a href="MFR-model.html#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PC_MFRM_Table4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Student ID&quot;</span>, <span class="st">&quot;Average Rating&quot;</span>, <span class="st">&quot;Student Location&quot;</span>,<span class="st">&quot;Student SE&quot;</span>,<span class="st">&quot;Outfit MSE&quot;</span>,<span class="st">&quot;Std. Outfit&quot;</span>, <span class="st">&quot;Infit MSE&quot;</span>,<span class="st">&quot;Std. Infit&quot;</span>)</span>
<span id="cb125-15"><a href="MFR-model.html#cb125-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-16"><a href="MFR-model.html#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the numeric values (all columns except the first one) to 2 digits:</span></span>
<span id="cb125-17"><a href="MFR-model.html#cb125-17" aria-hidden="true" tabindex="-1"></a>PC_MFRM_Table4[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(PC_MFRM_Table4[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb125-18"><a href="MFR-model.html#cb125-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-19"><a href="MFR-model.html#cb125-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first six rows of the table to the console</span></span>
<span id="cb125-20"><a href="MFR-model.html#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PC_MFRM_Table4)</span></code></pre></div>
<pre><code>##   Student ID Average Rating Student Location Student SE Outfit MSE Std. Outfit
## 1          1           2.00             1.88       0.21       0.97       -0.16
## 2          2           2.25             3.04       0.21       1.25        1.83
## 3          3           1.75             2.66       0.21       0.59       -3.26
## 4          4           2.50            -2.48       0.21       1.37        2.27
## 5          5           2.75            -0.53       0.21       0.79       -1.39
## 6          6           2.50            -4.05       0.22       0.80       -1.79
##   Infit MSE Std. Infit
## 1      0.97      -0.13
## 2      1.29       2.04
## 3      0.59      -3.25
## 4      1.34       2.11
## 5      0.79      -1.43
## 6      0.82      -1.67</code></pre>
</div>
</div>
<div id="notes-on-formulations-for-many-facet-rasch-models" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Notes on Formulations for Many-Facet Rasch Models</h2>
<p>In this chapter, we included two examples that demonstrated some basic principles for applying the MFRM using the <em>TAM</em> package. Example 1 used a Rating Scale (RS) model formulation with one explanatory person-related facet, and Example 2 used a Partial Credit (PC) formulation with one explanatory item-related facet.</p>
<p>Table 6.1 below provides an overview of some popular MFRM formula specifications for the TAM package that may be useful for analyses that differ from those used in this chapter. For example, analysts can specify a dichotomous MFRM by omitting “step” from the formula. In addition, analysts can specify an interaction between facets using the multiplication symbol (*) to create interaction terms.</p>
</div>
<div id="example-results-section-3" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Example Results Section</h2>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="MFR-model.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print Table 6.1:</span></span>
<span id="cb127-2"><a href="MFR-model.html#cb127-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb127-3"><a href="MFR-model.html#cb127-3" aria-hidden="true" tabindex="-1"></a> RS_MFRM_Table1 , <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb127-4"><a href="MFR-model.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&#39;Model Summary Table&#39;</span></span>
<span id="cb127-5"><a href="MFR-model.html#cb127-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-77">Table 6.1: </span>Model Summary Table</caption>
<thead>
<tr class="header">
<th align="left">Statistic</th>
<th align="right">Students</th>
<th align="right">Subgroups</th>
<th align="right">Raters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Logit Scale Location Mean</td>
<td align="right">0.47</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Logit Scale Location SD</td>
<td align="right">3.17</td>
<td align="right">0.09</td>
<td align="right">0.52</td>
</tr>
<tr class="odd">
<td align="left">Standard Error Mean</td>
<td align="right">0.47</td>
<td align="right">0.02</td>
<td align="right">0.09</td>
</tr>
<tr class="even">
<td align="left">Standard Error SD</td>
<td align="right">0.12</td>
<td align="right">0.00</td>
<td align="right">0.06</td>
</tr>
<tr class="odd">
<td align="left">Outfit MSE Mean</td>
<td align="right">0.89</td>
<td align="right">0.95</td>
<td align="right">0.95</td>
</tr>
<tr class="even">
<td align="left">Outfit MSE SD</td>
<td align="right">0.35</td>
<td align="right">0.19</td>
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="left">Infit MSE Mean</td>
<td align="right">0.90</td>
<td align="right">0.96</td>
<td align="right">0.96</td>
</tr>
<tr class="even">
<td align="left">Infit MSE SD</td>
<td align="right">0.35</td>
<td align="right">0.17</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="left">Std. Outfit Mean</td>
<td align="right">-0.32</td>
<td align="right">-0.55</td>
<td align="right">-0.55</td>
</tr>
<tr class="even">
<td align="left">Std. Outfit SD</td>
<td align="right">1.13</td>
<td align="right">1.82</td>
<td align="right">1.82</td>
</tr>
<tr class="odd">
<td align="left">Std. Infit Mean</td>
<td align="right">-0.30</td>
<td align="right">-0.50</td>
<td align="right">-0.50</td>
</tr>
<tr class="even">
<td align="left">Std. Infit SD</td>
<td align="right">1.12</td>
<td align="right">1.85</td>
<td align="right">1.85</td>
</tr>
</tbody>
</table>
<p>Table 6.1 presents a summary of the results from the analysis of the style ratings using a Rating Scale model formulation <span class="citation">(<a href="#ref-Rating_Form" role="doc-biblioref">Andrich 1978</a>)</span> of the Many-Facet Rasch model <span class="citation">(<a href="#ref-MFRM" role="doc-biblioref">John M. Linacre 1989</a>)</span>.</p>
<p>Specifically, Table 6.1 summarizes the calibration of the students (<span class="math inline">\(N\)</span> = 372), subgroups (<span class="math inline">\(N\)</span> = 2), and raters (<span class="math inline">\(N\)</span> = 21) using average logit-scale calibrations, standard errors, and model-data fit statistics. Student locations represent students’ estimated achievement level related to the style of their writing. Higher locations indicate higher achievement. The subgroup facet locations reflect the location of the student language subgroups on the logit scale. Finally, rater locations reflect the severity level of raters when scoring student performances; higher locations indicate more-severe raters. On average, the students were located higher on the logit scale (<span class="math inline">\(M\)</span> = 0.47, <span class="math inline">\(SD\)</span> = 3.16), compared to raters (<span class="math inline">\(M\)</span> = 0.00, <span class="math inline">\(SD\)</span> = 0.52), whose locations were centered at zero logits. The average value of the Standard Error (<span class="math inline">\(SE\)</span>) was larger and more variable for students (<span class="math inline">\(M\)</span> = 0.47, <span class="math inline">\(SD\)</span> = 0.12) compared to raters (<span class="math inline">\(M\)</span> = 0.09, <span class="math inline">\(SD\)</span> = 0.06). The average values of model-data fit statistics were slightly lower than the expected value of 1.00 for all three facets, indicating that there was slightly less variation in the ratings than expected by the probabilistic model. Additional investigation into item fit and person fit is warranted.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="MFR-model.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print Table 6.2:</span></span>
<span id="cb128-2"><a href="MFR-model.html#cb128-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb128-3"><a href="MFR-model.html#cb128-3" aria-hidden="true" tabindex="-1"></a>  RS_MFRM_Table2, <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb128-4"><a href="MFR-model.html#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&#39;Rater Calibrations&#39;</span></span>
<span id="cb128-5"><a href="MFR-model.html#cb128-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-78">Table 6.2: </span>Rater Calibrations</caption>
<colgroup>
<col width="3%" />
<col width="3%" />
<col width="6%" />
<col width="6%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Rater ID</th>
<th align="right">Average Rating</th>
<th align="right">Rater Location</th>
<th align="right">Threshold 1</th>
<th align="right">Threshold 2</th>
<th align="right">Threshold 3</th>
<th align="right">Outfit_MSE_Group1</th>
<th align="right">Outfit_MSE_Group2</th>
<th align="right">Infit_MSE_Group1</th>
<th align="right">Infit_MSE_Group2</th>
<th align="right">Std.Outfit_MSE_Group1</th>
<th align="right">Std.Outfit_MSE_Group2</th>
<th align="right">Std.Infit_MSE_Group1</th>
<th align="right">Std.Infit_MSE_Group2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">rater_9</td>
<td align="right">9</td>
<td align="right">1.35</td>
<td align="right">1.12</td>
<td align="right">-2.89</td>
<td align="right">1.35</td>
<td align="right">4.89</td>
<td align="right">0.68</td>
<td align="right">0.89</td>
<td align="right">0.69</td>
<td align="right">0.87</td>
<td align="right">-3.04</td>
<td align="right">-1.04</td>
<td align="right">-3.22</td>
<td align="right">-1.30</td>
</tr>
<tr class="even">
<td align="left">rater_19</td>
<td align="right">19</td>
<td align="right">1.45</td>
<td align="right">0.66</td>
<td align="right">-3.35</td>
<td align="right">0.90</td>
<td align="right">4.44</td>
<td align="right">1.24</td>
<td align="right">1.09</td>
<td align="right">1.15</td>
<td align="right">1.12</td>
<td align="right">1.96</td>
<td align="right">0.87</td>
<td align="right">1.39</td>
<td align="right">1.18</td>
</tr>
<tr class="odd">
<td align="left">rater_21</td>
<td align="right">21</td>
<td align="right">1.49</td>
<td align="right">0.50</td>
<td align="right">-3.50</td>
<td align="right">0.74</td>
<td align="right">4.28</td>
<td align="right">0.97</td>
<td align="right">0.79</td>
<td align="right">1.03</td>
<td align="right">0.85</td>
<td align="right">-0.20</td>
<td align="right">-1.86</td>
<td align="right">0.32</td>
<td align="right">-1.50</td>
</tr>
<tr class="even">
<td align="left">rater_17</td>
<td align="right">17</td>
<td align="right">1.51</td>
<td align="right">0.45</td>
<td align="right">-3.56</td>
<td align="right">0.68</td>
<td align="right">4.22</td>
<td align="right">1.14</td>
<td align="right">1.19</td>
<td align="right">1.16</td>
<td align="right">1.17</td>
<td align="right">1.14</td>
<td align="right">1.63</td>
<td align="right">1.48</td>
<td align="right">1.65</td>
</tr>
<tr class="odd">
<td align="left">rater_16</td>
<td align="right">16</td>
<td align="right">1.51</td>
<td align="right">0.44</td>
<td align="right">-3.57</td>
<td align="right">0.67</td>
<td align="right">4.21</td>
<td align="right">0.77</td>
<td align="right">0.84</td>
<td align="right">0.78</td>
<td align="right">0.84</td>
<td align="right">-2.14</td>
<td align="right">-1.59</td>
<td align="right">-2.21</td>
<td align="right">-1.75</td>
</tr>
<tr class="even">
<td align="left">rater_20</td>
<td align="right">20</td>
<td align="right">1.51</td>
<td align="right">0.44</td>
<td align="right">-3.57</td>
<td align="right">0.67</td>
<td align="right">4.21</td>
<td align="right">1.01</td>
<td align="right">0.82</td>
<td align="right">1.04</td>
<td align="right">0.85</td>
<td align="right">0.11</td>
<td align="right">-1.79</td>
<td align="right">0.39</td>
<td align="right">-1.56</td>
</tr>
<tr class="odd">
<td align="left">rater_8</td>
<td align="right">8</td>
<td align="right">1.55</td>
<td align="right">0.27</td>
<td align="right">-3.74</td>
<td align="right">0.50</td>
<td align="right">4.04</td>
<td align="right">0.75</td>
<td align="right">1.00</td>
<td align="right">0.78</td>
<td align="right">0.98</td>
<td align="right">-2.34</td>
<td align="right">0.03</td>
<td align="right">-2.19</td>
<td align="right">-0.14</td>
</tr>
<tr class="even">
<td align="left">rater_14</td>
<td align="right">14</td>
<td align="right">1.55</td>
<td align="right">0.26</td>
<td align="right">-3.75</td>
<td align="right">0.49</td>
<td align="right">4.03</td>
<td align="right">1.20</td>
<td align="right">1.24</td>
<td align="right">1.19</td>
<td align="right">1.27</td>
<td align="right">1.62</td>
<td align="right">2.10</td>
<td align="right">1.68</td>
<td align="right">2.53</td>
</tr>
<tr class="odd">
<td align="left">rater_3</td>
<td align="right">3</td>
<td align="right">1.57</td>
<td align="right">0.17</td>
<td align="right">-3.84</td>
<td align="right">0.40</td>
<td align="right">3.94</td>
<td align="right">0.71</td>
<td align="right">0.97</td>
<td align="right">0.75</td>
<td align="right">1.00</td>
<td align="right">-2.82</td>
<td align="right">-0.27</td>
<td align="right">-2.64</td>
<td align="right">0.03</td>
</tr>
<tr class="even">
<td align="left">rater_18</td>
<td align="right">18</td>
<td align="right">1.59</td>
<td align="right">0.11</td>
<td align="right">-3.90</td>
<td align="right">0.35</td>
<td align="right">3.89</td>
<td align="right">1.05</td>
<td align="right">1.02</td>
<td align="right">1.05</td>
<td align="right">1.05</td>
<td align="right">0.44</td>
<td align="right">0.24</td>
<td align="right">0.48</td>
<td align="right">0.53</td>
</tr>
<tr class="odd">
<td align="left">rater_4</td>
<td align="right">4</td>
<td align="right">1.60</td>
<td align="right">0.03</td>
<td align="right">-3.98</td>
<td align="right">0.27</td>
<td align="right">3.81</td>
<td align="right">0.81</td>
<td align="right">0.86</td>
<td align="right">0.83</td>
<td align="right">0.86</td>
<td align="right">-1.75</td>
<td align="right">-1.39</td>
<td align="right">-1.65</td>
<td align="right">-1.48</td>
</tr>
<tr class="even">
<td align="left">rater_11</td>
<td align="right">11</td>
<td align="right">1.66</td>
<td align="right">-0.21</td>
<td align="right">-4.22</td>
<td align="right">0.02</td>
<td align="right">3.56</td>
<td align="right">1.00</td>
<td align="right">1.10</td>
<td align="right">1.01</td>
<td align="right">1.13</td>
<td align="right">0.01</td>
<td align="right">0.88</td>
<td align="right">0.12</td>
<td align="right">1.32</td>
</tr>
<tr class="odd">
<td align="left">rater_7</td>
<td align="right">7</td>
<td align="right">1.67</td>
<td align="right">-0.22</td>
<td align="right">-4.23</td>
<td align="right">0.01</td>
<td align="right">3.55</td>
<td align="right">1.10</td>
<td align="right">1.16</td>
<td align="right">1.07</td>
<td align="right">1.07</td>
<td align="right">0.79</td>
<td align="right">1.41</td>
<td align="right">0.70</td>
<td align="right">0.77</td>
</tr>
<tr class="even">
<td align="left">rater_1</td>
<td align="right">1</td>
<td align="right">1.68</td>
<td align="right">-0.28</td>
<td align="right">-4.29</td>
<td align="right">-0.04</td>
<td align="right">3.49</td>
<td align="right">0.54</td>
<td align="right">0.52</td>
<td align="right">0.57</td>
<td align="right">0.55</td>
<td align="right">-4.84</td>
<td align="right">-5.66</td>
<td align="right">-4.91</td>
<td align="right">-5.55</td>
</tr>
<tr class="odd">
<td align="left">rater_12</td>
<td align="right">12</td>
<td align="right">1.68</td>
<td align="right">-0.28</td>
<td align="right">-4.29</td>
<td align="right">-0.04</td>
<td align="right">3.49</td>
<td align="right">0.77</td>
<td align="right">0.84</td>
<td align="right">0.78</td>
<td align="right">0.83</td>
<td align="right">-2.14</td>
<td align="right">-1.59</td>
<td align="right">-2.21</td>
<td align="right">-1.79</td>
</tr>
<tr class="even">
<td align="left">rater_2</td>
<td align="right">2</td>
<td align="right">1.69</td>
<td align="right">-0.31</td>
<td align="right">-4.32</td>
<td align="right">-0.08</td>
<td align="right">3.46</td>
<td align="right">0.99</td>
<td align="right">1.16</td>
<td align="right">1.01</td>
<td align="right">1.19</td>
<td align="right">0.00</td>
<td align="right">1.42</td>
<td align="right">0.14</td>
<td align="right">1.87</td>
</tr>
<tr class="odd">
<td align="left">rater_6</td>
<td align="right">6</td>
<td align="right">1.69</td>
<td align="right">-0.34</td>
<td align="right">-4.35</td>
<td align="right">-0.10</td>
<td align="right">3.44</td>
<td align="right">0.95</td>
<td align="right">1.06</td>
<td align="right">0.96</td>
<td align="right">1.06</td>
<td align="right">-0.45</td>
<td align="right">0.61</td>
<td align="right">-0.34</td>
<td align="right">0.61</td>
</tr>
<tr class="even">
<td align="left">rater_13</td>
<td align="right">13</td>
<td align="right">1.69</td>
<td align="right">-0.34</td>
<td align="right">-4.35</td>
<td align="right">-0.10</td>
<td align="right">3.44</td>
<td align="right">0.87</td>
<td align="right">0.96</td>
<td align="right">0.88</td>
<td align="right">0.95</td>
<td align="right">-1.13</td>
<td align="right">-0.31</td>
<td align="right">-1.10</td>
<td align="right">-0.46</td>
</tr>
<tr class="odd">
<td align="left">rater_5</td>
<td align="right">5</td>
<td align="right">1.80</td>
<td align="right">-0.78</td>
<td align="right">-4.79</td>
<td align="right">-0.54</td>
<td align="right">3.00</td>
<td align="right">0.63</td>
<td align="right">0.99</td>
<td align="right">0.66</td>
<td align="right">1.00</td>
<td align="right">-3.64</td>
<td align="right">-0.07</td>
<td align="right">-3.70</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">rater_15</td>
<td align="right">15</td>
<td align="right">1.81</td>
<td align="right">-0.82</td>
<td align="right">-4.83</td>
<td align="right">-0.59</td>
<td align="right">2.95</td>
<td align="right">0.84</td>
<td align="right">1.00</td>
<td align="right">0.85</td>
<td align="right">0.98</td>
<td align="right">-1.44</td>
<td align="right">0.05</td>
<td align="right">-1.44</td>
<td align="right">-0.15</td>
</tr>
<tr class="odd">
<td align="left">rater_10</td>
<td align="right">10</td>
<td align="right">1.82</td>
<td align="right">-0.87</td>
<td align="right">-4.88</td>
<td align="right">-0.63</td>
<td align="right">2.91</td>
<td align="right">1.09</td>
<td align="right">1.24</td>
<td align="right">1.10</td>
<td align="right">1.20</td>
<td align="right">0.82</td>
<td align="right">2.17</td>
<td align="right">0.95</td>
<td align="right">1.98</td>
</tr>
</tbody>
</table>
<p>Table 6.2 includes detailed results for the 21 raters included in the analysis, where raters are ordered by their overall logit-scale location (i.e., rater severity) from high (severe) to low (lenient). For each rater, the average rating is presented, followed by the overall logit-scale location (<span class="math inline">\(\lambda\)</span>), the location of the rater-specific rating scale category thresholds, and fit statistics specific to the two student subgroups. Because we used a RS formulation of the MFRM, the distance between adjacent rating scale category threshold estimates is the same for all of the raters. Rater 9 was the most severe rater (<em>Average Rating</em> = 1.35; <span class="math inline">\(\lambda\)</span> = 1.12), and Rater 10 was the most lenient rater (<em>Average Rating</em> = 1.82; <span class="math inline">\(\lambda\)</span> = -0.87). In general, the raters exhibited similar model-data fit patterns within subgroups.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="MFR-model.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print Table 6.3:</span></span>
<span id="cb129-2"><a href="MFR-model.html#cb129-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb129-3"><a href="MFR-model.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(RS_MFRM_Table3,<span class="dv">10</span>), <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb129-4"><a href="MFR-model.html#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&#39;Student Calibration&#39;</span></span>
<span id="cb129-5"><a href="MFR-model.html#cb129-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-79">Table 6.3: </span>Student Calibration</caption>
<colgroup>
<col width="3%" />
<col width="10%" />
<col width="14%" />
<col width="16%" />
<col width="10%" />
<col width="10%" />
<col width="11%" />
<col width="9%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Student ID</th>
<th align="right">Average Rating</th>
<th align="right">Student Location</th>
<th align="right">Student SE</th>
<th align="right">Outfit MSE</th>
<th align="right">Std. Outfit</th>
<th align="right">Infit MSE</th>
<th align="right">Std. Infit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">69</td>
<td align="left">69</td>
<td align="right">3.00</td>
<td align="right">7.60</td>
<td align="right">1.47</td>
<td align="right">0.02</td>
<td align="right">-0.81</td>
<td align="right">0.03</td>
<td align="right">-1.02</td>
</tr>
<tr class="even">
<td align="left">44</td>
<td align="left">44</td>
<td align="right">2.95</td>
<td align="right">6.57</td>
<td align="right">0.87</td>
<td align="right">0.54</td>
<td align="right">-0.36</td>
<td align="right">0.71</td>
<td align="right">-0.18</td>
</tr>
<tr class="odd">
<td align="left">45</td>
<td align="left">45</td>
<td align="right">2.95</td>
<td align="right">6.57</td>
<td align="right">0.87</td>
<td align="right">0.44</td>
<td align="right">-0.54</td>
<td align="right">0.68</td>
<td align="right">-0.23</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">12</td>
<td align="right">2.95</td>
<td align="right">6.44</td>
<td align="right">0.87</td>
<td align="right">0.54</td>
<td align="right">-0.36</td>
<td align="right">0.71</td>
<td align="right">-0.18</td>
</tr>
<tr class="odd">
<td align="left">70</td>
<td align="left">70</td>
<td align="right">2.95</td>
<td align="right">6.44</td>
<td align="right">0.87</td>
<td align="right">0.76</td>
<td align="right">-0.01</td>
<td align="right">0.79</td>
<td align="right">-0.06</td>
</tr>
<tr class="even">
<td align="left">269</td>
<td align="left">269</td>
<td align="right">2.95</td>
<td align="right">6.44</td>
<td align="right">0.87</td>
<td align="right">0.54</td>
<td align="right">-0.36</td>
<td align="right">0.71</td>
<td align="right">-0.18</td>
</tr>
<tr class="odd">
<td align="left">77</td>
<td align="left">77</td>
<td align="right">2.90</td>
<td align="right">5.87</td>
<td align="right">0.69</td>
<td align="right">0.58</td>
<td align="right">-0.58</td>
<td align="right">0.75</td>
<td align="right">-0.33</td>
</tr>
<tr class="even">
<td align="left">282</td>
<td align="left">282</td>
<td align="right">2.86</td>
<td align="right">5.61</td>
<td align="right">0.60</td>
<td align="right">0.83</td>
<td align="right">-0.20</td>
<td align="right">0.93</td>
<td align="right">-0.03</td>
</tr>
<tr class="odd">
<td align="left">362</td>
<td align="left">362</td>
<td align="right">2.86</td>
<td align="right">5.61</td>
<td align="right">0.60</td>
<td align="right">1.03</td>
<td align="right">0.22</td>
<td align="right">0.85</td>
<td align="right">-0.24</td>
</tr>
<tr class="even">
<td align="left">65</td>
<td align="left">65</td>
<td align="right">2.86</td>
<td align="right">5.48</td>
<td align="right">0.60</td>
<td align="right">1.13</td>
<td align="right">0.41</td>
<td align="right">0.95</td>
<td align="right">0.02</td>
</tr>
</tbody>
</table>
<p>Table 3 includes detailed results for the students who participated in the style writing assessment. For each student, the average rating is presented, followed by their logit-scale location estimate (<span class="math inline">\(\theta\)</span>), <span class="math inline">\(SE\)</span>, and model-data fit statistics. Students are ordered by their location on the logit scale, from high (high estimated achievement) to low (low estimated achievement). For brevity, Table 3 only shows results for 10 students.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="MFR-model.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print Table 6.4:</span></span>
<span id="cb130-2"><a href="MFR-model.html#cb130-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb130-3"><a href="MFR-model.html#cb130-3" aria-hidden="true" tabindex="-1"></a> RS_MFRM_Table4, <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-4"><a href="MFR-model.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&#39;Subgroup Calibration&#39;</span></span>
<span id="cb130-5"><a href="MFR-model.html#cb130-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-80">Table 6.4: </span>Subgroup Calibration</caption>
<colgroup>
<col width="2%" />
<col width="9%" />
<col width="13%" />
<col width="16%" />
<col width="18%" />
<col width="9%" />
<col width="10%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Subgroup</th>
<th align="right">Average Rating</th>
<th align="right">Subgroup Location</th>
<th align="right">Subgroup Location SE</th>
<th align="right">Outfit MSE</th>
<th align="right">Std. Outfit</th>
<th align="right">Infit MSE</th>
<th align="right">Std. Infit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2</td>
<td align="left">language2</td>
<td align="right">1.59</td>
<td align="right">0.07</td>
<td align="right">0.02</td>
<td align="right">0.93</td>
<td align="right">-0.24</td>
<td align="right">0.94</td>
<td align="right">-0.21</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">language1</td>
<td align="right">1.63</td>
<td align="right">-0.07</td>
<td align="right">0.02</td>
<td align="right">0.85</td>
<td align="right">-0.41</td>
<td align="right">0.86</td>
<td align="right">-0.41</td>
</tr>
</tbody>
</table>
<p>Table 6.4 shows the calibration of the student subgroup facet. For each subgroup, the average rating among students within the subgroup is presented, followed by the logit-scale location estimate for the subgroup (<span class="math inline">\(\gamma\)</span>), <span class="math inline">\(SE\)</span>, and model-data fit statistics. Subgroups are ordered by their location on the logit scale, from high (high estimated achievement) to low (low estimated achievement). In this assessment, the difference in logit-scale locations between the two language subgroups was small–indicating comparable estimated achievement levels, on average, for students in each language group. In addition, the fit statistics were comparable between subgroups.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="MFR-model.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Wright Map</span></span>
<span id="cb131-2"><a href="MFR-model.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wrightMap</span>(<span class="at">thetas =</span> <span class="fu">cbind</span>(student.locations_RSMFR<span class="sc">$</span>theta, subgroup.estimates<span class="sc">$</span>xsi),</span>
<span id="cb131-3"><a href="MFR-model.html#cb131-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.persons =</span> <span class="st">&quot;Students&quot;</span>,</span>
<span id="cb131-4"><a href="MFR-model.html#cb131-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">dim.names =</span> <span class="fu">c</span>(<span class="st">&quot;Students&quot;</span>, <span class="st">&quot;Subgroups&quot;</span>), </span>
<span id="cb131-5"><a href="MFR-model.html#cb131-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">thresholds =</span> rater_thresholds,</span>
<span id="cb131-6"><a href="MFR-model.html#cb131-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.thr.lab  =</span> <span class="cn">TRUE</span>,</span>
<span id="cb131-7"><a href="MFR-model.html#cb131-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">label.items.rows=</span> <span class="dv">2</span>,</span>
<span id="cb131-8"><a href="MFR-model.html#cb131-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">label.items =</span> rater.estimates<span class="sc">$</span>parameter,</span>
<span id="cb131-9"><a href="MFR-model.html#cb131-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.items =</span> <span class="st">&quot;Raters&quot;</span>,</span>
<span id="cb131-10"><a href="MFR-model.html#cb131-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title =</span> <span class="st">&quot;Rating Scale Many-Facet Rasch Model </span><span class="sc">\n</span><span class="st">Wright Map: Style Ratings&quot;</span>,</span>
<span id="cb131-11"><a href="MFR-model.html#cb131-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex.main =</span> .<span class="dv">6</span>)</span></code></pre></div>
<p><img src="The-Rasch-Book_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<pre><code>##            [,1]        [,2]     [,3]
##  [1,] -4.288967 -0.04481525 3.493253
##  [2,] -4.322646 -0.07849438 3.459574
##  [3,] -3.840553  0.40359889 3.941667
##  [4,] -3.975059  0.26909229 3.807160
##  [5,] -4.785429 -0.54127709 2.996791
##  [6,] -4.345107 -0.10095584 3.437112
##  [7,] -4.232865  0.01128652 3.549355
##  [8,] -3.739598  0.50455410 4.042622
##  [9,] -2.891467  1.35268451 4.890753
## [10,] -4.876566 -0.63241444 2.905654
## [11,] -4.221649  0.02250299 3.560571
## [12,] -4.288967 -0.04481525 3.493253
## [13,] -4.345107 -0.10095584 3.437112
## [14,] -3.750819  0.49333235 4.031400
## [15,] -4.830952 -0.58680019 2.951268
## [16,] -3.571092  0.67305934 4.211127
## [17,] -3.559845  0.68430692 4.222375
## [18,] -3.896607  0.34754470 3.885613
## [19,] -3.345721  0.89843079 4.436499
## [20,] -3.571092  0.67305934 4.211127
## [21,] -3.504491  0.73966026 4.277728</code></pre>
<p>Figure 6.1 is a <em>Wright Map</em> that illustrates the results from the RS-MFRM analysis of the style ratings. Units on the logit scale are shown on the far-right axis of the plot (labeled <em>Logits</em>). The left-most panel of the plot shows a histogram of student locations on the logit scale that represents the latent variable. The second panel from the left shows the distribution of subgroups on the logit scale. There are only two subgroups in our analysis.</p>
<p>The large central panel of the plot shows the rating scale category threshold estimates specific to each rater on the logit scale that represents the latent variable. Light grey diamond shapes show the logit scale location of the threshold estimates for each rater, as labeled on the x-axis. Thresholds are labeled using tau symbols followed by an integer that shows the threshold number. In our example, <span class="math inline">\(\tau_1\)</span> is the threshold between rating scale categories <span class="math inline">\(x = 0\)</span> and <span class="math inline">\(x = 1\)</span>, <span class="math inline">\(\tau_2\)</span> is the threshold between rating scale categories <span class="math inline">\(x = 1\)</span> and <span class="math inline">\(x = 2\)</span>, and <span class="math inline">\(\tau_3\)</span> is the threshold between rating scale categories <span class="math inline">\(x = 2\)</span> and <span class="math inline">\(x = 3\)</span>. Because we used a RS model formulation, the distance between adjacent thresholds is the same for all of the raters in the analysis.</p>
<p>The Wright Map suggests that, on average, the students are located higher on the logit scale compared to the average rater threshold locations. In addition, there appears to be a relatively wide spread of student and rater locations on the logit scale, such that the style writing assessment appears to be a useful tool for identifying differences in students’ writing achievement related to style as well as differences in rater severity. The subgroup locations are close together, suggesting that there is not much difference in the logit-scale locations between students in either language subgroup.</p>
</div>
<div id="exercise-4" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Exercise</h2>
<p>Please use the <em>TAM</em> package to estimate item, threshold, and person locations with the RS-MFRM for the Exercise 6 data. The Exercise 6 data include responses from 350 participants from two subgroups (group 1 and group 2) to a survey with 30 items. Participants used a four-category rating scale (<span class="math inline">\(x = 0, 1, 2, 3\)</span>) to respond to each item. The MFRM can be specified using various formulations, including a RS-MFRM and a PC-MFRM. After completing the analysis, try writing a results section similar to the example in this chapter to describe your findings.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Rating_Form" class="csl-entry">
Andrich, David. 1978. <span>“A Rating Formulation for Ordered Response Categories.”</span> <em>Psychometrika</em> 43 (4): 561–73. https://doi.org/<a href="https://doi.org/10.1007/bf02293814">https://doi.org/10.1007/bf02293814</a>.
</div>
<div id="ref-Apply_RM" class="csl-entry">
Bond, Trevor, Zi Yan, and Moritz Heene. 2020. <em>Applying the Rasch Model: Fundamental Measurement in the Human Sciences</em>. 4th ed. Routledge.
</div>
<div id="ref-WrightMap" class="csl-entry">
Irribarra, David Torres, and Rebecca Freund. 2014. <em>Wright Map: IRT Item-Person Map with ConQuest Integration</em>. <a href="http://github.com/david-ti/wrightmap">http://github.com/david-ti/wrightmap</a>.
</div>
<div id="ref-MFRM" class="csl-entry">
Linacre, John M. 1989. <em>Many-Facet Rasch Measurement</em>. MESA Press.
</div>
<div id="ref-Optimizing_RS" class="csl-entry">
———. 2002. <span>“Optimizing Rating Scale Category Effectiveness.”</span> <em>Journal of Applied Measurement</em> 3 (1): 85–106.
</div>
<div id="ref-PCA_procedure" class="csl-entry">
Linacre, John Michael. 2016. <span>“Principal-Components Analysis of Residuals.”</span>
</div>
<div id="ref-R-base" class="csl-entry">
R Core Team. 2019. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-psych" class="csl-entry">
Revelle, William. 2021. <em>Psych: Procedures for Psychological, Psychometric, and Personality Research</em>. Evanston, Illinois: Northwestern University. <a href="https://CRAN.R-project.org/package=psych">https://CRAN.R-project.org/package=psych</a>.
</div>
<div id="ref-TAM" class="csl-entry">
Robitzsch, Alexander, Thomas Kiefer, and Margaret Wu. 2021. <em>TAM: Test Analysis Modules</em>. <a href="https://CRAN.R-project.org/package=TAM">https://CRAN.R-project.org/package=TAM</a>.
</div>
<div id="ref-Overview_RM" class="csl-entry">
Wright, Benjamin D., and Magdalena Mo Ching Mok. 2004. <span>“An Overview of the Family of Rasch Measurement Models.”</span> In <em>Introduction to Rasch Measurement</em>, edited by Everett V. Smith and Richard M. Smith, 1–24. JAM Press.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="PC-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="DIF.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/huacheng1985/bookdown-demo/edit/master/06-MFR_model.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["The Rasch Book.pdf", "The Rasch Book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
